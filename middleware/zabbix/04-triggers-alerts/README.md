# 04 Â· è§¦å‘å™¨ä¸å‘Šè­¦é€šçŸ¥ï¼ˆTriggers & Alertsï¼‰

> **ç›®æ ‡**ï¼šé…ç½®è§¦å‘å™¨ã€é‚®ä»¶é€šçŸ¥å’Œç»´æŠ¤çª—å£
> **å‰ç½®**ï¼š[03 Â· åŸºç¡€ç›‘æ§ + æ­»æ´»æ£€æŸ¥](../03-monitoring-basics/)
> **è´¹ç”¨**ï¼šå®éªŒç¯å¢ƒæŒç»­äº§ç”Ÿè´¹ç”¨ï¼ˆçº¦ $0.03/å°æ—¶ï¼‰ï¼›å®Œæˆç³»åˆ—åè¯·åˆ é™¤å †æ ˆ
> **æ—¶é—´**ï¼š30-35 åˆ†é’Ÿ
> **å®æˆ˜é¡¹ç›®**ï¼šé…ç½®ç£ç›˜å‘Šè­¦ + Golden Week ç»´æŠ¤çª—å£

## å°†å­¦åˆ°çš„å†…å®¹

1. åˆ›å»ºè‡ªå®šä¹‰è§¦å‘å™¨
2. ç†è§£ Severity çº§åˆ«å’Œä¾èµ–å…³ç³»
3. é…ç½® Email é€šçŸ¥
4. åˆ›å»º Actionï¼ˆè§¦å‘å™¨ â†’ é€šçŸ¥ï¼‰
5. è®¾ç½®ç»´æŠ¤çª—å£ï¼ˆMaintenance Windowï¼‰
6. å®è·µå‘Šè­¦ç¡®è®¤ï¼ˆAcknowledgmentï¼‰

---

## Step 1 â€” åˆ›å»ºè‡ªå®šä¹‰è§¦å‘å™¨

### 1.1 è§¦å‘å™¨å·¥ä½œåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Trigger å·¥ä½œæµç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Item é‡‡é›†æ•°æ®                                               â”‚
â”‚       â”‚                                                      â”‚
â”‚       â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ Expression è¯„ä¼° â”‚â”€â”€â”€â”€â–ºâ”‚ çŠ¶æ€: OK/PROBLEM â”‚               â”‚
â”‚  â”‚ last() < 20     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                          â”‚
â”‚                                   â–¼                          â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚                         â”‚ Event ç”Ÿæˆ      â”‚                  â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                   â”‚                          â”‚
â”‚                                   â–¼                          â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚                         â”‚ Action æ‰§è¡Œ     â”‚                  â”‚
â”‚                         â”‚ (å‘é€é€šçŸ¥)      â”‚                  â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 åˆ›å»ºç£ç›˜ç©ºé—´è§¦å‘å™¨

> ğŸ’¡ **æ¨¡æ¿å·²åŒ…å«è§¦å‘å™¨**ï¼š
> `Linux by Zabbix agent active` æ¨¡æ¿å·²å†…ç½®ç£ç›˜ç©ºé—´è§¦å‘å™¨ï¼ˆ`FS [/]: Space is critically low`ã€`FS [/]: Space is low`ï¼‰ã€‚
> æœ¬èŠ‚åˆ›å»ºè‡ªå®šä¹‰è§¦å‘å™¨æ˜¯ä¸ºäº†**å­¦ä¹ è§¦å‘å™¨é…ç½®æµç¨‹**ã€‚ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¼˜å…ˆä½¿ç”¨æˆ–ä¿®æ”¹æ¨¡æ¿å†…ç½®è§¦å‘å™¨ã€‚

1. ã€ŒData collectionã€â†’ã€ŒHostsã€â†’ ç‚¹å‡» `monitored-host-01`
2. åˆ‡æ¢åˆ°ã€ŒTriggersã€æ ‡ç­¾é¡µ
3. ç‚¹å‡»ã€ŒCreate triggerã€

**åŸºæœ¬é…ç½®**ï¼š

| å­—æ®µ | å€¼ |
|------|-----|
| Name | `Disk space is low on {HOST.NAME} ({ITEM.LASTVALUE})` |
| Severity | `Warning` |
| Expression | è§ä¸‹æ–¹ |

**æ„å»º Expression**ï¼š

ç‚¹å‡»ã€ŒAddã€æ‰“å¼€è¡¨è¾¾å¼æ„å»ºå™¨ï¼š

| å­—æ®µ | å€¼ |
|------|-----|
| Item | `FS [/]: Space: Used, in %` |
| Function | `last()` |
| Result | `>=80` |

å®Œæ•´è¡¨è¾¾å¼ç¤ºä¾‹ï¼š
```
last(/monitored-host-01/vfs.fs.dependent.size[/,pused])>=80
```

> ğŸ’¡ **Item Key è¯´æ˜**ï¼š
> `Linux by Zabbix agent active` æ¨¡æ¿ä½¿ç”¨ Dependent Item Discovery æ¨¡å¼ï¼Œç£ç›˜ç©ºé—´ç™¾åˆ†æ¯”çš„ Key æ˜¯ `vfs.fs.dependent.size[/,pused]`ï¼ˆæ³¨æ„ `dependent` å‰ç¼€ï¼‰ï¼Œè€Œä¸æ˜¯æ—§ç‰ˆçš„ `vfs.fs.size[/,pused]`ã€‚

**Recovery expression**ï¼ˆé˜²æ­¢ Flappingï¼‰ï¼š
```
last(/monitored-host-01/vfs.fs.dependent.size[/,pused])<75
```

> ğŸ’¡ **Hysteresisï¼ˆæ»åï¼‰**ï¼šProblem é˜ˆå€¼ 80%ï¼ŒRecovery é˜ˆå€¼ 75%ï¼Œé¿å…åœ¨ä¸´ç•Œå€¼é™„è¿‘åå¤è§¦å‘

4. ç‚¹å‡»ã€ŒAddã€

### 1.3 Severity çº§åˆ«

| çº§åˆ« | é¢œè‰² | ç”¨é€” |
|------|------|------|
| Not classified | ç°è‰² | æœªåˆ†ç±» |
| Information | æµ…è“ | ä¿¡æ¯æç¤º |
| Warning | é»„è‰² | è­¦å‘Šï¼Œéœ€å…³æ³¨ |
| Average | æ©™è‰² | ä¸€èˆ¬ä¸¥é‡ |
| High | çº¢è‰² | ä¸¥é‡é—®é¢˜ |
| Disaster | æ·±çº¢ | ç¾éš¾çº§åˆ« |

---

## Step 2 â€” ç†è§£è§¦å‘å™¨ä¾èµ–

### 2.1 ä¾èµ–å…³ç³»åœºæ™¯

```
åœºæ™¯ï¼šç½‘ç»œè®¾å¤‡æ•…éšœå¯¼è‡´æ‰€æœ‰æœåŠ¡å™¨ä¸å¯è¾¾

ä¸ä½¿ç”¨ä¾èµ–ï¼š
  - Switch down â† è§¦å‘
  - Server A unreachable â† è§¦å‘
  - Server B unreachable â† è§¦å‘
  - Server C unreachable â† è§¦å‘
  = å¤§é‡é‡å¤å‘Šè­¦ï¼

ä½¿ç”¨ä¾èµ–ï¼š
  - Switch down â† è§¦å‘
  - Server A unreachable â† è¢«æŠ‘åˆ¶ï¼ˆä¾èµ– Switchï¼‰
  - Server B unreachable â† è¢«æŠ‘åˆ¶
  - Server C unreachable â† è¢«æŠ‘åˆ¶
  = åªæ”¶åˆ° 1 ä¸ªå‘Šè­¦
```

### 2.2 é…ç½®ä¾èµ–

1. ç¼–è¾‘ Trigger
2. åˆ‡æ¢åˆ°ã€ŒDependenciesã€æ ‡ç­¾é¡µ
3. ç‚¹å‡»ã€ŒAddã€é€‰æ‹©çˆ¶è§¦å‘å™¨
4. ä¿å­˜

---

## Step 3 â€” é…ç½® Email é€šçŸ¥

### 3.1 é…ç½® Media Type

1. ã€ŒAlertsã€â†’ã€ŒMedia typesã€
2. ç‚¹å‡»ã€ŒEmailã€ï¼ˆç³»ç»Ÿé¢„ç½®ï¼‰

é…ç½® SMTPï¼š

| å­—æ®µ | å€¼ï¼ˆç¤ºä¾‹ï¼šGmailï¼‰ |
|------|-------------------|
| SMTP server | smtp.gmail.com |
| SMTP server port | 587 |
| SMTP helo | gmail.com |
| SMTP email | your-email@gmail.com |
| Connection security | STARTTLS |
| Authentication | Username and password |
| Username | your-email@gmail.com |
| Password | App passwordï¼ˆéç™»å½•å¯†ç ï¼‰ |

å¯¹äº AWS SESï¼š

| å­—æ®µ | å€¼ |
|------|-----|
| SMTP server | email-smtp.ap-northeast-1.amazonaws.com |
| SMTP server port | 587 |
| Connection security | STARTTLS |
| Username | SES SMTP username |
| Password | SES SMTP password |

3. ç‚¹å‡»ã€ŒTestã€éªŒè¯
4. ç‚¹å‡»ã€ŒUpdateã€

> âš ï¸ **å¸¸è§ SMTP é—®é¢˜**ï¼š
> - **Gmail**ï¼šéœ€è¦å¯ç”¨ 2FA å¹¶åˆ›å»º App Passwordï¼ˆéç™»å½•å¯†ç ï¼‰ã€‚è¿›å…¥ Google è´¦æˆ· â†’ å®‰å…¨ â†’ åº”ç”¨ä¸“ç”¨å¯†ç 
> - **AWS SES**ï¼šæ–°è´¦æˆ·åœ¨ Sandbox æ¨¡å¼ï¼Œåªèƒ½å‘é€åˆ°å·²éªŒè¯é‚®ç®±ã€‚éœ€ç”³è¯·ç”Ÿäº§ç¯å¢ƒè®¿é—®
> - **é˜²ç«å¢™**ï¼šç¡®ä¿ Zabbix Server å¯è®¿é—® SMTP ç«¯å£ï¼ˆ587/465ï¼‰

### 3.2 ä¸ºç”¨æˆ·é…ç½® Media

1. ã€ŒUsersã€â†’ã€ŒUsersã€
2. ç‚¹å‡»ä½ çš„ç”¨æˆ·å
3. åˆ‡æ¢åˆ°ã€ŒMediaã€æ ‡ç­¾é¡µ
4. ç‚¹å‡»ã€ŒAddã€

   | å­—æ®µ | å€¼ |
   |------|-----|
   | Type | Email |
   | Send to | your-email@example.com |
   | When active | 1-7,00:00-24:00ï¼ˆå…¨å¤©å€™ï¼‰ |
   | Use if severity | å‹¾é€‰éœ€è¦æ¥æ”¶çš„çº§åˆ« |

5. ç‚¹å‡»ã€ŒAddã€â†’ã€ŒUpdateã€

---

## Step 4 â€” åˆ›å»º Action

Action å®šä¹‰ã€Œè§¦å‘å™¨è§¦å‘æ—¶åšä»€ä¹ˆã€ã€‚

### 4.1 åˆ›å»ºé€šçŸ¥ Action

1. ã€ŒAlertsã€â†’ã€ŒActionsã€â†’ã€ŒTrigger actionsã€
2. ç‚¹å‡»ã€ŒCreate actionã€

**Action æ ‡ç­¾é¡µ**ï¼š

| å­—æ®µ | å€¼ |
|------|-----|
| Name | `Notify on High severity problems` |
| Conditions | æ·»åŠ æ¡ä»¶ï¼ˆè§ä¸‹ï¼‰ |

**æ·»åŠ  Conditions**ï¼š
- Trigger severity `>=` `High`
- Host group `=` `Lab/Linux servers`ï¼ˆä½¿ç”¨ Lesson 02 åˆ›å»ºçš„ Host Groupï¼‰

**Operations æ ‡ç­¾é¡µ**ï¼š

ç‚¹å‡»ã€ŒAddã€æ·»åŠ æ“ä½œï¼š

| å­—æ®µ | å€¼ |
|------|-----|
| Operation type | Send message |
| Send to user groups | é€‰æ‹©ç”¨æˆ·ç»„ï¼ˆå¦‚ Zabbix administratorsï¼‰ |
| Send only to | Email |

**Default subject**ï¼š
```
[{TRIGGER.SEVERITY}] {TRIGGER.NAME}
```

**Default message**ï¼š
```
Host: {HOST.NAME}
Problem: {TRIGGER.NAME}
Severity: {TRIGGER.SEVERITY}
Time: {EVENT.DATE} {EVENT.TIME}
Current value: {ITEM.LASTVALUE}

Original problem ID: {EVENT.ID}
```

**Recovery operations æ ‡ç­¾é¡µ**ï¼š

æ·»åŠ æ¢å¤é€šçŸ¥ï¼š
- Operation type: Send message
- ä½¿ç”¨ç›¸åŒç”¨æˆ·ç»„

3. ç‚¹å‡»ã€ŒAddã€

### 4.2 æµ‹è¯•å‘Šè­¦

è§¦å‘ç£ç›˜å‘Šè­¦æµ‹è¯•ï¼š

```bash
# åœ¨ Monitored Host ä¸Š
# å…ˆæ£€æŸ¥å½“å‰ç£ç›˜ä½¿ç”¨æƒ…å†µ
df -h /

# æ ¹æ®å‰©ä½™ç©ºé—´è°ƒæ•´å¤§å°ï¼ˆç›®æ ‡ï¼šä½¿ç”¨ç‡è¶…è¿‡ 80%ï¼‰
# Monitored Host æœ‰ 8GB ç£ç›˜ï¼Œçº¦ 5GB å¯ç”¨ï¼Œåˆ›å»º 3GB æ–‡ä»¶åº”è§¦å‘å‘Šè­¦
sudo dd if=/dev/zero of=/tmp/bigfile bs=1M count=3000

# ç¡®è®¤ä½¿ç”¨ç‡
df -h /
```

> âš ï¸ **æ³¨æ„**ï¼šåˆ›å»ºè¿‡å¤§æ–‡ä»¶å¯èƒ½å¯¼è‡´ç£ç›˜ 100% æ»¡ï¼Œå½±å“ç³»ç»Ÿè¿è¡Œã€‚è¯·æ ¹æ® `df -h` ç»“æœè°ƒæ•´ `count` å€¼ã€‚

åœ¨ Web UI æ£€æŸ¥ï¼š
1. ã€ŒMonitoringã€â†’ã€ŒProblemsã€æŸ¥çœ‹å‘Šè­¦
2. æ£€æŸ¥é‚®ç®±æ˜¯å¦æ”¶åˆ°é€šçŸ¥

æ¸…ç†ï¼š
```bash
sudo rm /tmp/bigfile
```

---

## Step 5 â€” é…ç½®ç»´æŠ¤çª—å£

> åœºæ™¯ï¼šGolden Weekï¼ˆæ—¥æœ¬é»„é‡‘å‘¨ï¼‰æœŸé—´æŠ‘åˆ¶å‘Šè­¦

### 5.1 åˆ›å»ºç»´æŠ¤çª—å£

1. ã€ŒData collectionã€â†’ã€ŒMaintenanceã€
2. ç‚¹å‡»ã€ŒCreate maintenance periodã€

**Maintenance æ ‡ç­¾é¡µ**ï¼š

| å­—æ®µ | å€¼ |
|------|-----|
| Name | `Golden Week 2025` |
| Maintenance type | `With data collection`ï¼ˆç»§ç»­é‡‡é›†ä½†ä¸å‘Šè­¦ï¼‰ |
| Active since | `2025-05-03 00:00` |
| Active till | `2025-05-07 23:59` |

> âš ï¸ **æ—¶åŒºæ³¨æ„**ï¼šç»´æŠ¤çª—å£æ—¶é—´åŸºäº Zabbix Server æ—¶åŒºã€‚ç¡®ä¿å·²åœ¨ [01 Â· Server åˆå§‹åŒ–](../01-server-setup/) ä¸­è®¾ç½®ä¸º Asia/Tokyoã€‚

**Periods æ ‡ç­¾é¡µ**ï¼š

ç‚¹å‡»ã€ŒAddã€ï¼š
- Period type: One time only
- Date: 2025-05-03
- Maintenance period length: 5 days

**Hosts & groups æ ‡ç­¾é¡µ**ï¼š

- Host groups: é€‰æ‹©éœ€è¦ç»´æŠ¤çš„ç»„
- æˆ– Hosts: é€‰æ‹©ç‰¹å®šä¸»æœº

3. ç‚¹å‡»ã€ŒAddã€

### 5.2 ç»´æŠ¤çª—å£ç±»å‹

| ç±»å‹ | æ•°æ®é‡‡é›† | å‘Šè­¦ | ç”¨é€” |
|------|----------|------|------|
| With data collection | âœ… | âŒ | è®¡åˆ’å†…åœæœºã€å‡æœŸ |
| No data collection | âŒ | âŒ | ç¡¬ä»¶ç»´æŠ¤ã€ç½‘ç»œåˆ‡å‰² |

### 5.3 éªŒè¯ç»´æŠ¤çª—å£

1. åœ¨ç»´æŠ¤æœŸé—´ï¼Œä¸»æœºå›¾æ ‡æ˜¾ç¤ºç»´æŠ¤æ ‡è®°
2. ã€ŒProblemsã€ä¸­å‘Šè­¦è¢«æŠ‘åˆ¶ï¼ˆä½†ä»è®°å½•ï¼‰
3. ç»´æŠ¤ç»“æŸåè‡ªåŠ¨æ¢å¤

---

## Step 6 â€” å‘Šè­¦ç¡®è®¤ï¼ˆAcknowledgmentï¼‰

### 6.1 ç¡®è®¤é—®é¢˜

1. ã€ŒMonitoringã€â†’ã€ŒProblemsã€
2. ç‚¹å‡»é—®é¢˜è¡Œçš„æ—¶é—´æˆ³
3. ç‚¹å‡»ã€ŒAcknowledgeã€

å¡«å†™ï¼š
- Message: æè¿°å¤„ç†æƒ…å†µ
- å¯é€‰æ“ä½œï¼š
  - Close problemï¼ˆæ‰‹åŠ¨å…³é—­ï¼‰
  - Change severityï¼ˆè°ƒæ•´ä¸¥é‡çº§åˆ«ï¼‰

### 6.2 ç¡®è®¤æµç¨‹æœ€ä½³å®è·µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å‘Šè­¦å¤„ç†æµç¨‹                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. æ”¶åˆ°å‘Šè­¦ â”€â”€â–º 2. ç¡®è®¤æ”¶åˆ°ï¼ˆAckï¼‰                         â”‚
â”‚                      â”‚                                       â”‚
â”‚                      â–¼                                       â”‚
â”‚               3. å¼€å§‹å¤„ç†ï¼ˆè®°å½•ï¼‰                            â”‚
â”‚                      â”‚                                       â”‚
â”‚                      â–¼                                       â”‚
â”‚               4. é—®é¢˜è§£å†³                                    â”‚
â”‚                      â”‚                                       â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚               â”‚             â”‚                                â”‚
â”‚               â–¼             â–¼                                â”‚
â”‚          è‡ªåŠ¨æ¢å¤      æ‰‹åŠ¨å…³é—­                              â”‚
â”‚         (Recovery)   (Close problem)                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Mini-Projectï¼šå®Œæ•´å‘Šè­¦é“¾è·¯é…ç½®

> åœºæ™¯ï¼šä¸ºç”Ÿäº§ç¯å¢ƒé…ç½®å®Œæ•´çš„ç£ç›˜å‘Šè­¦é“¾è·¯

### è¦æ±‚

1. **åˆ›å»ºè§¦å‘å™¨**
   - Warning: ç£ç›˜ > 80%
   - High: ç£ç›˜ > 90%
   - Disaster: ç£ç›˜ > 95%

2. **é…ç½® Action**
   - Warning: å‘é€é‚®ä»¶ç»™è¿ç»´ç»„
   - High: å‘é€é‚®ä»¶ + çŸ­ä¿¡ï¼ˆå¦‚æœ‰ï¼‰
   - Disaster: å‘é€é‚®ä»¶ + çŸ­ä¿¡ + ç”µè¯å‡çº§

3. **é…ç½®ç»´æŠ¤çª—å£**
   - æ¯å‘¨æ—¥ 02:00-06:00 ç³»ç»Ÿç»´æŠ¤
   - æŠ‘åˆ¶é Disaster çº§åˆ«å‘Šè­¦

4. **æµ‹è¯•**
   - ç”¨ dd åˆ›å»ºæ–‡ä»¶è§¦å‘å„çº§åˆ«å‘Šè­¦
   - éªŒè¯é€šçŸ¥æ­£å¸¸å‘é€
   - éªŒè¯ç»´æŠ¤çª—å£æŠ‘åˆ¶

---

## é¢è¯•é—®ç­”

### Q: ãƒˆãƒªã‚¬ãƒ¼ã®ãƒ•ãƒ©ãƒƒãƒ”ãƒ³ã‚°ã‚’é˜²ãã«ã¯ï¼Ÿ

**A**:
- **ãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹è¨­å®š**: Problem expression ã¨ Recovery expression ã§ç•°ãªã‚‹é–¾å€¤ã‚’è¨­å®šï¼ˆä¾‹ï¼š80% ã§è­¦å‘Šã€75% ã§å›å¾©ï¼‰
- **{$THRESHOLD} ãƒã‚¯ãƒ­**: é–¾å€¤ã‚’ãƒã‚¯ãƒ­åŒ–ã—ã¦èª¿æ•´ã—ã‚„ã™ã
- **Multiple PROBLEM events**: åŒã˜ãƒˆãƒªã‚¬ãƒ¼ã‹ã‚‰ã®é‡è¤‡ã‚¤ãƒ™ãƒ³ãƒˆç”Ÿæˆã‚’åˆ¶å¾¡
- **nodata() é–¢æ•°**: ãƒ‡ãƒ¼ã‚¿æ¬ ææ™‚ã®èª¤æ¤œçŸ¥ã‚’é˜²æ­¢

### Q: Maintenance Window ã®ä½¿ã„æ–¹ã¯ï¼Ÿ

**A**:
- **è¨ˆç”»åœæ­¢**: ã‚µãƒ¼ãƒãƒ¼ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã€ãƒ‘ãƒƒãƒé©ç”¨æ™‚
- **å®šæœŸãƒ¡ãƒ³ãƒ†**: æ¯é€±æ—¥æ›œæ·±å¤œãªã©å®šæœŸä½œæ¥­æ™‚é–“
- **é•·æœŸä¼‘æš‡**: Golden Weekã€å¹´æœ«å¹´å§‹ãªã©
- **With/Without data collection**: ãƒ‡ãƒ¼ã‚¿ç¶™ç¶šã®å¿…è¦æ€§ã§é¸æŠ
- **ä¸€æ™‚æŠ‘åˆ¶**: èª¤å ±å¯¾å¿œä¸­ã®ä¸€æ™‚çš„ãªæŠ‘åˆ¶ã«ã‚‚ä½¿ç”¨

---

## å¸¸è§é”™è¯¯

| é”™è¯¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| é‚®ä»¶æœªå‘é€ | SMTP é…ç½®é”™è¯¯ | ä½¿ç”¨ Test åŠŸèƒ½éªŒè¯ |
| Action ä¸è§¦å‘ | Conditions ä¸åŒ¹é… | æ£€æŸ¥ä¸¥é‡çº§åˆ«ã€Host group æ¡ä»¶ |
| ç»´æŠ¤çª—å£æ— æ•ˆ | æ—¶åŒºè®¾ç½®é”™è¯¯ | ç¡®è®¤ Zabbix æ—¶åŒºä¸º Asia/Tokyo |
| é‡å¤å‘Šè­¦ | æœªé…ç½® Recovery | æ·»åŠ  Recovery expression |

### æ’æŸ¥ Action

1. ã€ŒReportsã€â†’ã€ŒAction logã€
2. æŸ¥çœ‹ Action æ‰§è¡Œå†å²
3. æ£€æŸ¥å¤±è´¥åŸå› 

---

## æœ¬è¯¾å°ç»“

| æ¦‚å¿µ | è¦ç‚¹ |
|------|------|
| Trigger | åŸºäº Item æ•°æ®çš„å‘Šè­¦æ¡ä»¶ |
| Expression | è§¦å‘æ¡ä»¶è¡¨è¾¾å¼ |
| Recovery | æ¢å¤æ¡ä»¶ï¼Œé˜²æ­¢ Flapping |
| Severity | 6 ä¸ªçº§åˆ«ï¼Œç”¨äºåˆ†çº§å“åº” |
| Action | è§¦å‘å™¨ â†’ é€šçŸ¥çš„æ˜ å°„ |
| Maintenance | è®¡åˆ’å†…æŠ‘åˆ¶å‘Šè­¦ |
| Acknowledgment | å‘Šè­¦ç¡®è®¤å’Œå¤„ç†è®°å½• |

---

## æ¸…ç†æé†’

> âš ï¸ **è´¹ç”¨æé†’**ï¼šå®éªŒç¯å¢ƒæŒç»­äº§ç”Ÿè´¹ç”¨ã€‚å®Œæˆæ•´ä¸ªç³»åˆ—åï¼Œè¯·åˆ é™¤ CloudFormation å †æ ˆã€‚
> è¯¦è§ â†’ [00 Â· æ¸…ç†èµ„æº](../00-architecture-lab/#æ¸…ç†èµ„æº)

---

## ä¸‹ä¸€æ­¥

å‘Šè­¦å·²é…ç½®ï¼ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ æ—¥å¿—ç›‘æ§ã€è‡ªå®šä¹‰æŒ‡æ ‡å’Œ SNMP å…¥é—¨ã€‚

â†’ [05 Â· æ—¥å¿— + è‡ªå®šä¹‰æŒ‡æ ‡](../05-logs-custom/)

## ç³»åˆ—å¯¼èˆª

â† [03 Â· åŸºç¡€ç›‘æ§](../03-monitoring-basics/) | [ç³»åˆ—é¦–é¡µ](../) | [05 Â· æ—¥å¿— + è‡ªå®šä¹‰æŒ‡æ ‡](../05-logs-custom/) â†’
