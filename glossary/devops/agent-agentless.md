# Agent vs Agentless（代理 vs 无代理）

**TL;DR**：Agent 是安装在目标机器上的常驻程序；Agentless 无需安装，通过 SSH/API 远程操作。

## 日常类比

| 模式 | 类比 |
|------|------|
| **Agent** | 在每栋楼派驻一名保安，随时汇报情况 |
| **Agentless** | 总部派人定期巡查，查完就走 |

## 对比表

| 维度 | Agent | Agentless |
|------|-------|-----------|
| **安装** | 需要在每台机器安装 | 不需要 |
| **资源占用** | 常驻内存/CPU | 仅执行时占用 |
| **通信方向** | Agent → Server (Pull/Push) | Control → Target (Push) |
| **实时性** | 持续监控，秒级 | 按需执行，分钟级 |
| **维护成本** | 需要升级/管理 Agent | 只管理控制端 |
| **安全审批** | 可能需要额外审批 | 利用现有 SSH |

## 常见工具分类

| 工具 | 模式 | 说明 |
|------|------|------|
| **Ansible** | Agentless | SSH 连接，无需安装 |
| **Puppet/Chef** | Agent | 需要安装 Agent |
| **Zabbix** | 两者皆可 | Agent 主动/被动 + Agentless (SNMP/SSH) |
| **Prometheus** | Agentless | Pull 模式抓取 metrics |
| **Datadog** | Agent | 需要安装 Agent |

## 如何选择？

```
┌─────────────────────────────────────────────────────┐
│  选择 Agent：                                        │
│    ✅ 需要秒级实时监控                                │
│    ✅ 收集复杂指标（进程、日志）                       │
│    ✅ 目标机器数量稳定，维护成本可控                   │
│                                                     │
│  选择 Agentless：                                    │
│    ✅ 安全策略禁止安装额外软件                        │
│    ✅ 临时/短期任务（一次性配置）                      │
│    ✅ 目标机器数量动态变化                            │
│    ✅ 快速部署，减少维护负担                          │
└─────────────────────────────────────────────────────┘
```

## 日本 IT 现场

> 很多日本企业有严格的安全策略，在服务器安装软件需要走申请流程。  
> Agentless 工具（如 Ansible）更容易获得审批，这也是 Ansible 在日本 SIer 流行的原因之一。

## 面试一句话

> **問**：Agentless のメリットは何ですか？  
> **答**：対象サーバーにソフトウェアをインストールする必要がなく、SSH で接続するだけで済みます。管理対象が増えても Agent の管理コストがかかりません。

---

→ 相关：[Ansible 概念](../../middleware/ansible/00-concepts/) · [Zabbix Agent](../../middleware/zabbix/02-agent-host/)
