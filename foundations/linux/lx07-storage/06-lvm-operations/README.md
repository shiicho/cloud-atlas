# 06 - LVM æ—¥å¸¸æ“ä½œï¼ˆLVM Operationsï¼‰

> **ç›®æ ‡**ï¼šæŒæ¡ LVM æ‰©å±•å’Œç®¡ç†çš„æ ¸å¿ƒæ“ä½œï¼Œé¿å…æœ€å¸¸è§çš„æ–°æ‰‹é™·é˜±  
> **å‰ç½®**ï¼šå®Œæˆ [05 - LVM æ¶æ„](../05-lvm-architecture/) è¯¾ç¨‹  
> **æ—¶é—´**ï¼šâš¡ 20 åˆ†é’Ÿï¼ˆé€Ÿè¯»ï¼‰/ ğŸ”¬ 75 åˆ†é’Ÿï¼ˆå®Œæ•´å®æ“ï¼‰  
> **å®æˆ˜åœºæ™¯**ï¼šç£ç›˜æ‰©å®¹å df -h æ˜¾ç¤ºç©ºé—´æ²¡å˜ï¼Œç”¨æˆ·æŠ•è¯‰"æ‰©å®¹æ²¡ç”Ÿæ•ˆ"  

---

## å°†å­¦åˆ°çš„å†…å®¹

1. ä½¿ç”¨ pvcreateã€vgcreateã€lvcreate åˆ›å»º LVM ç»„ä»¶
2. ä½¿ç”¨ lvextend æ‰©å±•é€»è¾‘å·ï¼ˆé…åˆæ–‡ä»¶ç³»ç»Ÿæ‰©å±•ï¼‰
3. ç†è§£ lvreduce çš„é™åˆ¶å’Œé£é™©ï¼ˆä»… ext4ï¼‰
4. æŒæ¡ VG æ‰©å±•ï¼ˆæ·»åŠ  PV åˆ°ç°æœ‰ VGï¼‰

---

## LVM æ‰©å±•çš„ #1 é™·é˜±

åœ¨æ·±å…¥å­¦ä¹ ä¹‹å‰ï¼Œå…ˆçœ‹è¿™ä¸ªæœ€å¸¸è§çš„æ–°æ‰‹é”™è¯¯ï¼š

```bash
# è¿ç»´äººå‘˜æ‰§è¡Œäº† LVM æ‰©å±•
lvextend -L +10G /dev/vg_data/lv_app

# æ£€æŸ¥ç»“æœ
lvs
# æ˜¾ç¤º LV å·²ç»æ˜¯ 20G äº†

# ä½†æ˜¯ç”¨æˆ·æŠ¥å‘Š...
df -h /app
# è¿˜æ˜¯æ˜¾ç¤º 10Gï¼"æ‰©å®¹æ²¡ç”Ÿæ•ˆï¼"
```

**é—®é¢˜åœ¨å“ªï¼Ÿ** LVï¼ˆé€»è¾‘å·ï¼‰æ‰©å±•äº†ï¼Œä½†æ–‡ä»¶ç³»ç»Ÿæ²¡æœ‰æ‰©å±•ï¼

è¿™æ˜¯ LVM æ“ä½œçš„ **#1 æ–°æ‰‹é™·é˜±**ï¼Œæœ¬è¯¾å°†æ•™ä½ æ­£ç¡®çš„åšæ³•ã€‚

---

## Step 1 -- LVM åˆ›å»ºæµç¨‹å›é¡¾ï¼ˆ10 åˆ†é’Ÿï¼‰

### 1.1 å®Œæ•´åˆ›å»ºæµç¨‹

ä¸Šä¸€è¯¾æˆ‘ä»¬å­¦ä¹ äº† LVM æ¶æ„ã€‚å…ˆå¿«é€Ÿå›é¡¾åˆ›å»ºæµç¨‹ï¼š

```bash
# å‡†å¤‡ï¼šåˆ›å»º loop è®¾å¤‡æ¨¡æ‹Ÿç£ç›˜
fallocate -l 2G /tmp/disk1.img
sudo losetup /dev/loop1 /tmp/disk1.img

# Step 1: åˆ›å»º Physical Volume (PV)
sudo pvcreate /dev/loop1

# Step 2: åˆ›å»º Volume Group (VG)
sudo vgcreate vg_lab /dev/loop1

# Step 3: åˆ›å»º Logical Volume (LV) - ä½¿ç”¨ 1G
sudo lvcreate -L 1G -n lv_data vg_lab

# Step 4: åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ
sudo mkfs.ext4 /dev/vg_lab/lv_data

# Step 5: æŒ‚è½½
sudo mkdir -p /mnt/data
sudo mount /dev/vg_lab/lv_data /mnt/data

# éªŒè¯
df -h /mnt/data
```

### 1.2 æŸ¥çœ‹ LVM çŠ¶æ€

```bash
# ä¸‰ä¸ªæŸ¥çœ‹å‘½ä»¤
pvs    # Physical Volume çŠ¶æ€
vgs    # Volume Group çŠ¶æ€
lvs    # Logical Volume çŠ¶æ€

# è¯¦ç»†ä¿¡æ¯
pvdisplay /dev/loop1
vgdisplay vg_lab
lvdisplay /dev/vg_lab/lv_data
```

---

## Step 2 -- æ­£ç¡®çš„ LV æ‰©å±•æ–¹æ³•ï¼ˆ15 åˆ†é’Ÿï¼‰

### 2.1 æ¨èæ–¹æ³•ï¼šlvextend -r

`-r` å‚æ•°ï¼ˆ`--resizefs`ï¼‰ä¼šè‡ªåŠ¨è°ƒæ•´æ–‡ä»¶ç³»ç»Ÿå¤§å°ï¼š

```bash
# æ¨èï¼ä¸€æ¡å‘½ä»¤å®Œæˆ LV å’Œæ–‡ä»¶ç³»ç»Ÿæ‰©å±•
sudo lvextend -r -L +500M /dev/vg_lab/lv_data

# éªŒè¯ï¼šLV å’Œæ–‡ä»¶ç³»ç»Ÿéƒ½æ‰©å±•äº†
lvs
df -h /mnt/data
```

`-r` å‚æ•°ä¼šè‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç³»ç»Ÿç±»å‹å¹¶è°ƒç”¨ç›¸åº”çš„æ‰©å±•å‘½ä»¤ï¼š
- ext4 -> `resize2fs`
- XFS -> `xfs_growfs`

### 2.2 æ‰©å±•é€‰é¡¹

```bash
# å¢åŠ æŒ‡å®šå¤§å°
lvextend -r -L +500M /dev/vg_lab/lv_data

# æ‰©å±•åˆ°æŒ‡å®šå¤§å°
lvextend -r -L 2G /dev/vg_lab/lv_data

# ä½¿ç”¨ VG å‰©ä½™ç©ºé—´çš„ç™¾åˆ†æ¯”
lvextend -r -l +50%FREE /dev/vg_lab/lv_data

# ä½¿ç”¨ VG å…¨éƒ¨å‰©ä½™ç©ºé—´
lvextend -r -l +100%FREE /dev/vg_lab/lv_data
```

### 2.3 æ‰‹åŠ¨æ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼ˆäº†è§£åŸç†ï¼‰

å¦‚æœä½ éœ€è¦åˆ†æ­¥æ“ä½œï¼š

```bash
# Step 1: æ‰©å±• LV
sudo lvextend -L +500M /dev/vg_lab/lv_data

# Step 2: æ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼ˆæ ¹æ®ç±»å‹é€‰æ‹©ï¼‰

# ext4 æ–‡ä»¶ç³»ç»Ÿ
sudo resize2fs /dev/vg_lab/lv_data

# XFS æ–‡ä»¶ç³»ç»Ÿï¼ˆæ³¨æ„ï¼šä½¿ç”¨æŒ‚è½½ç‚¹ï¼ï¼‰
sudo xfs_growfs /mnt/data
```

> **å…³é”®åŒºåˆ«**ï¼š  
> - `resize2fs` ä½¿ç”¨è®¾å¤‡è·¯å¾„ï¼š`/dev/vg_lab/lv_data`  
> - `xfs_growfs` ä½¿ç”¨æŒ‚è½½ç‚¹ï¼š`/mnt/data`  

---

## Step 3 -- ç¾éš¾å®éªŒï¼šå¿˜è®°æ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼ˆ20 åˆ†é’Ÿï¼‰

è¿™æ˜¯æœ¬è¯¾æœ€é‡è¦çš„å®éªŒã€‚æˆ‘ä»¬æ•…æ„é‡ç°è¿™ä¸ªé”™è¯¯ï¼Œç†è§£é—®é¢˜çš„æœ¬è´¨ã€‚

### 3.1 åœºæ™¯è®¾ç½®

```bash
# ç¡®è®¤å½“å‰çŠ¶æ€
lvs /dev/vg_lab/lv_data
df -h /mnt/data
```

è®°å½•å½“å‰ LV å¤§å°å’Œæ–‡ä»¶ç³»ç»Ÿå¤§å°ã€‚

### 3.2 åˆ¶é€ é—®é¢˜

```bash
# åªæ‰©å±• LVï¼Œä¸æ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼ˆé”™è¯¯ç¤ºèŒƒï¼‰
sudo lvextend -L +200M /dev/vg_lab/lv_data

# æ£€æŸ¥ LV - å·²ç»æ‰©å±•äº†ï¼
lvs /dev/vg_lab/lv_data
# LSize å¢åŠ äº† 200M

# æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ - æ²¡æœ‰å˜åŒ–ï¼
df -h /mnt/data
# Size è¿˜æ˜¯åŸæ¥çš„å¤§å°ï¼
```

### 3.3 è¯Šæ–­é—®é¢˜

è¿™å°±æ˜¯ç”¨æˆ·æŠ¥å‘Š"æ‰©å®¹æ²¡ç”Ÿæ•ˆ"çš„åŸå› ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Logical Volume                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚      Filesystem            â”‚ â”‚    Unused Space         â”‚â”‚
â”‚  â”‚      (åŸå¤§å°)              â”‚ â”‚    (æ–°å¢ 200M)          â”‚â”‚
â”‚  â”‚      df -h èƒ½çœ‹åˆ°          â”‚ â”‚    df -h çœ‹ä¸åˆ°ï¼       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

LV æ˜¯å®¹å™¨ï¼Œæ–‡ä»¶ç³»ç»Ÿæ˜¯å†…å®¹ã€‚æ‰©å¤§äº†å®¹å™¨ï¼Œå†…å®¹æ²¡æœ‰å¡«æ»¡æ–°ç©ºé—´ã€‚

### 3.4 ä¿®å¤é—®é¢˜

```bash
# ext4 æ–‡ä»¶ç³»ç»Ÿ
sudo resize2fs /dev/vg_lab/lv_data

# å†æ¬¡æ£€æŸ¥
df -h /mnt/data
# ç°åœ¨å¤§å°æ­£ç¡®äº†ï¼
```

### 3.5 å®éªŒå¿ƒå¾—

| lvs æ˜¾ç¤º | df -h æ˜¾ç¤º | çŠ¶æ€ | ä¿®å¤ |
|----------|------------|------|------|
| æ–°å¤§å° | æ–°å¤§å° | æ­£å¸¸ | - |
| æ–°å¤§å° | æ—§å¤§å° | å¿˜è®°æ‰©å±• FS | resize2fs / xfs_growfs |
| æ—§å¤§å° | æ—§å¤§å° | LV æ‰©å±•å¤±è´¥ | æ£€æŸ¥ VG ç©ºé—´ |

---

## Step 4 -- æ‰©å±• VGï¼šæ·»åŠ æ–°ç£ç›˜ï¼ˆ15 åˆ†é’Ÿï¼‰

å½“ VG ç©ºé—´ä¸è¶³æ—¶ï¼Œéœ€è¦æ·»åŠ æ–°çš„ PVã€‚

### 4.1 åœºæ™¯ï¼šVG ç©ºé—´ä¸è¶³

```bash
# æŸ¥çœ‹ VG å‰©ä½™ç©ºé—´
vgs vg_lab
# VFree åˆ—æ˜¾ç¤ºå‰©ä½™ç©ºé—´

# å¦‚æœ VFree æ¥è¿‘ 0ï¼Œéœ€è¦æ‰©å±• VG
```

### 4.2 æ·»åŠ æ–° PV åˆ° VG

```bash
# åˆ›å»ºæ–°çš„æ¨¡æ‹Ÿç£ç›˜
fallocate -l 1G /tmp/disk2.img
sudo losetup /dev/loop2 /tmp/disk2.img

# å°†æ–°ç£ç›˜åˆå§‹åŒ–ä¸º PV
sudo pvcreate /dev/loop2

# å°† PV æ·»åŠ åˆ°ç°æœ‰ VG
sudo vgextend vg_lab /dev/loop2

# éªŒè¯
vgs vg_lab
# VFree å¢åŠ äº†ï¼

pvs
# å¯ä»¥çœ‹åˆ°ä¸¤ä¸ª PV éƒ½å±äº vg_lab
```

### 4.3 çœŸå®åœºæ™¯ï¼šäº‘æœåŠ¡å™¨æ‰©å®¹

åœ¨ AWSã€Azure ç­‰äº‘ç¯å¢ƒä¸­ï¼š

```bash
# 1. åœ¨äº‘æ§åˆ¶å°æ‰©å±• EBS/Disk å¤§å°ï¼ˆä¾‹å¦‚ä» 20G åˆ° 50Gï¼‰

# 2. è®©ç³»ç»Ÿè¯†åˆ«æ–°å¤§å°
sudo growpart /dev/xvda 2    # æ‰©å±•åˆ†åŒº

# 3. æ‰©å±• PV
sudo pvresize /dev/xvda2

# 4. æ‰©å±• LV + æ–‡ä»¶ç³»ç»Ÿ
sudo lvextend -r -l +100%FREE /dev/vg/lv_root
```

---

## Step 5 -- LV æ”¶ç¼©ï¼šå±é™©æ“ä½œï¼ˆ10 åˆ†é’Ÿï¼‰

### 5.1 å…³é”®é™åˆ¶

| æ–‡ä»¶ç³»ç»Ÿ | æ”¯æŒæ”¶ç¼© | è¯´æ˜ |
|----------|----------|------|
| ext4 | æ˜¯ | éœ€è¦å…ˆæ”¶ç¼© FSï¼Œå†æ”¶ç¼© LV |
| XFS | **å¦** | XFS è®¾è®¡ä¸Šä¸æ”¯æŒæ”¶ç¼© |
| Btrfs | æ˜¯ | åŸç”Ÿæ”¯æŒ |

### 5.2 ext4 æ”¶ç¼©æµç¨‹ï¼ˆé«˜é£é™©ï¼‰

```bash
# è­¦å‘Šï¼šæ”¶ç¼©æ“ä½œæœ‰æ•°æ®ä¸¢å¤±é£é™©ï¼åŠ¡å¿…å…ˆå¤‡ä»½ï¼

# 1. å¸è½½æ–‡ä»¶ç³»ç»Ÿ
sudo umount /mnt/data

# 2. æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ
sudo e2fsck -f /dev/vg_lab/lv_data

# 3. æ”¶ç¼©æ–‡ä»¶ç³»ç»Ÿåˆ°ç›®æ ‡å¤§å°
sudo resize2fs /dev/vg_lab/lv_data 500M

# 4. æ”¶ç¼© LV
sudo lvreduce -L 500M /dev/vg_lab/lv_data

# 5. é‡æ–°æŒ‚è½½
sudo mount /dev/vg_lab/lv_data /mnt/data
```

> **è­¦å‘Š**ï¼šå¦‚æœæ”¶ç¼© LV æ¯”æ–‡ä»¶ç³»ç»Ÿæ›´å°ï¼Œä¼šå¯¼è‡´æ•°æ®æŸåï¼  

### 5.3 ä¸ºä»€ä¹ˆ XFS ä¸æ”¯æŒæ”¶ç¼©ï¼Ÿ

XFS çš„è®¾è®¡å“²å­¦æ˜¯"åªå¢ä¸å‡"ã€‚å¦‚æœéœ€è¦å‡å° XFS å·ï¼š
1. å¤‡ä»½æ•°æ®
2. åˆ é™¤ LV
3. åˆ›å»ºæ›´å°çš„ LV
4. æ¢å¤æ•°æ®

> **æ—¥æœ¬ IT è¿ç»´å®è·µ**ï¼šç”Ÿäº§ç¯å¢ƒä¸­å¾ˆå°‘æ‰§è¡Œæ”¶ç¼©æ“ä½œã€‚é€šå¸¸æ˜¯åœ¨å®¹é‡è§„åˆ’é˜¶æ®µé¿å…è¿‡åº¦åˆ†é…ï¼Œæˆ–è€…æ¥å—ç°æœ‰å¤§å°ã€‚  

---

## èŒåœºå°è´´å£«ï¼ˆJapan IT Contextï¼‰

### å˜æ›´ç®¡ç†æœ¯è¯­

| æ—¥è¯­æœ¯è¯­ | å«ä¹‰ | åœºæ™¯ |
|----------|------|------|
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ‹¡å¼µ | å­˜å‚¨æ‰©å±• | LVM extend æ“ä½œ |
| å®¹é‡æ‹¡å¼µç”³è«‹ | å®¹é‡æ‰©å±•ç”³è¯· | å˜æ›´ç®¡ç†æµç¨‹ |
| ä½œæ¥­æ‰‹é †æ›¸ | æ“ä½œæ‰‹é¡ºä¹¦ | æ‰§è¡Œæ­¥éª¤æ–‡æ¡£ |
| å¤‰æ›´ç®¡ç† | å˜æ›´ç®¡ç† | ç”Ÿäº§ç¯å¢ƒå˜æ›´å®¡æ‰¹ |

### é¢è¯•å¸¸è§é—®é¢˜

**Q: LVM ã®æ‹¡å¼µã§ã€df ã‚³ãƒãƒ³ãƒ‰ã®è¡¨ç¤ºãŒå¤‰ã‚ã‚‰ãªã„å ´åˆã®åŸå› ã¯ï¼Ÿ**

A: LVï¼ˆè«–ç†ãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼‰ã¯æ‹¡å¼µã•ã‚Œã¾ã—ãŸãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æ‹¡å¼µãŒæ¼ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ext4 ãªã‚‰ `resize2fs`ã€XFS ãªã‚‰ `xfs_growfs` ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’æ‹¡å¼µã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚`lvextend -r` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ãˆã°ã€ä¸¡æ–¹ã‚’åŒæ™‚ã«å®Ÿè¡Œã§ãã¾ã™ã€‚

**Q: XFS ã§ LV ã‚’ç¸®å°ã§ãã¾ã™ã‹ï¼Ÿ**

A: ã„ã„ãˆã€XFS ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ç¸®å°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ç¸®å°ãŒå¿…è¦ãªå ´åˆã¯ã€ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€LV ã®å†ä½œæˆã€ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒãŒå¿…è¦ã§ã™ã€‚

### ä½œæ¥­æ‰‹é †æ›¸ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ

1. **äº‹å‰ç¢ºèª**ï¼šç¾åœ¨ã® LV/FS ã‚µã‚¤ã‚ºã‚’è¨˜éŒ²
2. **æ‹¡å¼µå®Ÿè¡Œ**ï¼š`lvextend -r` ã‚’ä½¿ç”¨ï¼ˆFS æ‹¡å¼µã‚‚åŒæ™‚ã«ï¼‰
3. **äº‹å¾Œç¢ºèª**ï¼š`lvs` ã¨ `df -h` ä¸¡æ–¹ã§ç¢ºèª
4. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †**ï¼šç¸®å°ã¯éæ¨å¥¨ã€äº‹å‰ã«å®¹é‡è¨ˆç”»ã‚’

---

## æœ¬èª²å°çµ

| æ“ä½œ | ã‚³ãƒãƒ³ãƒ‰ | æ³¨æ„ç‚¹ |
|------|----------|--------|
| LV æ‰©å±•ï¼ˆæ¨èï¼‰ | `lvextend -r -L +SIZE` | -r è‡ªåŠ¨æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ |
| æ‰‹åŠ¨æ‰©å±• ext4 | `resize2fs /dev/path` | éœ€è¦è®¾å¤‡è·¯å¾„ |
| æ‰‹åŠ¨æ‰©å±• XFS | `xfs_growfs /mount` | éœ€è¦æŒ‚è½½ç‚¹ |
| VG æ‰©å±• | `vgextend vg pv` | å…ˆ pvcreate æ–° PV |
| LV æ”¶ç¼© | `lvreduce -L SIZE` | ext4 only, é«˜é£é™© |

**æ ¸å¿ƒè¦ç‚¹**ï¼šæ°¸è¿œä½¿ç”¨ `lvextend -r`ï¼Œé¿å…å¿˜è®°æ‰©å±•æ–‡ä»¶ç³»ç»Ÿçš„é™·é˜±ã€‚

---

## æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬è¯¾åï¼Œç¡®è®¤ä½ èƒ½å¤Ÿï¼š

- [ ] ä½¿ç”¨ `lvextend -r` æ‰©å±• LV å’Œæ–‡ä»¶ç³»ç»Ÿ
- [ ] è§£é‡Šä¸ºä»€ä¹ˆ `lvs` å’Œ `df -h` æ˜¾ç¤ºä¸åŒå¤§å°
- [ ] ä½¿ç”¨ `resize2fs` æˆ– `xfs_growfs` æ‰‹åŠ¨æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ
- [ ] ä½¿ç”¨ `vgextend` å‘ VG æ·»åŠ æ–° PV
- [ ] è¯´æ˜ XFS ä¸æ”¯æŒæ”¶ç¼©çš„åŸå› 
- [ ] é‡ç°å¹¶ä¿®å¤"LVM æ‰©å±•é¡ºåºé”™è¯¯"é—®é¢˜

---

## å®éªŒæ¸…ç†

```bash
# å¸è½½æ–‡ä»¶ç³»ç»Ÿ
sudo umount /mnt/data

# åˆ é™¤ LV
sudo lvremove -f /dev/vg_lab/lv_data

# åˆ é™¤ VG
sudo vgremove vg_lab

# åˆ é™¤ PV
sudo pvremove /dev/loop1 /dev/loop2

# é‡Šæ”¾ loop è®¾å¤‡
sudo losetup -d /dev/loop1 /dev/loop2 2>/dev/null

# åˆ é™¤æ¨¡æ‹Ÿç£ç›˜æ–‡ä»¶
rm -f /tmp/disk1.img /tmp/disk2.img
```

---

## å»¶ä¼¸é˜…è¯»

- [Red Hat: Extending Logical Volumes](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_logical_volumes/modifying-the-size-of-a-logical-volume_configuring-and-managing-logical-volumes)
- [lvextend man page](https://man7.org/linux/man-pages/man8/lvextend.8.html)
- [resize2fs man page](https://man7.org/linux/man-pages/man8/resize2fs.8.html)
- ä¸Šä¸€è¯¾ï¼š[05 - LVM æ¶æ„](../05-lvm-architecture/) -- ç†è§£ PV/VG/LV ä¸‰å±‚æ¶æ„
- ä¸‹ä¸€è¯¾ï¼š[07 - LVM å¿«ç…§](../07-lvm-snapshots/) -- Copy-on-Write åŸç†ä¸åº”ç”¨

---

## ç³»åˆ—å¯¼èˆª

[<-- 05 - LVM æ¶æ„](../05-lvm-architecture/) | [ç³»åˆ—é¦–é¡µ](../) | [07 - LVM å¿«ç…§ -->](../07-lvm-snapshots/)
