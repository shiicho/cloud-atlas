# 04 - æŒ‚è½½ä¸ fstab

> **ç›®æ ‡**ï¼šæŒæ¡ mount/umount æ“ä½œå’Œ fstab é…ç½®ï¼Œå­¦ä¼šä» fstab æ•…éšœä¸­æ¢å¤  
> **å‰ç½®**ï¼šå®Œæˆ [03 - æ–‡ä»¶ç³»ç»Ÿé€‰æ‹©ä¸åˆ›å»º](../03-filesystems/)  
> **æ—¶é—´**ï¼šâš¡ 15 åˆ†é’Ÿï¼ˆé€Ÿè¯»ï¼‰/ ğŸ”¬ 60 åˆ†é’Ÿï¼ˆå®Œæ•´å®æ“ï¼‰  
> **ç¯å¢ƒ**ï¼šä»»æ„ Linuxï¼ˆUbuntu/RHEL/AlmaLinuxï¼‰ï¼Œéœ€è¦ root æƒé™  

---

## å°†å­¦åˆ°çš„å†…å®¹

1. ä½¿ç”¨ mount/umount è¿›è¡Œæ‰‹åŠ¨æŒ‚è½½
2. ç†è§£ fstab å…­ä¸ªå­—æ®µçš„å«ä¹‰
3. æŒæ¡ nofailã€x-systemd.device-timeout ç­‰å…³é”®é€‰é¡¹
4. ç»ƒä¹  fstab é”™è¯¯å¯¼è‡´å¯åŠ¨å¤±è´¥çš„æ¢å¤

---

## Step 1 - mount/umount åŸºç¡€æ“ä½œ

### 1.1 ä¸´æ—¶æŒ‚è½½

æŒ‚è½½ï¼ˆmountï¼‰æ˜¯å°†æ–‡ä»¶ç³»ç»Ÿé™„åŠ åˆ°ç›®å½•æ ‘çš„è¿‡ç¨‹ã€‚æœ€ç®€å•çš„æŒ‚è½½ï¼š

```bash
# åˆ›å»ºæŒ‚è½½ç‚¹
sudo mkdir -p /mnt/data

# æŒ‚è½½åˆ†åŒº
sudo mount /dev/sdb1 /mnt/data

# éªŒè¯æŒ‚è½½
df -h /mnt/data
mount | grep /mnt/data
```

### 1.2 æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹

```bash
# æ˜¾å¼æŒ‡å®šç±»å‹ï¼ˆæ¨èï¼‰
sudo mount -t ext4 /dev/sdb1 /mnt/data
sudo mount -t xfs /dev/sdb2 /mnt/xfs_data

# ä½¿ç”¨ UUID æŒ‚è½½ï¼ˆæœ€å®‰å…¨ï¼‰
sudo mount UUID=a1b2c3d4-e5f6-7890-abcd-ef1234567890 /mnt/data
```

### 1.3 å¸è½½æ–‡ä»¶ç³»ç»Ÿ

```bash
# æ ‡å‡†å¸è½½
sudo umount /mnt/data

# å¦‚æœæç¤º "target is busy"
lsof /mnt/data          # æŸ¥çœ‹è°åœ¨ä½¿ç”¨
fuser -vm /mnt/data     # æ˜¾ç¤ºè¿›ç¨‹è¯¦æƒ…
sudo umount -l /mnt/data  # æ‡’å¸è½½ï¼ˆlazy unmountï¼‰
```

> **é‡è¦**ï¼š`umount` ä¸æ˜¯ `unmount`ï¼è¿™æ˜¯åˆå­¦è€…å¸¸çŠ¯çš„æ‹¼å†™é”™è¯¯ã€‚  

---

## Step 2 - fstab è§£å‰–ï¼šå…­ä¸ªå­—æ®µ

`/etc/fstab` æ˜¯ Linux æœ€å…³é”®çš„é…ç½®æ–‡ä»¶ä¹‹ä¸€ã€‚**ä¸€è¡Œé”™è¯¯å°±èƒ½è®©æœåŠ¡å™¨æ— æ³•å¯åŠ¨**ã€‚

### 2.1 fstab ç»“æ„å›¾

![fstab-fields](images/fstab-fields.png)

<details>
<summary>View ASCII source</summary>

```
/etc/fstab å…­å­—æ®µè§£æ

 å­—æ®µ1          å­—æ®µ2         å­—æ®µ3    å­—æ®µ4           å­—æ®µ5  å­—æ®µ6
 è®¾å¤‡           æŒ‚è½½ç‚¹        ç±»å‹     é€‰é¡¹            dump   pass
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

 UUID=abc123    /data         ext4     defaults,nofail  0      2
      â”‚            â”‚           â”‚            â”‚           â”‚      â”‚
      â”‚            â”‚           â”‚            â”‚           â”‚      â””â”€ fsck é¡ºåº
      â”‚            â”‚           â”‚            â”‚           â”‚         0=è·³è¿‡ 1=æ ¹ 2=å…¶ä»–
      â”‚            â”‚           â”‚            â”‚           â”‚
      â”‚            â”‚           â”‚            â”‚           â””â”€ dump å¤‡ä»½
      â”‚            â”‚           â”‚            â”‚              0=ä¸å¤‡ä»½ï¼ˆç°ä»£ç³»ç»Ÿéƒ½ç”¨0ï¼‰
      â”‚            â”‚           â”‚            â”‚
      â”‚            â”‚           â”‚            â””â”€ æŒ‚è½½é€‰é¡¹ï¼ˆé€—å·åˆ†éš”ï¼‰
      â”‚            â”‚           â”‚               defaults = rw,suid,dev,exec,auto,nouser,async
      â”‚            â”‚           â”‚               nofail = è®¾å¤‡ä¸å­˜åœ¨æ—¶ä¸é˜»å¡å¯åŠ¨
      â”‚            â”‚           â”‚
      â”‚            â”‚           â””â”€ æ–‡ä»¶ç³»ç»Ÿç±»å‹
      â”‚            â”‚              ext4, xfs, swap, nfs, cifs...
      â”‚            â”‚
      â”‚            â””â”€ æŒ‚è½½ç‚¹ç›®å½•ï¼ˆå¿…é¡»å­˜åœ¨ï¼‰
      â”‚
      â””â”€ è®¾å¤‡æ ‡è¯†ï¼ˆæ¨èç”¨ UUIDï¼‰
         UUID=xxx, LABEL=xxx, /dev/sdX (å±é™©!)
```

</details>

### 2.2 å­—æ®µè¯¦è§£

| å­—æ®µ | åç§° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| 1 | è®¾å¤‡ | æ¨è UUIDï¼Œé¿å… /dev/sdX | `UUID=abc123-...` |
| 2 | æŒ‚è½½ç‚¹ | ç›®å½•è·¯å¾„ï¼Œå¿…é¡»å­˜åœ¨ | `/data`, `/mnt/backup` |
| 3 | ç±»å‹ | æ–‡ä»¶ç³»ç»Ÿç±»å‹ | `ext4`, `xfs`, `swap` |
| 4 | é€‰é¡¹ | æŒ‚è½½å‚æ•° | `defaults,nofail` |
| 5 | dump | å¤‡ä»½æ ‡å¿—ï¼ˆå‡ ä¹æ€»æ˜¯ 0ï¼‰ | `0` |
| 6 | pass | fsck æ£€æŸ¥é¡ºåº | `0`, `1`, `2` |

### 2.3 pass å­—æ®µè¯¦è§£

```bash
# pass å­—æ®µçš„ä¸‰ä¸ªå€¼
0  # ä¸æ£€æŸ¥ï¼ˆswapã€ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿã€éå…³é”®åˆ†åŒºï¼‰
1  # æ ¹åˆ†åŒºï¼ˆ/ï¼‰ä¸“ç”¨ï¼Œæœ€å…ˆæ£€æŸ¥
2  # å…¶ä»–æœ¬åœ°åˆ†åŒºï¼Œåœ¨æ ¹åˆ†åŒºåæ£€æŸ¥
```

---

## Step 3 - å…³é”®é€‰é¡¹ï¼šnofail å’Œ x-systemd.device-timeout

### 3.1 nofailï¼šé˜²æ­¢å¯åŠ¨å¡æ­»

**åœºæ™¯**ï¼šæœåŠ¡å™¨æœ‰ä¸€å—éå…³é”®çš„æ•°æ®ç›˜ï¼Œå¦‚æœè¿™å—ç›˜æ•…éšœæˆ–è¢«æ‹”æ‰ï¼ŒæœåŠ¡å™¨è¿˜èƒ½æ­£å¸¸å¯åŠ¨å—ï¼Ÿ

```bash
# å±é™©é…ç½®ï¼šç¼ºå°‘ nofail
UUID=xxx-xxx  /backup  ext4  defaults  0  2
# ç»“æœï¼šç£ç›˜ä¸å­˜åœ¨æ—¶ï¼ŒæœåŠ¡å™¨è¿›å…¥ Emergency Modeï¼

# å®‰å…¨é…ç½®ï¼šæ·»åŠ  nofail
UUID=xxx-xxx  /backup  ext4  defaults,nofail  0  2
# ç»“æœï¼šç£ç›˜ä¸å­˜åœ¨æ—¶ï¼Œè·³è¿‡æŒ‚è½½ï¼Œç³»ç»Ÿæ­£å¸¸å¯åŠ¨
```

> **è§„åˆ™**ï¼šé™¤äº†æ ¹åˆ†åŒºå’Œå…³é”®ç³»ç»Ÿåˆ†åŒºï¼Œå…¶ä»–åˆ†åŒºéƒ½åº”è¯¥åŠ  `nofail`ã€‚  

### 3.2 x-systemd.device-timeoutï¼šè®¾å¤‡ç­‰å¾…è¶…æ—¶

å½“è®¾å¤‡å­˜åœ¨ä½†å“åº”æ…¢ï¼ˆå¦‚ç½‘ç»œå­˜å‚¨ã€USB è®¾å¤‡ï¼‰ï¼š

```bash
# é»˜è®¤ç­‰å¾… 90 ç§’ï¼Œå¯èƒ½å¯¼è‡´å¯åŠ¨å¾ˆæ…¢
UUID=xxx-xxx  /slow_storage  ext4  defaults,nofail  0  2

# ä¼˜åŒ–ï¼šè®¾ç½® 10 ç§’è¶…æ—¶
UUID=xxx-xxx  /slow_storage  ext4  defaults,nofail,x-systemd.device-timeout=10  0  2
```

### 3.3 å¸¸ç”¨æŒ‚è½½é€‰é¡¹é€ŸæŸ¥

| é€‰é¡¹ | å«ä¹‰ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| `defaults` | rw,suid,dev,exec,auto,nouser,async | æ ‡å‡†é…ç½® |
| `nofail` | è®¾å¤‡ä¸å­˜åœ¨æ—¶ç»§ç»­å¯åŠ¨ | éå…³é”®åˆ†åŒº |
| `noauto` | å¯åŠ¨æ—¶ä¸è‡ªåŠ¨æŒ‚è½½ | å¯ç§»åŠ¨è®¾å¤‡ |
| `ro` | åªè¯»æŒ‚è½½ | ä¿æŠ¤æ•°æ® |
| `noexec` | ç¦æ­¢æ‰§è¡ŒäºŒè¿›åˆ¶ | å®‰å…¨åŠ å›º |
| `nosuid` | ç¦æ­¢ SUID ä½ | å®‰å…¨åŠ å›º |
| `nodev` | ç¦æ­¢è®¾å¤‡æ–‡ä»¶ | å®‰å…¨åŠ å›º |
| `x-systemd.device-timeout=N` | è®¾å¤‡ç­‰å¾… N ç§’ | æ…¢è®¾å¤‡ |

---

## Step 4 - ç¾éš¾å®éªŒï¼šfstab æ•…éšœæ¢å¤

> **è¿™æ˜¯æœ¬è¯¾æœ€é‡è¦çš„å®éªŒï¼** åœ¨å®‰å…¨ç¯å¢ƒä¸­ç»ƒä¹ ï¼Œä»¥ä¾¿çœŸæ­£æ•…éšœæ—¶èƒ½å¿«é€Ÿæ¢å¤ã€‚  

### 4.1 åœºæ™¯ï¼šMonday Morning Boot Failure

**ç—‡çŠ¶**ï¼š
- æœåŠ¡å™¨é‡å¯åè¿›å…¥ Emergency Mode
- æ§åˆ¶å°æ˜¾ç¤º "Dependency failed for /data"
- ç³»ç»Ÿæç¤ºè¾“å…¥ root å¯†ç 

**æ ¹å› **ï¼šfstab ä¸­é…ç½®äº†ä¸å­˜åœ¨çš„ UUID æˆ–è¯­æ³•é”™è¯¯

### 4.2 åŠ¨æ‰‹å®éªŒï¼šæ•…æ„ç ´å fstab

> **è­¦å‘Š**ï¼šè¯·åœ¨è™šæ‹Ÿæœºæˆ–æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œï¼  

```bash
# 1. å¤‡ä»½ fstabï¼ˆéå¸¸é‡è¦ï¼ï¼‰
sudo cp /etc/fstab /etc/fstab.backup

# 2. åˆ›å»ºä¸€ä¸ªä¼šå¤±è´¥çš„æ¡ç›®
sudo tee -a /etc/fstab << 'EOF'
UUID=00000000-0000-0000-0000-000000000000  /nonexistent  ext4  defaults  0  2
EOF

# 3. æµ‹è¯•é…ç½®ï¼ˆä¸è¦ç›´æ¥é‡å¯ï¼ï¼‰
sudo mount -a
# ä½ ä¼šçœ‹åˆ°é”™è¯¯ä¿¡æ¯

# 4. ç°åœ¨æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š
#    A) ä¿®å¤å¹¶ç»§ç»­ï¼ˆæ¨èï¼‰
#    B) é‡å¯ä½“éªŒ Emergency Modeï¼ˆä»…åœ¨æµ‹è¯•ç¯å¢ƒï¼‰
```

### 4.3 Emergency Mode æ¢å¤æ­¥éª¤

å¦‚æœä½ é€‰æ‹©äº†é‡å¯ï¼ˆæˆ–çœŸå®æ•…éšœï¼‰ï¼š

```bash
# 1. çœ‹åˆ° Emergency Mode æç¤ºï¼Œè¾“å…¥ root å¯†ç 

# 2. æ ¹æ–‡ä»¶ç³»ç»Ÿå¯èƒ½æ˜¯åªè¯»çš„ï¼Œéœ€è¦é‡æ–°æŒ‚è½½ä¸ºå¯å†™
mount -o remount,rw /

# 3. ç¼–è¾‘ fstabï¼Œæ³¨é‡Šæˆ–åˆ é™¤é”™è¯¯è¡Œ
vi /etc/fstab
# åœ¨é—®é¢˜è¡Œå‰åŠ  # å·æ³¨é‡Šæ‰

# 4. ä¿å­˜é€€å‡ºåé‡å¯
reboot
```

### 4.4 æ¢å¤åéªŒè¯

```bash
# ç¡®è®¤ç³»ç»Ÿæ­£å¸¸å¯åŠ¨
systemctl status

# æ£€æŸ¥æ‰€æœ‰æŒ‚è½½ç‚¹
df -h

# æ¢å¤åŸå§‹ fstabï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo cp /etc/fstab.backup /etc/fstab
```

---

## åæ¨¡å¼ä¸æ­£ç¡®åšæ³•

### åæ¨¡å¼ 1ï¼šéå…³é”®åˆ†åŒºç¼ºå°‘ nofail

```bash
# é”™è¯¯
UUID=xxx-xxx  /backup  ext4  defaults  0  2

# æ­£ç¡®
UUID=xxx-xxx  /backup  ext4  defaults,nofail  0  2
```

**é£é™©**ï¼šå¤‡ä»½ç£ç›˜æ•…éšœå¯¼è‡´æ•´ä¸ªæœåŠ¡å™¨æ— æ³•å¯åŠ¨

### åæ¨¡å¼ 2ï¼šä¿®æ”¹ fstab åç›´æ¥é‡å¯

```bash
# å±é™©æ“ä½œæµç¨‹
vim /etc/fstab
reboot              # ç›´æ¥é‡å¯

# æ­£ç¡®æ“ä½œæµç¨‹
vim /etc/fstab
mount -a            # å…ˆæµ‹è¯•ï¼
echo $?             # ç¡®è®¤è¿”å› 0
reboot              # ç¡®è®¤æ— è¯¯åå†é‡å¯
```

**è§„åˆ™**ï¼š**æ°¸è¿œå…ˆ `mount -a` æµ‹è¯•ï¼Œå†é‡å¯ï¼**

### åæ¨¡å¼ 3ï¼šä½¿ç”¨ /dev/sdX è€Œé UUID

```bash
# å±é™©ï¼ˆå·²åœ¨ Lesson 01 è¯¦ç»†è§£é‡Šï¼‰
/dev/sdb1  /data  ext4  defaults  0  2

# æ­£ç¡®
UUID=a1b2c3d4-...  /data  ext4  defaults  0  2
```

---

## åŠ¨æ‰‹å®éªŒï¼šæ·»åŠ æ–°åˆ†åŒºåˆ° fstab

```bash
# 1. è·å–åˆ†åŒº UUID
sudo blkid /dev/sdb1
# /dev/sdb1: UUID="a1b2c3d4-e5f6-7890-abcd-ef1234567890" TYPE="ext4"

# 2. åˆ›å»ºæŒ‚è½½ç‚¹
sudo mkdir -p /data

# 3. æ·»åŠ  fstab æ¡ç›®
echo 'UUID=a1b2c3d4-e5f6-7890-abcd-ef1234567890  /data  ext4  defaults,nofail  0  2' | sudo tee -a /etc/fstab

# 4. æµ‹è¯•æŒ‚è½½
sudo mount -a

# 5. éªŒè¯
df -h /data
mount | grep /data

# 6. ç¡®è®¤æ— è¯¯åï¼Œé‡å¯éªŒè¯æŒä¹…æ€§
sudo reboot
```

---

## èŒåœºå°è´´å£«

### æ—¥æœ¬ IT è¿ç»´åœºæ™¯

**fstab å¤‰æ›´ã¯å¤‰æ›´ç®¡ç†ãŒå¿…è¦**

åœ¨æ—¥æœ¬ä¼ä¸šçš„è¿ç»´ç°åœºï¼Œä¿®æ”¹ fstab å±äº**å¤‰æ›´ç®¡ç†**ï¼ˆChange Managementï¼‰èŒƒç•´ï¼š

1. **å¤‰æ›´ç”³è«‹**ï¼ˆChange Requestï¼‰ï¼šæäº¤å˜æ›´ç”³è¯·
2. **æ‰¿èª**ï¼ˆApprovalï¼‰ï¼šè·å¾—ä¸»ç®¡å®¡æ‰¹
3. **ä½œæ¥­çª“å£**ï¼ˆMaintenance Windowï¼‰ï¼šåœ¨è®¡åˆ’çš„ç»´æŠ¤çª—å£æ‰§è¡Œ
4. **å¾©æ—§æ‰‹é †**ï¼ˆRecovery Procedureï¼‰ï¼šå‡†å¤‡å›æ»šæ–¹æ¡ˆ

**éšœå®³å¯¾å¿œã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ**ï¼š

| æœ¯è¯­ | è¯»éŸ³ | å«ä¹‰ |
|------|------|------|
| èµ·å‹•éšœå®³ | ãã©ã†ã—ã‚‡ã†ãŒã„ | å¯åŠ¨æ•…éšœ |
| ç·Šæ€¥å¯¾å¿œ | ãã‚“ãã‚…ã†ãŸã„ãŠã† | ç´§æ€¥åº”å¯¹ |
| å¾©æ—§æ‰‹é †æ›¸ | ãµã£ãã‚…ã†ã¦ã˜ã‚…ã‚“ã—ã‚‡ | æ¢å¤æ‰‹å†Œ |
| ã‚¨ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ãƒ¢ãƒ¼ãƒ‰ | - | Emergency Mode |

---

## é¢è¯•å‡†å¤‡

**Q: fstab ã®è¨­å®šãƒŸã‚¹ã§èµ·å‹•ã—ãªããªã£ãŸå ´åˆã€ã©ã†å¯¾å¿œã—ã¾ã™ã‹ï¼Ÿ**

A: Emergency Mode ã«å…¥ã£ãŸã‚‰ã€root ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚`mount -o remount,rw /` ã§ãƒ«ãƒ¼ãƒˆã‚’æ›¸ãè¾¼ã¿å¯èƒ½ã«ã—ã¦ã‹ã‚‰ã€`/etc/fstab` ã‚’ç·¨é›†ã—ã¦å•é¡Œã®ã‚ã‚‹è¡Œã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¾ã™ã€‚ä¿å­˜å¾Œã€`reboot` ã§å†èµ·å‹•ã—ã¾ã™ã€‚

**Q: nofail ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ç›®çš„ã¯ä½•ã§ã™ã‹ï¼Ÿ**

A: ãƒ‡ãƒã‚¤ã‚¹ãŒå­˜åœ¨ã—ãªã„å ´åˆã§ã‚‚ãƒ–ãƒ¼ãƒˆå‡¦ç†ã‚’ç¶šè¡Œã•ã›ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ã‚£ã‚¹ã‚¯ãªã©éã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚ŒãŒãªã„ã¨ã€ãƒ‡ã‚£ã‚¹ã‚¯éšœå®³æ™‚ã«ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ãŒèµ·å‹•ã§ããªããªã‚Šã¾ã™ã€‚

**Q: mount -a ã‚’å®Ÿè¡Œã™ã‚‹æ„å‘³ã¯ï¼Ÿ**

A: fstab ã®è¨­å®šã‚’å†èµ·å‹•ãªã—ã§ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚fstab ã‚’å¤‰æ›´ã—ãŸå¾Œã¯å¿…ãš `mount -a` ã‚’å®Ÿè¡Œã—ã¦ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèªã—ã¦ã‹ã‚‰å†èµ·å‹•ã™ã‚‹ã®ãŒãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã™ã€‚

---

## æœ¬èª²å°çµ

| æ¦‚å¿µ | ã‚³ãƒãƒ³ãƒ‰/è¨­å®š | è¨˜æ†¶ãƒã‚¤ãƒ³ãƒˆ |
|------|---------------|--------------|
| æ‰‹å‹•ãƒã‚¦ãƒ³ãƒˆ | `mount -t ext4 UUID=xxx /mnt` | UUID ã‚’ä½¿ç”¨ |
| ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆ | `umount /mnt` | busy ãªã‚‰ lsof ç¢ºèª |
| fstab æ§‹é€  | 6 ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | device, mount, type, options, dump, pass |
| nofail | `defaults,nofail` | éã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«åˆ†åŒºå¿…é ˆ |
| è¨­å®šãƒ†ã‚¹ãƒˆ | `mount -a` | å†èµ·å‹•å‰ã«å¿…ãšå®Ÿè¡Œï¼ |
| Emergency å¾©æ—§ | `mount -o remount,rw /` | root ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¿…è¦ |

**æ ¸å¿ƒç†å¿µ**ï¼šfstab é…ç½®é”™è¯¯æ˜¯æœåŠ¡å™¨å¯åŠ¨å¤±è´¥çš„å¸¸è§åŸå› ã€‚**Always run `mount -a` before rebooting!**

---

## æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬è¯¾åï¼Œç¡®è®¤ä½ èƒ½å¤Ÿï¼š

- [ ] ä½¿ç”¨ `mount` å’Œ `umount` è¿›è¡Œæ‰‹åŠ¨æŒ‚è½½æ“ä½œ
- [ ] è§£é‡Š fstab å…­ä¸ªå­—æ®µçš„å«ä¹‰
- [ ] è¯´æ˜ nofail é€‰é¡¹çš„ä½œç”¨å’Œä½¿ç”¨åœºæ™¯
- [ ] ä½¿ç”¨ `mount -a` æµ‹è¯• fstab é…ç½®
- [ ] ä» Emergency Mode æ¢å¤ fstab æ•…éšœ
- [ ] æ­£ç¡®æ·»åŠ æ–°åˆ†åŒºåˆ° fstabï¼ˆä½¿ç”¨ UUIDï¼‰

---

## å»¶ä¼¸é˜…è¯»

- [Arch Wiki: fstab](https://wiki.archlinux.org/title/fstab)
- [Red Hat - Mounting File Systems (RHEL 9)](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_file_systems/mounting-file-systems_managing-file-systems)
- [systemd.mount man page](https://www.freedesktop.org/software/systemd/man/systemd.mount.html)
- ä¸‹ä¸€è¯¾ï¼š[05 - LVM æ¶æ„](../05-lvm-architecture/) -- å­¦ä¹  LVM ä¸‰å±‚æ¶æ„
- å›é¡¾ï¼š[01 - å—è®¾å¤‡ä¸æŒä¹…å‘½å](../01-block-devices-naming/) -- UUID è¯¦è§£

---

## ç³»åˆ—å¯¼èˆª

<- [03 - æ–‡ä»¶ç³»ç»Ÿé€‰æ‹©ä¸åˆ›å»º](../03-filesystems/) | [è¯¾ç¨‹é¦–é¡µ](../) | [05 - LVM æ¶æ„ ->](../05-lvm-architecture/)
