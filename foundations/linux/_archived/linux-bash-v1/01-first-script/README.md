# 01 Â· ç¬¬ä¸€ä¸ªè„šæœ¬ï¼ˆYour First Scriptï¼‰

> **ç›®æ ‡**ï¼šç¼–å†™å¹¶è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Bash è„šæœ¬ï¼Œç”Ÿæˆç³»ç»Ÿæ¦‚è¦æŠ¥å‘Š  
> **å‰ç½®**ï¼š[00 Â· ç¯å¢ƒå‡†å¤‡](../00-setup/)  
> **æ—¶é—´**ï¼š20-30 åˆ†é’Ÿ  
> **å®æˆ˜é¡¹ç›®**ï¼šç³»ç»Ÿæ¦‚è¦æŠ¥å‘Šï¼ˆè¿ç»´å·¡æ£€åœºæ™¯ï¼‰

## å°†å­¦åˆ°çš„å†…å®¹

1. ä»€ä¹ˆæ˜¯ Shell è„šæœ¬
2. Shebang çš„ä½œç”¨
3. å˜é‡å®šä¹‰ä¸ä½¿ç”¨
4. å‘½ä»¤æ›¿æ¢ `$()`
5. é€€å‡ºç  `$?`
6. è¿è¡Œè„šæœ¬çš„ä¸‰ç§æ–¹å¼

---

## ä¸ºä»€ä¹ˆå­¦ Bashï¼Ÿ

```bash
# æ‰‹åŠ¨åˆ›å»º 100 ä¸ªæ–‡ä»¶å¤¹ï¼Ÿ
mkdir folder1 folder2 folder3 ... folder100  # ç´¯æ­»

# ç”¨è„šæœ¬ï¼Ÿä¸€è¡Œæå®š
for i in {1..100}; do mkdir "folder$i"; done
```

Bash è„šæœ¬è®©ä½ ï¼š
- **è‡ªåŠ¨åŒ–**é‡å¤ä»»åŠ¡
- **æ‰¹é‡å¤„ç†**æ–‡ä»¶å’Œæ•°æ®
- **ä¸²è”**å¤šä¸ªå‘½ä»¤

---

## Step 1 â€” Hello World

åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªè„šæœ¬ï¼š

```bash
cd ~/bash-course
nano hello.sh
```

è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š

```bash
#!/bin/bash
echo "Hello, World!"
```

ä¿å­˜ï¼š`Ctrl+O` â†’ `Enter` â†’ `Ctrl+X`

### ç†è§£ä»£ç 

| è¡Œ | å«ä¹‰ |
|----|------|
| `#!/bin/bash` | **Shebang**ï¼šå‘Šè¯‰ç³»ç»Ÿç”¨ Bash æ‰§è¡Œæ­¤è„šæœ¬ |
| `echo "..."` | è¾“å‡ºæ–‡æœ¬åˆ°ç»ˆç«¯ |

### Shebang è¯¦è§£

```bash
#!/bin/bash      # ä½¿ç”¨ /bin/bash
#!/usr/bin/env bash  # æ›´é€šç”¨ï¼Œè‡ªåŠ¨æŸ¥æ‰¾ bash è·¯å¾„
#!/bin/sh        # ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ shellï¼ˆå¯èƒ½ä¸æ˜¯ bashï¼‰
```

**æ¨è**ï¼šä½¿ç”¨ `#!/bin/bash` æˆ– `#!/usr/bin/env bash`

---

## Step 2 â€” è¿è¡Œè„šæœ¬

ä¸‰ç§æ–¹å¼è¿è¡Œè„šæœ¬ï¼š

### æ–¹å¼ 1ï¼šbash å‘½ä»¤ï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
bash hello.sh
```

è¾“å‡ºï¼š`Hello, World!`

### æ–¹å¼ 2ï¼šæ·»åŠ æ‰§è¡Œæƒé™

```bash
chmod +x hello.sh   # æ·»åŠ æ‰§è¡Œæƒé™
./hello.sh          # è¿è¡Œ
```

### æ–¹å¼ 3ï¼šsource å‘½ä»¤

```bash
source hello.sh
# æˆ–
. hello.sh
```

**åŒºåˆ«**ï¼š`source` åœ¨å½“å‰ shell æ‰§è¡Œï¼Œå˜é‡ä¼šä¿ç•™ï¼›å…¶ä»–æ–¹å¼åœ¨å­ shell æ‰§è¡Œã€‚

---

## Step 3 â€” å˜é‡

### å®šä¹‰å˜é‡

```bash
nano variables.sh
```

```bash
#!/bin/bash

# å®šä¹‰å˜é‡ï¼ˆç­‰å·ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ï¼ï¼‰
name="Atlas"
age=25

# ä½¿ç”¨å˜é‡ï¼ˆåŠ  $ ç¬¦å·ï¼‰
echo "Name: $name"
echo "Age: $age"

# æ¨èï¼šç”¨èŠ±æ‹¬å·æ˜ç¡®å˜é‡è¾¹ç•Œ
echo "Hello, ${name}!"
```

è¿è¡Œï¼š

```bash
bash variables.sh
```

è¾“å‡ºï¼š
```
Name: Atlas
Age: 25
Hello, Atlas!
```

### å¸¸è§é”™è¯¯

```bash
# âŒ é”™è¯¯ï¼šç­‰å·ä¸¤è¾¹æœ‰ç©ºæ ¼
name = "Atlas"    # æŠ¥é”™ï¼

# âœ… æ­£ç¡®ï¼šç´§è´´ç­‰å·
name="Atlas"
```

---

## Step 4 â€” å¼•å·çš„åŒºåˆ«

```bash
nano quotes.sh
```

```bash
#!/bin/bash

name="World"

# åŒå¼•å·ï¼šå˜é‡ä¼šå±•å¼€
echo "Hello, $name"    # è¾“å‡º: Hello, World

# å•å¼•å·ï¼šåŸæ ·è¾“å‡º
echo 'Hello, $name'    # è¾“å‡º: Hello, $name

# åå¼•å·/å‘½ä»¤æ›¿æ¢ï¼šæ‰§è¡Œå‘½ä»¤
echo "Today is $(date +%Y-%m-%d)"
```

è¿è¡Œï¼š

```bash
bash quotes.sh
```

### è®°å¿†å£è¯€

| å¼•å· | è¡Œä¸º | è®°å¿† |
|------|------|------|
| `"åŒå¼•å·"` | å±•å¼€å˜é‡ | "**åŒ**é‡å¤„ç†" |
| `'å•å¼•å·'` | åŸæ ·è¾“å‡º | "**å•**çº¯ä¸å˜" |
| `` `åå¼•å·` `` | æ‰§è¡Œå‘½ä»¤ï¼ˆæ—§å†™æ³•ï¼‰ | å·²è¢« `$()` æ›¿ä»£ |

---

## Step 5 â€” å‘½ä»¤æ›¿æ¢

ç”¨ `$()` æŠŠå‘½ä»¤çš„è¾“å‡ºå­˜å…¥å˜é‡ï¼š

```bash
nano cmd-sub.sh
```

```bash
#!/bin/bash

# è·å–å½“å‰æ—¥æœŸ
today=$(date +%Y-%m-%d)
echo "Today: $today"

# è·å–å½“å‰ç”¨æˆ·
user=$(whoami)
echo "User: $user"

# è·å–å½“å‰ç›®å½•
dir=$(pwd)
echo "Directory: $dir"

# ç»„åˆä½¿ç”¨
echo "[$today] $user is in $dir"
```

è¿è¡Œï¼š

```bash
bash cmd-sub.sh
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
Today: 2025-01-15
User: ssm-user
Directory: /home/ssm-user/bash-course
[2025-01-15] ssm-user is in /home/ssm-user/bash-course
```

---

## Step 6 â€” ç‰¹æ®Šå˜é‡

```bash
nano special-vars.sh
```

```bash
#!/bin/bash

echo "è„šæœ¬åç§°: $0"
echo "å‚æ•°ä¸ªæ•°: $#"
echo "æ‰€æœ‰å‚æ•°: $@"
echo "ç¬¬ä¸€ä¸ªå‚æ•°: $1"
echo "ç¬¬äºŒä¸ªå‚æ•°: $2"
echo "ä¸Šä¸ªå‘½ä»¤é€€å‡ºç : $?"
echo "å½“å‰è¿›ç¨‹ PID: $$"
```

è¿è¡Œï¼š

```bash
bash special-vars.sh arg1 arg2 arg3
```

è¾“å‡ºï¼š
```
è„šæœ¬åç§°: special-vars.sh
å‚æ•°ä¸ªæ•°: 3
æ‰€æœ‰å‚æ•°: arg1 arg2 arg3
ç¬¬ä¸€ä¸ªå‚æ•°: arg1
ç¬¬äºŒä¸ªå‚æ•°: arg2
ä¸Šä¸ªå‘½ä»¤é€€å‡ºç : 0
å½“å‰è¿›ç¨‹ PID: 12345
```

### ç‰¹æ®Šå˜é‡é€ŸæŸ¥

| å˜é‡ | å«ä¹‰ |
|------|------|
| `$0` | è„šæœ¬åç§° |
| `$1`, `$2`... | ä½ç½®å‚æ•° |
| `$#` | å‚æ•°ä¸ªæ•° |
| `$@` | æ‰€æœ‰å‚æ•°ï¼ˆä½œä¸ºç‹¬ç«‹å­—ç¬¦ä¸²ï¼‰ |
| `$*` | æ‰€æœ‰å‚æ•°ï¼ˆä½œä¸ºå•ä¸ªå­—ç¬¦ä¸²ï¼‰ |
| `$?` | ä¸Šä¸ªå‘½ä»¤çš„é€€å‡ºç  |
| `$$` | å½“å‰è„šæœ¬çš„ PID |
| `$!` | æœ€è¿‘åå°è¿›ç¨‹çš„ PID |

---

## Step 7 â€” é€€å‡ºç 

æ¯ä¸ªå‘½ä»¤æ‰§è¡Œåéƒ½æœ‰é€€å‡ºç ï¼š
- `0` = æˆåŠŸ
- éé›¶ = å¤±è´¥ï¼ˆé€šå¸¸ 1-255ï¼‰

```bash
# æˆåŠŸçš„å‘½ä»¤
ls /tmp
echo $?    # è¾“å‡º: 0

# å¤±è´¥çš„å‘½ä»¤
ls /nonexistent
echo $?    # è¾“å‡º: 2 (æ–‡ä»¶ä¸å­˜åœ¨)
```

### åœ¨è„šæœ¬ä¸­è®¾ç½®é€€å‡ºç 

```bash
nano exit-demo.sh
```

```bash
#!/bin/bash

# æ£€æŸ¥å‚æ•°
if [ $# -eq 0 ]; then
    echo "Error: No arguments provided"
    exit 1    # é€€å‡ºç  1 è¡¨ç¤ºé”™è¯¯
fi

echo "You provided: $@"
exit 0        # é€€å‡ºç  0 è¡¨ç¤ºæˆåŠŸ
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
bash exit-demo.sh
echo $?    # è¾“å‡º: 1

bash exit-demo.sh hello
echo $?    # è¾“å‡º: 0
```

---

## Mini-Projectï¼šç³»ç»Ÿæ¦‚è¦æŠ¥å‘Š

> **åœºæ™¯**ï¼šè¿ç»´å·¡æ£€æ—¶ï¼Œéœ€è¦å¿«é€Ÿç”ŸæˆæœåŠ¡å™¨æ¦‚è¦æŠ¥å‘Šä¿å­˜å¤‡æŸ¥ã€‚è¿™åœ¨æ—¥æœ¬ IT å…¬å¸çš„ã€Œé‹ç”¨å·¡æ£€ã€ä¸­å¾ˆå¸¸è§ã€‚

ç»¼åˆè¿ç”¨æ‰€å­¦å†…å®¹ï¼Œåˆ›å»ºä¸€ä¸ªå®ç”¨è„šæœ¬ï¼š

```bash
# åˆ›å»ºæŠ¥å‘Šç›®å½•
mkdir -p ~/reports

# åˆ›å»ºè„šæœ¬
nano ~/bash-course/sysinfo.sh
```

```bash
#!/bin/bash
# ç³»ç»Ÿæ¦‚è¦æŠ¥å‘Š - System Summary Report
# ç”¨é€”ï¼šè¿ç»´å·¡æ£€ã€åˆè§„æ£€æŸ¥

# è·å–ä¿¡æ¯
hostname=$(hostname)
user=$(whoami)
date_now=$(date "+%Y-%m-%d %H:%M:%S")
uptime_info=$(uptime -p)
os_info=$(cat /etc/os-release | grep PRETTY_NAME | cut -d'"' -f2)
timezone=$(timedatectl | grep "Time zone" | awk '{print $3}')
memory_info=$(free -h | grep Mem | awk '{print $3 "/" $2}')
disk_info=$(df -h / | tail -1 | awk '{print $3 "/" $2 " (" $5 ")"}')

# ç”ŸæˆæŠ¥å‘Šæ–‡ä»¶åï¼ˆå«æ—¥æœŸï¼‰
report_file=~/reports/sysinfo_$(date +%Y%m%d_%H%M%S).txt

# è¾“å‡ºåˆ°æ–‡ä»¶
{
    echo "================================"
    echo "      ç³»ç»Ÿæ¦‚è¦æŠ¥å‘Š"
    echo "      System Summary Report"
    echo "================================"
    echo "ç”Ÿæˆæ—¶é—´:  $date_now"
    echo "--------------------------------"
    echo "ä¸»æœºå:    $hostname"
    echo "æ“ä½œç³»ç»Ÿ:  $os_info"
    echo "è¿è¡Œæ—¶é—´:  $uptime_info"
    echo "æ—¶åŒº:      $timezone"
    echo "--------------------------------"
    echo "å†…å­˜ä½¿ç”¨:  $memory_info"
    echo "ç£ç›˜ä½¿ç”¨:  $disk_info"
    echo "--------------------------------"
    echo "æ‰§è¡Œç”¨æˆ·:  $user"
    echo "================================"
} > "$report_file"

# åŒæ—¶æ˜¾ç¤ºåˆ°ç»ˆç«¯
cat "$report_file"
echo ""
echo "ğŸ“„ æŠ¥å‘Šå·²ä¿å­˜: $report_file"

exit 0
```

è¿è¡Œï¼š

```bash
chmod +x ~/bash-course/sysinfo.sh
~/bash-course/sysinfo.sh
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
================================
      ç³»ç»Ÿæ¦‚è¦æŠ¥å‘Š
      System Summary Report
================================
ç”Ÿæˆæ—¶é—´:  2025-01-15 10:30:45
--------------------------------
ä¸»æœºå:    ip-10-0-1-123
æ“ä½œç³»ç»Ÿ:  Amazon Linux 2023
è¿è¡Œæ—¶é—´:  up 2 hours, 15 minutes
æ—¶åŒº:      Asia/Tokyo
--------------------------------
å†…å­˜ä½¿ç”¨:  312Mi/952Mi
ç£ç›˜ä½¿ç”¨:  2.1G/8.0G (27%)
--------------------------------
æ‰§è¡Œç”¨æˆ·:  ssm-user
================================

ğŸ“„ æŠ¥å‘Šå·²ä¿å­˜: /home/ssm-user/reports/sysinfo_20250115_103045.txt
```

æŸ¥çœ‹å†å²æŠ¥å‘Šï¼š

```bash
ls -la ~/reports/
```

---

## ç»ƒä¹ æŒ‘æˆ˜

1. ä¿®æ”¹è„šæœ¬ï¼Œæ·»åŠ  CPU æ ¸å¿ƒæ•°ä¿¡æ¯ï¼ˆæç¤ºï¼š`nproc`ï¼‰

2. ä¿®æ”¹è„šæœ¬ï¼Œæ¥æ”¶å‚æ•° `-v` æ˜¾ç¤ºè¯¦ç»†ç‰ˆæœ¬ä¿¡æ¯

---

## æœ¬è¯¾å°ç»“

| æ¦‚å¿µ | è¯­æ³• |
|------|------|
| Shebang | `#!/bin/bash` |
| å˜é‡å®šä¹‰ | `name="value"` ï¼ˆæ— ç©ºæ ¼ï¼‰ |
| å˜é‡ä½¿ç”¨ | `$name` æˆ– `${name}` |
| å‘½ä»¤æ›¿æ¢ | `$(command)` |
| é€€å‡ºç  | `$?` æŸ¥çœ‹ï¼Œ`exit N` è®¾ç½® |
| è¿è¡Œè„šæœ¬ | `bash script.sh` æˆ– `./script.sh` |

---

## ä¸‹ä¸€æ­¥

å­¦ä¼šäº†åŸºç¡€è¯­æ³•ï¼Œä¸‹ä¸€è¯¾æˆ‘ä»¬æ¥æ·±å…¥å˜é‡å’Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼

â†’ [02 Â· å˜é‡ä¸æ–‡ä»¶ç³»ç»Ÿ](../02-filesystem/)

## ç³»åˆ—å¯¼èˆª

â† [00 Â· ç¯å¢ƒå‡†å¤‡](../00-setup/) | [ç³»åˆ—é¦–é¡µ](../) | [02 Â· å˜é‡ä¸æ–‡ä»¶ç³»ç»Ÿ](../02-filesystem/) â†’
