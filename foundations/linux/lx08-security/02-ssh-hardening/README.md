# 02 - SSH ç°ä»£åŒ–åŠ å›ºï¼ˆModern SSH Hardeningï¼‰

> **ç›®æ ‡**ï¼šæŒæ¡ 2025-2026 å¹´ SSH å®‰å…¨åŠ å›ºæœ€ä½³å®è·µ  
> **å‰ç½®**ï¼šå®Œæˆ Lesson 01ï¼ˆå®‰å…¨åŸåˆ™ä¸å¨èƒå»ºæ¨¡ï¼‰  
> **æ—¶é—´**ï¼šâš¡ 40 åˆ†é’Ÿï¼ˆé€Ÿè¯»ï¼‰/ ğŸ”¬ 150 åˆ†é’Ÿï¼ˆå®Œæ•´å®æ“ï¼‰  
> **å®æˆ˜åœºæ™¯**ï¼šç”Ÿäº§æœåŠ¡å™¨ SSH åŠ å›º + è¯¯é…ç½®æ¢å¤æ¼”ç»ƒ  

---

## å°†å­¦åˆ°çš„å†…å®¹

1. é…ç½®ä»…å¯†é’¥è®¤è¯ï¼ˆKey-only authenticationï¼‰
2. é€‰æ‹©å®‰å…¨çš„å¯†é’¥ç®—æ³•ï¼ˆed25519 æ¨èï¼‰
3. å®æ–½åŸºç¡€ SSH åŠ å›ºè®¾ç½®
4. é…ç½® Fail2Ban é˜²æš´åŠ›ç ´è§£
5. **ç»ƒä¹ è¯¯é…ç½®æ¢å¤ï¼ˆå›æ»šæ¼”ç»ƒï¼‰**

---

## å…ˆè·‘èµ·æ¥ï¼ï¼ˆ5 åˆ†é’Ÿï¼‰

> åœ¨å­¦ä¹ ç†è®ºä¹‹å‰ï¼Œå…ˆçœ‹çœ‹ä½ çš„æœåŠ¡å™¨æœ‰å¤š"ä¸å®‰å…¨"ã€‚  

```bash
# æŸ¥çœ‹å½“å‰ SSH é…ç½®çš„å…³é”®å®‰å…¨è®¾ç½®
sudo sshd -T | grep -E 'permitrootlogin|passwordauthentication|pubkeyauthentication|permitemptypasswords'

# æŸ¥çœ‹æœåŠ¡å™¨æ”¯æŒçš„å¯†é’¥ç®—æ³•
sudo sshd -T | grep -E 'pubkeyacceptedalgorithms|hostkeyalgorithms' | head -2

# æŸ¥çœ‹æœ€è¿‘çš„ SSH ç™»å½•å¤±è´¥è®°å½•
sudo grep -i "failed" /var/log/secure 2>/dev/null | tail -5 || \
sudo grep -i "failed" /var/log/auth.log 2>/dev/null | tail -5 || \
sudo journalctl -u sshd --since "1 hour ago" | grep -i "failed" | tail -5

# æ£€æŸ¥æ˜¯å¦è¿˜åœ¨ç”¨å¤è€çš„ ssh-rsa å¯†é’¥
ls -la ~/.ssh/*.pub 2>/dev/null && \
for key in ~/.ssh/*.pub; do echo "=== $key ===" && head -1 "$key" | cut -d' ' -f1; done
```

**ä½ åˆšåˆšæ£€æŸ¥äº†ï¼š**

- æ˜¯å¦å…è®¸ root ç›´æ¥ç™»å½•ï¼Ÿï¼ˆåº”è¯¥ `no`ï¼‰
- æ˜¯å¦å…è®¸å¯†ç ç™»å½•ï¼Ÿï¼ˆåº”è¯¥ `no`ï¼‰
- æ˜¯å¦å¯ç”¨äº†å…¬é’¥è®¤è¯ï¼Ÿï¼ˆåº”è¯¥ `yes`ï¼‰
- å¯†é’¥ç®—æ³•æ˜¯å¦æ˜¯ç°ä»£çš„ï¼Ÿï¼ˆed25519 > RSA > ssh-rsaï¼‰
- æœ€è¿‘æœ‰æ²¡æœ‰äººå°è¯•æš´åŠ›ç ´è§£ï¼Ÿ

**å¦‚æœä½ çš„æœåŠ¡å™¨å…è®¸å¯†ç ç™»å½• + root ç™»å½•ï¼Œé‚£å®ƒæ­£åœ¨äº’è”ç½‘ä¸Šè£¸å¥”ã€‚**

ç°åœ¨è®©æˆ‘ä»¬ä¿®å¤å®ƒã€‚

---

## Step 1 - SSH å®‰å…¨ç°çŠ¶ 2025-2026ï¼ˆ10 åˆ†é’Ÿï¼‰

### 1.1 ssh-rsa å·²ç»æ­»äº†

OpenSSH 8.8+ï¼ˆ2021å¹´9æœˆï¼‰å¼€å§‹ï¼Œssh-rsa ç­¾åç®—æ³•**é»˜è®¤ç¦ç”¨**ã€‚

```bash
# æ£€æŸ¥ä½ çš„ OpenSSH ç‰ˆæœ¬
ssh -V

# OpenSSH_9.x æ˜¯ç°ä»£ç‰ˆæœ¬
# OpenSSH_7.x æˆ–æ›´æ—©éœ€è¦å‡çº§
```

**ä¸ºä»€ä¹ˆ ssh-rsa è¢«å¼ƒç”¨ï¼Ÿ**

| ç®—æ³• | å“ˆå¸Œ | çŠ¶æ€ | å®‰å…¨æ€§ |
|------|------|------|--------|
| ssh-rsa | SHA-1 | **å·²å¼ƒç”¨** | å¯è¢«ç¢°æ’æ”»å‡» |
| rsa-sha2-256 | SHA-256 | å¯ç”¨ | å®‰å…¨ |
| rsa-sha2-512 | SHA-512 | å¯ç”¨ | å®‰å…¨ |
| ssh-ed25519 | EdDSA | **æ¨è** | æœ€å®‰å…¨ã€æœ€å¿« |

### 1.2 ç°ä»£å¯†é’¥ç®—æ³•æ¨è

```
2025 å¹´æ¨èä¼˜å…ˆçº§ï¼š

1. ed25519        â† é¦–é€‰ï¼ˆå¿«é€Ÿã€å®‰å…¨ã€çŸ­å¯†é’¥ï¼‰
2. ecdsa-sha2-*   â† å¯æ¥å—ï¼ˆæ›²çº¿å®‰å…¨æ€§æœ‰äº‰è®®ï¼‰
3. rsa-sha2-512   â† å…¼å®¹æ€§éœ€è¦æ—¶ï¼ˆå¯†é’¥éœ€ 3072+ ä½ï¼‰
4. sk-ssh-ed25519 â† ç¡¬ä»¶å¯†é’¥ï¼ˆFIDO2/U2Fï¼‰
```

### 1.3 OpenSSH 9.x æ–°ç‰¹æ€§æ¦‚è§ˆ

| ç‰ˆæœ¬ | æ–°ç‰¹æ€§ | å®‰å…¨å½±å“ |
|------|--------|----------|
| 9.0 | é»˜è®¤ SFTP ä½¿ç”¨æ›´å®‰å…¨çš„ä¼ è¾“ | æ–‡ä»¶ä¼ è¾“æ›´å®‰å…¨ |
| 9.2 | FIDO2 resident keys | ç¡¬ä»¶å¯†é’¥æ— éœ€ç§é’¥æ–‡ä»¶ |
| 9.5 | æ›´ä¸¥æ ¼çš„ç®—æ³•é»˜è®¤ | è‡ªåŠ¨æ‹’ç»å¼±ç®—æ³• |
| 9.8 | å®éªŒæ€§åé‡å­å¯†é’¥äº¤æ¢ | æœªæ¥é‡å­è®¡ç®—é˜²æŠ¤ |

---

## Step 2 - ç”Ÿæˆç°ä»£ SSH å¯†é’¥ï¼ˆ15 åˆ†é’Ÿï¼‰

### 2.1 ç”Ÿæˆ ed25519 å¯†é’¥

```bash
# ç”Ÿæˆ ed25519 å¯†é’¥ï¼ˆæ¨èï¼‰
ssh-keygen -t ed25519 -C "your_email@example.com"

# è¾“å‡ºï¼š
# Generating public/private ed25519 key pair.
# Enter file in which to save the key (/home/user/.ssh/id_ed25519):
# Enter passphrase (empty for no passphrase):   â† å¼ºçƒˆå»ºè®®è®¾ç½®ï¼
# Enter same passphrase again:
```

**Passphrase å»ºè®®**ï¼š
- 12+ å­—ç¬¦
- åŒ…å«ç©ºæ ¼ï¼ˆå®¹æ˜“è®°å¿†çš„çŸ­å¥ï¼‰
- ç¤ºä¾‹ï¼š`my first server in tokyo 2025`

### 2.2 æŸ¥çœ‹å¯†é’¥ä¿¡æ¯

```bash
# æŸ¥çœ‹å…¬é’¥ï¼ˆè¿™ä¸ªè¦å¤åˆ¶åˆ°æœåŠ¡å™¨ï¼‰
cat ~/.ssh/id_ed25519.pub

# è¾“å‡ºç¤ºä¾‹ï¼š
# ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAI... your_email@example.com

# å¯¹æ¯” RSA å¯†é’¥é•¿åº¦ï¼ˆed25519 æ›´çŸ­ä½†æ›´å®‰å…¨ï¼‰
wc -c ~/.ssh/id_ed25519.pub ~/.ssh/id_rsa.pub 2>/dev/null
```

### 2.3 å¦‚æœå¿…é¡»ä½¿ç”¨ RSA

æœ‰äº›è€æ—§ç³»ç»Ÿåªæ”¯æŒ RSAã€‚å¦‚æœå¿…é¡»ä½¿ç”¨ï¼š

```bash
# ç”Ÿæˆ 4096 ä½ RSA å¯†é’¥ï¼ˆæœ€å° 3072ï¼Œæ¨è 4096ï¼‰
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"

# è­¦å‘Šï¼š2048 ä½ RSA åœ¨ 2025 å¹´å·²ä¸æ¨èï¼
```

### 2.4 é…ç½® authorized_keys

```bash
# åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Š
mkdir -p ~/.ssh
chmod 700 ~/.ssh

# æ·»åŠ å…¬é’¥
echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5... your_email@example.com" >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys

# éªŒè¯æƒé™ï¼ˆè¿™å¾ˆé‡è¦ï¼æƒé™é”™è¯¯ä¼šå¯¼è‡´å¯†é’¥è®¤è¯å¤±è´¥ï¼‰
ls -la ~/.ssh/
# drwx------ . ~/.ssh
# -rw------- . ~/.ssh/authorized_keys
```

### 2.5 ä½¿ç”¨ ssh-agent ç®¡ç†å¯†é’¥

```bash
# å¯åŠ¨ ssh-agent
eval "$(ssh-agent -s)"

# æ·»åŠ å¯†é’¥ï¼ˆä¼šè¦æ±‚è¾“å…¥ passphraseï¼‰
ssh-add ~/.ssh/id_ed25519

# æŸ¥çœ‹å·²åŠ è½½çš„å¯†é’¥
ssh-add -l

# åœ¨ ~/.bashrc æˆ– ~/.zshrc ä¸­è‡ªåŠ¨å¯åŠ¨
# if [ -z "$SSH_AUTH_SOCK" ]; then
#   eval "$(ssh-agent -s)"
# fi
```

---

## Step 3 - sshd_config å®‰å…¨åŠ å›ºï¼ˆ30 åˆ†é’Ÿï¼‰

### 3.1 æŸ¥çœ‹å½“å‰é…ç½®

```bash
# æŸ¥çœ‹ç”Ÿæ•ˆçš„é…ç½®ï¼ˆåŒ…æ‹¬é»˜è®¤å€¼ï¼‰
sudo sshd -T

# æŸ¥çœ‹ä¸»é…ç½®æ–‡ä»¶
sudo cat /etc/ssh/sshd_config

# æŸ¥çœ‹ drop-in é…ç½®ç›®å½•ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
ls /etc/ssh/sshd_config.d/ 2>/dev/null
```

### 3.2 å®‰å…¨åŠ å›ºé…ç½®

åˆ›å»ºä¸€ä¸ª drop-in é…ç½®æ–‡ä»¶ï¼ˆæ¨èæ–¹å¼ï¼Œä¾¿äºç®¡ç†å’Œå›æ»šï¼‰ï¼š

```bash
# å¤‡ä»½åŸå§‹é…ç½®
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak.$(date +%Y%m%d)

# åˆ›å»ºåŠ å›ºé…ç½®ï¼ˆä½¿ç”¨ drop-in ç›®å½•ï¼‰
sudo tee /etc/ssh/sshd_config.d/99-hardening.conf << 'EOF'
# =============================================================================
# SSH Hardening Configuration
# Created: $(date +%Y-%m-%d)
# Reference: CIS Benchmark, OpenSSH Best Practices 2025
# =============================================================================

# -----------------------------------------------------------------------------
# 1. Authentication Settings
# -----------------------------------------------------------------------------

# ç¦æ­¢ root ç›´æ¥ç™»å½•ï¼ˆä½¿ç”¨ sudo æ›¿ä»£ï¼‰
PermitRootLogin no

# ç¦æ­¢å¯†ç è®¤è¯ï¼ˆä»…å…è®¸å¯†é’¥ï¼‰
PasswordAuthentication no

# ç¦æ­¢ç©ºå¯†ç 
PermitEmptyPasswords no

# å¯ç”¨å…¬é’¥è®¤è¯
PubkeyAuthentication yes

# ç¦æ­¢åŸºäºä¸»æœºçš„è®¤è¯
HostbasedAuthentication no

# ç¦æ­¢ rhosts è®¤è¯
IgnoreRhosts yes

# -----------------------------------------------------------------------------
# 2. Connection Settings
# -----------------------------------------------------------------------------

# æœ€å¤§è®¤è¯å°è¯•æ¬¡æ•°
MaxAuthTries 3

# ç™»å½•è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
LoginGraceTime 60

# æœ€å¤§å¹¶å‘æœªè®¤è¯è¿æ¥
MaxStartups 10:30:60

# å®¢æˆ·ç«¯å­˜æ´»æ£€æµ‹
ClientAliveInterval 300
ClientAliveCountMax 2

# -----------------------------------------------------------------------------
# 3. Algorithm Settings (2025 Recommendations)
# -----------------------------------------------------------------------------

# åªå…è®¸å®‰å…¨çš„å¯†é’¥ç®—æ³•
PubkeyAcceptedAlgorithms ssh-ed25519,sk-ssh-ed25519@openssh.com,rsa-sha2-512,rsa-sha2-256

# ä¸»æœºå¯†é’¥ç®—æ³•
HostKeyAlgorithms ssh-ed25519,rsa-sha2-512,rsa-sha2-256

# å¯†é’¥äº¤æ¢ç®—æ³•
KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512

# åŠ å¯†ç®—æ³•
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com

# MAC ç®—æ³•
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com

# -----------------------------------------------------------------------------
# 4. Logging and Auditing
# -----------------------------------------------------------------------------

# è¯¦ç»†æ—¥å¿—è®°å½•
LogLevel VERBOSE

# Syslog facility
SyslogFacility AUTH

# -----------------------------------------------------------------------------
# 5. Misc Security Settings
# -----------------------------------------------------------------------------

# ç¦ç”¨ X11 è½¬å‘ï¼ˆé™¤ééœ€è¦ï¼‰
X11Forwarding no

# ç¦ç”¨ TCP è½¬å‘ï¼ˆæ ¹æ®éœ€æ±‚è°ƒæ•´ï¼‰
# AllowTcpForwarding no

# æ˜¾ç¤ºä¸Šæ¬¡ç™»å½•ä¿¡æ¯
PrintLastLog yes

# ç¦ç”¨ motd
PrintMotd no

# é™åˆ¶å¯ç™»å½•ç”¨æˆ·ï¼ˆå¯é€‰ï¼Œå–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹ï¼‰
# AllowUsers admin deploy
# AllowGroups sshusers wheel

EOF
```

### 3.3 é…ç½®éªŒè¯ï¼ˆå…³é”®æ­¥éª¤ï¼ï¼‰

> **è¿™æ˜¯æœ¬è¯¾æœ€é‡è¦çš„æŠ€èƒ½ï¼šåœ¨é‡å¯æœåŠ¡ä¹‹å‰éªŒè¯é…ç½®ã€‚**  

```bash
# éªŒè¯é…ç½®è¯­æ³•ï¼ˆ-t = test modeï¼‰
sudo sshd -t

# å¦‚æœæœ‰é”™è¯¯ä¼šæ˜¾ç¤ºï¼š
# /etc/ssh/sshd_config.d/99-hardening.conf: line 42: Bad configuration option: InvalidOption
# å¦‚æœæ²¡æœ‰è¾“å‡º = é…ç½®æ­£ç¡®

# éªŒè¯é…ç½®å†…å®¹ï¼ˆ-T = extended test modeï¼‰
sudo sshd -T | grep -E 'permitrootlogin|passwordauthentication'
# åº”è¯¥æ˜¾ç¤ºï¼š
# permitrootlogin no
# passwordauthentication no
```

### 3.4 å®‰å…¨é‡å¯ sshd

> **é»„é‡‘æ³•åˆ™**ï¼šä¿®æ”¹ SSH é…ç½®æ—¶ï¼Œ**æ°¸è¿œä¿æŒå½“å‰ä¼šè¯æ‰“å¼€**ï¼  

```bash
# åœ¨å½“å‰ç»ˆç«¯æ‰§è¡Œï¼Œä½†ä¸è¦å…³é—­è¿™ä¸ªç»ˆç«¯ï¼
sudo systemctl reload sshd

# æ‰“å¼€æ–°ç»ˆç«¯æµ‹è¯•è¿æ¥
# ssh user@server
# å¦‚æœæ–°è¿æ¥æˆåŠŸï¼Œæ‰å…³é—­æ—§ç»ˆç«¯

# å¦‚æœå‡ºé—®é¢˜ï¼Œåœ¨æ—§ç»ˆç«¯æ¢å¤ï¼š
# sudo mv /etc/ssh/sshd_config.d/99-hardening.conf /etc/ssh/sshd_config.d/99-hardening.conf.broken
# sudo systemctl reload sshd
```

---

## Step 4 - Fail2Ban é…ç½®ï¼ˆ20 åˆ†é’Ÿï¼‰

### 4.1 ä»€ä¹ˆæ˜¯ Fail2Banï¼Ÿ

Fail2Ban ç›‘æ§æ—¥å¿—æ–‡ä»¶ï¼Œæ£€æµ‹æš´åŠ›ç ´è§£å°è¯•ï¼Œè‡ªåŠ¨å°ç¦æ”»å‡» IPã€‚

```
æ”»å‡»æµç¨‹ï¼š

é»‘å®¢ â†’ SSH æš´åŠ›ç ´è§£ â†’ å¤±è´¥æ—¥å¿— â†’ Fail2Ban æ£€æµ‹ â†’ iptables/nftables å°ç¦
  |                                                        |
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¢«å°ç¦ 15 åˆ†é’Ÿ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å®‰è£… Fail2Ban

```bash
# RHEL/CentOS/Rocky
sudo dnf install epel-release -y
sudo dnf install fail2ban -y

# Debian/Ubuntu
sudo apt update
sudo apt install fail2ban -y

# å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable --now fail2ban
```

### 4.3 é…ç½® SSH ä¿æŠ¤

```bash
# åˆ›å»ºæœ¬åœ°é…ç½®ï¼ˆä¸è¦ç›´æ¥ä¿®æ”¹ jail.confï¼‰
sudo tee /etc/fail2ban/jail.local << 'EOF'
# =============================================================================
# Fail2Ban SSH Protection
# =============================================================================

[DEFAULT]
# å°ç¦æ—¶é—´ï¼ˆç§’ï¼‰- 15 åˆ†é’Ÿ
bantime = 900

# æ£€æµ‹æ—¶é—´çª—å£ï¼ˆç§’ï¼‰- 10 åˆ†é’Ÿå†…
findtime = 600

# æœ€å¤§å¤±è´¥æ¬¡æ•°
maxretry = 5

# å°ç¦åŠ¨ä½œï¼ˆæ ¹æ®ç³»ç»Ÿé€‰æ‹©ï¼‰
# banaction = iptables-multiport     # æ—§ç³»ç»Ÿ
banaction = nftables-multiport       # ç°ä»£ç³»ç»Ÿï¼ˆRHEL 9+, Debian 11+ï¼‰

# å¿½ç•¥çš„ IPï¼ˆä¸ä¼šè¢«å°ç¦ï¼‰
ignoreip = 127.0.0.1/8 ::1

[sshd]
enabled = true
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s

# æ›´ä¸¥æ ¼çš„è®¾ç½®ï¼ˆå¯é€‰ï¼‰
# maxretry = 3
# bantime = 3600
# findtime = 1800

EOF
```

### 4.4 éªŒè¯ Fail2Ban çŠ¶æ€

```bash
# é‡å¯ fail2ban
sudo systemctl restart fail2ban

# æŸ¥çœ‹çŠ¶æ€
sudo fail2ban-client status

# æŸ¥çœ‹ SSH jail è¯¦æƒ…
sudo fail2ban-client status sshd

# è¾“å‡ºç¤ºä¾‹ï¼š
# Status for the jail: sshd
# |- Filter
# |  |- Currently failed: 2
# |  |- Total failed:     15
# |  `- File list:        /var/log/secure
# `- Actions
#    |- Currently banned: 1
#    |- Total banned:     3
#    `- Banned IP list:   203.0.113.50
```

### 4.5 å¸¸ç”¨ Fail2Ban å‘½ä»¤

```bash
# æ‰‹åŠ¨å°ç¦ IP
sudo fail2ban-client set sshd banip 192.168.1.100

# æ‰‹åŠ¨è§£å° IP
sudo fail2ban-client set sshd unbanip 192.168.1.100

# æŸ¥çœ‹å°ç¦çš„ IP
sudo fail2ban-client get sshd banned

# æŸ¥çœ‹ fail2ban æ—¥å¿—
sudo tail -f /var/log/fail2ban.log
```

---

## Step 5 - è¯¯é…ç½®æ¢å¤æ¼”ç»ƒï¼ˆ30 åˆ†é’Ÿï¼‰

> **è¿™æ˜¯æœ¬è¯¾æœ€é‡è¦çš„å®æˆ˜æŠ€èƒ½ã€‚**  
> åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒSSH é…ç½®é”™è¯¯å¯èƒ½å¯¼è‡´ä½ è¢«æ°¸ä¹…é”åœ¨æœåŠ¡å™¨å¤–é¢ã€‚  

### 5.1 å¸¸è§çš„è‡´å‘½é”™è¯¯

| é”™è¯¯ | åæœ | æ¢å¤éš¾åº¦ |
|------|------|----------|
| `PasswordAuthentication no` + æ²¡æœ‰å¯†é’¥ | æ— æ³•ç™»å½• | éœ€è¦æ§åˆ¶å° |
| `AllowUsers` å†™é”™ç”¨æˆ·å | æ— æ³•ç™»å½• | éœ€è¦æ§åˆ¶å° |
| `sshd_config` è¯­æ³•é”™è¯¯ | sshd æ— æ³•å¯åŠ¨ | éœ€è¦æ§åˆ¶å° |
| `ListenAddress` ç»‘å®šé”™è¯¯åœ°å€ | æ— æ³•è¿æ¥ | éœ€è¦æ§åˆ¶å° |

### 5.2 å›æ»šæ¼”ç»ƒï¼šæ•…æ„åˆ¶é€ è¯¯é…ç½®

> **åªåœ¨æµ‹è¯•ç¯å¢ƒè¿›è¡Œï¼** ç¡®ä¿ä½ æœ‰æ§åˆ¶å°è®¿é—®æƒé™ã€‚  

ä½¿ç”¨æˆ‘ä»¬æä¾›çš„æ¼”ç»ƒè„šæœ¬ï¼š

```bash
# æŸ¥çœ‹è„šæœ¬å†…å®¹ï¼ˆå…ˆäº†è§£å®ƒåšä»€ä¹ˆï¼‰
cat code/rollback-drill/break-ssh.sh

# åœ¨æµ‹è¯•ç¯å¢ƒæ‰§è¡Œï¼ˆéœ€è¦ rootï¼‰
sudo bash code/rollback-drill/break-ssh.sh
```

è„šæœ¬ä¼šï¼š
1. å¤‡ä»½å½“å‰é…ç½®
2. åˆ›å»ºä¸€ä¸ªæ•…æ„é”™è¯¯çš„é…ç½®
3. é‡å¯ sshd

### 5.3 æ¢å¤æ­¥éª¤

å½“ä½ è¢«é”åœ¨å¤–é¢æ—¶ï¼š

**æ–¹æ³• 1ï¼šä½¿ç”¨å¦ä¸€ä¸ªå·²ç™»å½•çš„ç»ˆç«¯**

```bash
# å¦‚æœä½ è¿˜æœ‰ä¸€ä¸ª root ä¼šè¯æ‰“å¼€
sudo mv /etc/ssh/sshd_config /etc/ssh/sshd_config.broken
sudo mv /etc/ssh/sshd_config.bak.* /etc/ssh/sshd_config
sudo sshd -t && sudo systemctl restart sshd
```

**æ–¹æ³• 2ï¼šä½¿ç”¨æ§åˆ¶å°ï¼ˆVNC/IPMI/Cloud Consoleï¼‰**

```bash
# é€šè¿‡æ§åˆ¶å°ç™»å½•å
sudo mv /etc/ssh/sshd_config /etc/ssh/sshd_config.broken
sudo mv /etc/ssh/sshd_config.bak.* /etc/ssh/sshd_config
sudo sshd -t && sudo systemctl restart sshd
```

**æ–¹æ³• 3ï¼šä½¿ç”¨ Live CD/æ•‘æ´æ¨¡å¼**

```bash
# æŒ‚è½½ç³»ç»Ÿåˆ†åŒº
mount /dev/sda1 /mnt

# æ¢å¤é…ç½®
mv /mnt/etc/ssh/sshd_config /mnt/etc/ssh/sshd_config.broken
cp /mnt/etc/ssh/sshd_config.bak.* /mnt/etc/ssh/sshd_config

# é‡å¯
reboot
```

**æ–¹æ³• 4ï¼šAWS EC2 æ•‘æ´ï¼ˆInstance Connect / SSMï¼‰**

```bash
# å¦‚æœ SSH å¤±è´¥ï¼Œä½¿ç”¨ EC2 Instance Connectï¼ˆéœ€è¦äº‹å…ˆé…ç½®ï¼‰
aws ec2-instance-connect send-ssh-public-key \
  --instance-id i-xxxxxxxxx \
  --availability-zone ap-northeast-1a \
  --instance-os-user ec2-user \
  --ssh-public-key file://~/.ssh/id_ed25519.pub

# æˆ–ä½¿ç”¨ SSM Session Manager
aws ssm start-session --target i-xxxxxxxxx
```

### 5.4 é˜²æ­¢è¯¯é…ç½®çš„æœ€ä½³å®è·µ

```bash
# 1. æ°¸è¿œå…ˆéªŒè¯
sudo sshd -t

# 2. ä½¿ç”¨ reload è€Œä¸æ˜¯ restartï¼ˆæ›´å¹³æ»‘ï¼‰
sudo systemctl reload sshd

# 3. ä¿æŒæ—§ç»ˆç«¯æ‰“å¼€ç›´åˆ°æ–°è¿æ¥æˆåŠŸ

# 4. ä½¿ç”¨ drop-in é…ç½®æ–‡ä»¶ï¼ˆä¾¿äºå›æ»šï¼‰
# /etc/ssh/sshd_config.d/99-hardening.conf
# åˆ é™¤è¿™ä¸ªæ–‡ä»¶å°±èƒ½æ¢å¤é»˜è®¤

# 5. è®¾ç½®è‡ªåŠ¨æ¢å¤ cronï¼ˆå¯é€‰ï¼Œæ¿€è¿›åšæ³•ï¼‰
# æ¯ 5 åˆ†é’Ÿè‡ªåŠ¨æ¢å¤ SSH é…ç½®ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰
# */5 * * * * /usr/bin/cp /etc/ssh/sshd_config.backup /etc/ssh/sshd_config && /usr/bin/systemctl reload sshd
```

---

## é«˜çº§è¯é¢˜ï¼šSSH è¯ä¹¦è®¤è¯ï¼ˆå¯é€‰ï¼‰

> **é€‚ç”¨åœºæ™¯**ï¼šå¤§è§„æ¨¡éƒ¨ç½²ï¼ˆ100+ æœåŠ¡å™¨ï¼‰ï¼Œéœ€è¦é›†ä¸­ç®¡ç†è®¿é—®æƒé™ã€‚  

ä¼ ç»Ÿå¯†é’¥è®¤è¯çš„é—®é¢˜ï¼š

- æ¯ä¸ªæœåŠ¡å™¨éœ€è¦é…ç½®æ¯ä¸ªç”¨æˆ·çš„å…¬é’¥
- æ— æ³•è®¾ç½®å¯†é’¥è¿‡æœŸæ—¶é—´
- æ’¤é”€è®¿é—®éœ€è¦é€å°æœåŠ¡å™¨åˆ é™¤å…¬é’¥

SSH è¯ä¹¦è®¤è¯è§£å†³è¿™äº›é—®é¢˜ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SSH Certificate Architecture                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ç­¾å‘è¯ä¹¦     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     CA      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  ç”¨æˆ·è¯ä¹¦ï¼ˆæœ‰æ•ˆæœŸ 24hï¼‰ â”‚   â”‚
â”‚  â”‚ï¼ˆè¯ä¹¦é¢å‘æœºæ„ï¼‰â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                              â”‚                  â”‚
â”‚         â”‚                                     â”‚                  â”‚
â”‚         â”‚ ä¿¡ä»» CA å…¬é’¥                        â”‚ ä½¿ç”¨è¯ä¹¦ç™»å½•     â”‚
â”‚         â–¼                                     â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   æœåŠ¡å™¨     â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚        ç”¨æˆ·            â”‚ â”‚
â”‚  â”‚ TrustedUserCAâ”‚                   â”‚  (æ— éœ€ authorized_keys) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<details>
<summary>View ASCII source</summary>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SSH Certificate Architecture                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ç­¾å‘è¯ä¹¦     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     CA      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  ç”¨æˆ·è¯ä¹¦ï¼ˆæœ‰æ•ˆæœŸ 24hï¼‰ â”‚   â”‚
â”‚  â”‚ï¼ˆè¯ä¹¦é¢å‘æœºæ„ï¼‰â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                              â”‚                  â”‚
â”‚         â”‚                                     â”‚                  â”‚
â”‚         â”‚ ä¿¡ä»» CA å…¬é’¥                        â”‚ ä½¿ç”¨è¯ä¹¦ç™»å½•     â”‚
â”‚         â–¼                                     â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   æœåŠ¡å™¨     â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚        ç”¨æˆ·            â”‚ â”‚
â”‚  â”‚ TrustedUserCAâ”‚                   â”‚  (æ— éœ€ authorized_keys) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

</details>

**åŸºæœ¬é…ç½®æ­¥éª¤**ï¼ˆä»…ä¾›äº†è§£ï¼‰ï¼š

```bash
# 1. åˆ›å»º CA å¯†é’¥å¯¹
ssh-keygen -t ed25519 -f /etc/ssh/ca_key -C "SSH CA"

# 2. ä¸ºç”¨æˆ·ç­¾å‘è¯ä¹¦ï¼ˆæœ‰æ•ˆæœŸ 24 å°æ—¶ï¼‰
ssh-keygen -s /etc/ssh/ca_key -I user@example.com -n username -V +24h ~/.ssh/id_ed25519.pub

# 3. æœåŠ¡å™¨é…ç½®ä¿¡ä»» CA
echo "TrustedUserCAKeys /etc/ssh/ca_key.pub" >> /etc/ssh/sshd_config
```

> **æ¨èå·¥å…·**ï¼š[Netflix BLESS](https://github.com/Netflix/bless)ã€[Teleport](https://goteleport.com/)ã€[Vault SSH](https://www.vaultproject.io/docs/secrets/ssh)  

---

## åæ¨¡å¼ï¼šå¸¸è§é”™è¯¯

### é”™è¯¯ 1ï¼šä¿®æ”¹é…ç½®åä¸éªŒè¯å°±é‡å¯

```bash
# å±é™©ï¼å¯èƒ½é”æ­»è‡ªå·±
sudo vim /etc/ssh/sshd_config
sudo systemctl restart sshd    # â† æ²¡æœ‰éªŒè¯å°±é‡å¯

# æ­£ç¡®åšæ³•
sudo vim /etc/ssh/sshd_config
sudo sshd -t                   # â† å…ˆéªŒè¯
sudo systemctl reload sshd     # â† reload æ¯” restart æ›´å®‰å…¨
```

### é”™è¯¯ 2ï¼šç¦ç”¨å¯†ç ä½†æ²¡æœ‰é…ç½®å¯†é’¥

```bash
# è‡´å‘½é”™è¯¯ï¼
PasswordAuthentication no
# ä½† ~/.ssh/authorized_keys æ˜¯ç©ºçš„æˆ–ä¸å­˜åœ¨

# æ­£ç¡®åšæ³•ï¼šå…ˆç¡®ä¿å¯†é’¥å¯ç”¨ï¼Œå†ç¦ç”¨å¯†ç 
ssh -i ~/.ssh/id_ed25519 user@server
# æˆåŠŸåå†ä¿®æ”¹é…ç½®
```

### é”™è¯¯ 3ï¼šä½¿ç”¨å…±äº« SSH å¯†é’¥

```bash
# å±é™©ï¼æ•´ä¸ªå›¢é˜Ÿç”¨åŒä¸€ä¸ªç§é’¥
# - æ— æ³•è¿½è¸ªè°åšäº†ä»€ä¹ˆ
# - ä¸€äººç¦»èŒéœ€è¦æ›´æ¢æ‰€æœ‰æœåŠ¡å™¨å¯†é’¥
# - å¯†é’¥æ³„éœ²å½±å“æ‰€æœ‰äºº

# æ­£ç¡®åšæ³•ï¼šæ¯äººä¸€ä¸ªå¯†é’¥
ssh-keygen -t ed25519 -C "tanaka@company.com"
# åœ¨ authorized_keys ä¸­æ·»åŠ æ¯ä¸ªäººçš„å…¬é’¥ï¼Œå¸¦æ³¨é‡Š
```

### é”™è¯¯ 4ï¼šä½¿ç”¨è¿‡æ—¶çš„ç®—æ³•

```bash
# ä¸å®‰å…¨çš„é…ç½®
ssh-keygen -t rsa -b 1024     # â† å¤ªçŸ­ï¼Œå¯è¢«ç ´è§£
ssh-keygen -t dsa             # â† å·²å®Œå…¨å¼ƒç”¨

# 2025 å¹´å®‰å…¨é…ç½®
ssh-keygen -t ed25519         # â† é¦–é€‰
ssh-keygen -t rsa -b 4096     # â† éœ€è¦å…¼å®¹æ—¶
```

---

## èŒåœºå°è´´å£«ï¼ˆJapan IT Contextï¼‰

### SSH å®‰å…¨åœ¨æ—¥æœ¬ä¼ä¸š

| æ—¥è¯­æœ¯è¯­ | å«ä¹‰ | æŠ€æœ¯å®ç° |
|----------|------|----------|
| ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ | å¯†ç è®¤è¯ | `PasswordAuthentication yes/no` |
| å…¬é–‹éµèªè¨¼ | å…¬é’¥è®¤è¯ | `PubkeyAuthentication yes` |
| å€‹äººéµ | ä¸ªäººå¯†é’¥ | æ¯äººä¸€å¯¹å¯†é’¥ |
| å…±æœ‰éµ | å…±äº«å¯†é’¥ | **åæ¨¡å¼**ï¼Œåº”é¿å… |
| ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ | éæ³•è®¿é—® | Fail2Ban æ£€æµ‹ |

### æ—¥æœ¬ä¼ä¸šå¸¸è§çš„ SSH ç®¡ç†é—®é¢˜

1. **å…±æœ‰éµã®å•é¡Œ**ï¼šå¾ˆå¤šæ—¥æœ¬ä¼ä¸šä»åœ¨ä½¿ç”¨å…±äº«å¯†é’¥
   - è§£å†³ï¼šå¼•å…¥ä¸ªäººå¯†é’¥ + å ¡å’æœº

2. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ãŒã¾ã æœ‰åŠ¹**ï¼šå¯†ç è®¤è¯ä»ç„¶å¯ç”¨
   - è§£å†³ï¼šæ¸è¿›å¼è¿ç§»åˆ°å¯†é’¥è®¤è¯

3. **ãƒ­ã‚°ç®¡ç†ä¸è¶³**ï¼šSSH æ—¥å¿—ä¿ç•™ä¸è¶³
   - è§£å†³ï¼šé…ç½® rsyslog + ä¸­å¤®æ—¥å¿—æœåŠ¡å™¨

### å®‰å…¨æ£€æŸ¥æŠ¥å‘Šæ¨¡æ¿

```markdown
## SSH ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»çµæœ

### ç¢ºèªæ—¥: 20XXå¹´XXæœˆXXæ—¥
### å¯¾è±¡ã‚µãƒ¼ãƒãƒ¼: production-web-01

| é …ç›® | æ¨å¥¨è¨­å®š | ç¾åœ¨è¨­å®š | åˆ¤å®š |
|------|----------|----------|------|
| PermitRootLogin | no | no | OK |
| PasswordAuthentication | no | yes | NG |
| PubkeyAuthentication | yes | yes | OK |
| éµã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | ed25519 | rsa | è¦æ”¹å–„ |
| Fail2Ban | æœ‰åŠ¹ | ç„¡åŠ¹ | NG |

### æ”¹å–„ææ¡ˆ
1. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ã‚’ç„¡åŠ¹åŒ–
2. å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® ed25519 éµã¸ã®ç§»è¡Œ
3. Fail2Ban ã®å°å…¥
```

---

## æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬è¯¾åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- [ ] è§£é‡Šä¸ºä»€ä¹ˆ ssh-rsa è¢«å¼ƒç”¨
- [ ] ç”Ÿæˆ ed25519 å¯†é’¥å¯¹
- [ ] é…ç½® `authorized_keys` å¹¶è®¾ç½®æ­£ç¡®æƒé™
- [ ] ä½¿ç”¨ `sshd -t` éªŒè¯é…ç½®è¯­æ³•
- [ ] é…ç½®å…³é”®å®‰å…¨é€‰é¡¹ï¼š`PermitRootLogin no`ã€`PasswordAuthentication no`
- [ ] å®‰è£…å’Œé…ç½® Fail2Ban
- [ ] ä» SSH è¯¯é…ç½®ä¸­æ¢å¤
- [ ] è§£é‡Šå¯†ç é”å®š vs è´¦æˆ·é”å®šçš„åŒºåˆ«

---

## æœ¬è¯¾å°ç»“

| æ¦‚å¿µ | å‘½ä»¤/é…ç½® | è®°å¿†ç‚¹ |
|------|-----------|--------|
| å¯†é’¥ç”Ÿæˆ | `ssh-keygen -t ed25519` | 2025 é¦–é€‰ç®—æ³• |
| é…ç½®éªŒè¯ | `sshd -t` | **å¿…é¡»åœ¨é‡å¯å‰æ‰§è¡Œï¼** |
| ç¦æ­¢ root | `PermitRootLogin no` | ä½¿ç”¨ sudo æ›¿ä»£ |
| ç¦æ­¢å¯†ç  | `PasswordAuthentication no` | å¯†é’¥æ‰å®‰å…¨ |
| æš´åŠ›ç ´è§£é˜²æŠ¤ | Fail2Ban | è‡ªåŠ¨å°ç¦æ”»å‡» IP |
| é…ç½®å¤‡ä»½ | `cp sshd_config sshd_config.bak.$(date)` | å›æ»šä¿éšœ |
| å®‰å…¨é‡å¯ | `systemctl reload sshd` | ä¿æŒæ—§ä¼šè¯ |

**é»„é‡‘æ³•åˆ™**ï¼š

```
ä¿®æ”¹å‰å¤‡ä»½ â†’ éªŒè¯åé‡å¯ â†’ ä¿ç•™åé—¨ï¼ˆæ—§ä¼šè¯/æ§åˆ¶å°ï¼‰
```

---

## å»¶ä¼¸é˜…è¯»

- [OpenSSH Release Notes](https://www.openssh.com/releasenotes.html) - ç‰ˆæœ¬æ›´æ–°è¯´æ˜
- [Mozilla SSH Guidelines](https://infosec.mozilla.org/guidelines/openssh) - ä¼ä¸šçº§é…ç½®æŒ‡å—
- [CIS Benchmark for SSH](https://www.cisecurity.org/benchmark) - åˆè§„åŸºçº¿
- [Fail2Ban Documentation](https://www.fail2ban.org/wiki/index.php/Main_Page) - å®˜æ–¹æ–‡æ¡£
- ç›¸å…³è¯¾ç¨‹ï¼š[Lesson 07 - auditd å®¡è®¡](../07-auditd/) - å­¦ä¹  SSH é…ç½®å˜æ›´å®¡è®¡

---

## ç³»åˆ—å¯¼èˆª

[ä¸Šä¸€è¯¾ï¼š01 - å®‰å…¨åŸåˆ™ä¸å¨èƒå»ºæ¨¡](../01-security-principles/) | [ç³»åˆ—é¦–é¡µ](../) | [ä¸‹ä¸€è¯¾ï¼š03 - SELinux æ ¸å¿ƒæ¦‚å¿µ ->](../03-selinux-concepts/)
