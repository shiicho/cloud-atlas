# 威胁建模模板（Threat Model Template）

使用此模板为你的系统进行基础威胁建模。

---

## 项目信息

| 项目 | 内容 |
|------|------|
| 系统名称 | |
| 负责人 | |
| 日期 | |
| 版本 | v1.0 |

---

## Step 1: 资产识别（What to Protect?）

列出需要保护的关键资产：

### 数据资产

| 资产 | 位置 | 敏感度 | 说明 |
|------|------|--------|------|
| 用户数据 | /var/lib/app/data | 高 | 包含个人信息 |
| 配置文件 | /etc/app/ | 中 | 包含数据库密码 |
| 日志文件 | /var/log/app/ | 低 | 可能包含敏感信息 |
| | | | |

### 系统资产

| 资产 | 说明 |
|------|------|
| SSH 访问 | 管理员远程访问 |
| 数据库服务 | MySQL/PostgreSQL |
| Web 服务 | nginx/Apache |
| | |

### 服务账户

| 账户 | 用途 | 权限级别 |
|------|------|----------|
| root | 系统管理 | 最高 |
| app-user | 应用运行 | 最小 |
| | | |

---

## Step 2: 威胁识别（Who/What Threatens?）

### 外部威胁

| 威胁 | 攻击方式 | 可能性 | 影响 |
|------|----------|--------|------|
| SSH 暴力破解 | 字典攻击 | 高 | 高 |
| Web 漏洞利用 | SQL 注入、XSS | 中 | 高 |
| DDoS 攻击 | 流量洪泛 | 中 | 中 |
| | | | |

### 内部威胁

| 威胁 | 场景 | 可能性 | 影响 |
|------|------|--------|------|
| 配置错误 | 权限设置不当 | 高 | 中-高 |
| 内部人员 | 离职员工账户未删除 | 中 | 高 |
| 供应链 | 依赖包含漏洞 | 中 | 高 |
| | | | |

---

## Step 3: 风险评估矩阵

```
可能性
  高 │  中   │  高   │  高   │
     │ 风险  │ 风险  │ 风险  │
  中 │  低   │  中   │  高   │
     │ 风险  │ 风险  │ 风险  │
  低 │  低   │  低   │  中   │
     │ 风险  │ 风险  │ 风险  │
     └───────┴───────┴───────┘
        低      中      高
              影响程度
```

### 风险汇总

| 风险 | 等级 | 优先处理？ |
|------|------|-----------|
| SSH 暴力破解 | 高 | 是 |
| 配置错误 | 高 | 是 |
| Web 漏洞 | 中 | 是 |
| | | |

---

## Step 4: 控制措施（How to Protect?）

### 预防性控制

| 威胁 | 控制措施 | 状态 | 负责人 |
|------|----------|------|--------|
| SSH 暴力破解 | 密钥认证 + Fail2Ban | [ ] | |
| 配置错误 | 权限审计 + CIS 基线 | [ ] | |
| Web 漏洞 | SELinux + WAF | [ ] | |
| 内部威胁 | 审计日志 + 定期审查 | [ ] | |
| | | | |

### 检测性控制

| 控制措施 | 用途 | 状态 |
|----------|------|------|
| auditd | 监控关键文件变更 | [ ] |
| Fail2Ban | 检测暴力破解 | [ ] |
| 日志监控 | 检测异常行为 | [ ] |
| | | |

### 响应措施

| 场景 | 响应步骤 |
|------|----------|
| SSH 被入侵 | 1. 禁用账户 2. 审查日志 3. 重置密钥 |
| 数据泄露 | 1. 隔离系统 2. 保留证据 3. 上报 |
| | |

---

## Step 5: 行动计划

### 立即行动（24小时内）

- [ ] 配置 SSH 密钥认证
- [ ] 启用 SELinux Enforcing
- [ ] 运行权限审计脚本

### 短期行动（1周内）

- [ ] 配置 Fail2Ban
- [ ] 配置 auditd 规则
- [ ] 审查开放端口

### 长期行动（1月内）

- [ ] 实施 CIS Benchmark
- [ ] 建立定期审计流程
- [ ] 制定事故响应计划

---

## 审批记录

| 日期 | 审批人 | 意见 |
|------|--------|------|
| | | |

---

## 更新记录

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|----------|------|
| v1.0 | | 初始版本 | |
