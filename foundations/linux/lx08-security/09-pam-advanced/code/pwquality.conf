# =============================================================================
# Password Quality Configuration
# /etc/security/pwquality.conf
#
# Reference: CIS Benchmark 5.4.1, NIST SP 800-63B
# Created for: cloud-atlas linux-security lesson 09
# =============================================================================

# -----------------------------------------------------------------------------
# Length Requirements
# -----------------------------------------------------------------------------

# Minimum password length
# CIS Benchmark recommends 14, NIST recommends 8 (with other controls)
minlen = 14

# -----------------------------------------------------------------------------
# Character Class Requirements
# Negative values = required number of that class
# Positive values = credit (bonus) for having that class
# -----------------------------------------------------------------------------

# Require at least 1 digit (0-9)
dcredit = -1

# Require at least 1 uppercase letter (A-Z)
ucredit = -1

# Require at least 1 lowercase letter (a-z)
lcredit = -1

# Require at least 1 special character (!@#$%^&* etc)
ocredit = -1

# Minimum number of different character classes
# Classes: digits, uppercase, lowercase, special
minclass = 4

# -----------------------------------------------------------------------------
# Dictionary and Pattern Checks
# -----------------------------------------------------------------------------

# Check against cracklib dictionary
# Prevents common dictionary words
dictcheck = 1

# Check if password contains username
usercheck = 1

# Check against GECOS field (full name, etc)
gecoscheck = 1

# Maximum consecutive identical characters
# Prevents "aaaaaa" patterns
maxrepeat = 3

# Maximum consecutive characters from same class
# Prevents "ABCDEF" or "123456" patterns
maxclassrepeat = 4

# -----------------------------------------------------------------------------
# Change Requirements
# -----------------------------------------------------------------------------

# Minimum characters that must differ from old password
difok = 8

# Number of retry attempts for password entry
retry = 3

# -----------------------------------------------------------------------------
# Root Account
# -----------------------------------------------------------------------------

# Enforce rules for root user as well
# Comment out if root should bypass these checks
enforce_for_root

# -----------------------------------------------------------------------------
# Additional Security (Optional - uncomment as needed)
# -----------------------------------------------------------------------------

# Minimum credit for having at least one digit
# (use negative value to require, positive for credit)
# dcredit = 1

# Minimum credit for having at least one other character
# ocredit = 1

# Reject passwords that are palindromes
# Example: "aba" would be rejected
# dictpath = /usr/share/cracklib/pw_dict

# Specify path to custom bad password list
# badwords = /etc/security/pwquality.d/badwords.txt

# =============================================================================
# CIS Benchmark Mapping
# =============================================================================
# 5.4.1 Ensure password creation requirements are configured
#   - minlen = 14
#   - minclass = 4 (or dcredit=-1, ucredit=-1, lcredit=-1, ocredit=-1)
#
# NIST SP 800-63B Notes:
#   - NIST now recommends longer passwords over complexity
#   - Consider minlen = 15+ with fewer complexity requirements
#   - Focus on password length and dictionary checks
# =============================================================================
