# 02 Â· HULFT å®‰è£…ä¸åŸºæœ¬é…ç½®

> **ç›®æ ‡**ï¼šå®Œæˆ HULFT8 åŒèŠ‚ç‚¹ Lab ç¯å¢ƒæ­å»º
> **å‰ç½®**ï¼š[01 Â· ç½‘ç»œæ‹“æ‰‘ä¸å®‰å…¨åŸºç¡€](../01-network-security/)ï¼ˆç«¯å£/é˜²ç«å¢™/æœåŠ¡è´¦æˆ·ï¼‰
> **é€‚ç”¨**ï¼šæ—¥æœ¬ SIer/é“¶è¡Œ IT å²—ä½é¢è¯•å‡†å¤‡
> **æ—¶é•¿**ï¼šçº¦ 90 åˆ†é’Ÿ
> **è´¹ç”¨**ï¼š2x t3.small EC2ï¼ˆçº¦ $0.05/å°æ—¶ï¼‰ï¼›**å®Œæˆåè®°å¾—æ¸…ç†èµ„æº**

---

> **ç‰ˆæœ¬è¯´æ˜**ï¼š
> - æœ¬æ•™ç¨‹åŸºäº **HULFT8**
> - **HULFT10** å·²äº 2024å¹´12æœˆå‘å¸ƒï¼ˆé¦–æ¬¡å¤§ç‰ˆæœ¬å‡çº§ï¼Œå†æ—¶10å¹´ï¼‰
> - HULFT8 äº§å“é”€å”®ç»“æŸï¼š2025å¹´6æœˆ
> - HULFT8 æ ‡å‡†æ”¯æŒç»“æŸï¼š2030å¹´6æœˆ
> - æ–°é¡¹ç›®å»ºè®®è¯„ä¼° HULFT10

## å°†å®Œæˆçš„å†…å®¹

1. ç†è§£ HULFT Manager vs Engine çš„åŒºåˆ«
2. æŒæ¡æ ¸å¿ƒé…ç½®æ–‡ä»¶ä½ç½®å’Œä½œç”¨
3. æ­å»ºåŒèŠ‚ç‚¹ HULFT8 Lab ç¯å¢ƒ
4. å®Œæˆé¦–æ¬¡æ–‡ä»¶ä¼ è¾“æµ‹è¯•

---

## Step 1 â€” ç†è§£ HULFT ç»„ä»¶

### HULFT Engine vs HULFT Manager

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         HULFT ç»„ä»¶æ¶æ„                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      HULFT Manager (å¯é€‰)                            â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â€¢ Web GUI ç®¡ç†ç•Œé¢ (ç«¯å£ 25421)                                    â”‚   â”‚
â”‚   â”‚   â€¢ é›†ä¸­é…ç½®ç®¡ç†                                                     â”‚   â”‚
â”‚   â”‚   â€¢ å¯æ¨é€å®šä¹‰åˆ°å¤šä¸ªèŠ‚ç‚¹                                              â”‚   â”‚
â”‚   â”‚   â€¢ ç›‘æ§å’ŒæŠ¥è¡¨                                                       â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                              â”‚
â”‚                    æ¨é€é…ç½® / ç›‘æ§                                          â”‚
â”‚                              â†“                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚    HULFT Engine      â”‚          â”‚    HULFT Engine      â”‚               â”‚
â”‚   â”‚      (Node A)        â”‚ â†â”€â”€â”€â”€â”€â”€â†’ â”‚      (Node B)        â”‚               â”‚
â”‚   â”‚                      â”‚  ä¼ è¾“    â”‚                      â”‚               â”‚
â”‚   â”‚  â€¢ å®é™…ä¼ è¾“è¿›ç¨‹      â”‚          â”‚  â€¢ å®é™…ä¼ è¾“è¿›ç¨‹      â”‚               â”‚
â”‚   â”‚  â€¢ å¯ç‹¬ç«‹è¿è¡Œ        â”‚          â”‚  â€¢ å¯ç‹¬ç«‹è¿è¡Œ        â”‚               â”‚
â”‚   â”‚  â€¢ å¤„ç†æ–‡ä»¶æ”¶å‘      â”‚          â”‚  â€¢ å¤„ç†æ–‡ä»¶æ”¶å‘      â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»„ä»¶å¯¹æ¯”

| ç‰¹æ€§ | HULFT Engine | HULFT Manager |
|------|--------------|---------------|
| **å¿…è¦æ€§** | å¿…é¡» | å¯é€‰ |
| **åŠŸèƒ½** | å®é™…æ–‡ä»¶ä¼ è¾“ | Web GUI ç®¡ç† |
| **ç‹¬ç«‹è¿è¡Œ** | å¯ä»¥ | éœ€è¦ Engine |
| **é…ç½®æ–¹å¼** | å‘½ä»¤è¡Œ/é…ç½®æ–‡ä»¶ | Web ç•Œé¢ |
| **é€‚ç”¨åœºæ™¯** | æ‰€æœ‰ç¯å¢ƒ | ä¸­å¤§è§„æ¨¡éƒ¨ç½² |
| **ç«¯å£** | 8594, 8500 | 25421 |

### Lab ç¯å¢ƒé€‰æ‹©

**æœ¬è¯¾ç¨‹ï¼šåªå®‰è£… Engine**

```
âœ… æœ¬è¯¾ç¨‹æ–¹æ¡ˆï¼š2 èŠ‚ç‚¹ Engine-Only

   â€¢ å­¦ä¹ æ ¸å¿ƒæ¦‚å¿µè¶³å¤Ÿ
   â€¢ èµ„æºå ç”¨å°‘
   â€¢ å¿«é€Ÿä¸Šæ‰‹

âŒ ä¸ä½¿ç”¨ Manager çš„åŸå› ï¼š
   â€¢ å¢åŠ å¤æ‚åº¦
   â€¢ å°è§„æ¨¡éƒ¨ç½²ä¸éœ€è¦
   â€¢ å…è´¹è¯•ç”¨ç‰ˆåŠŸèƒ½å—é™
```

> ğŸ’¡ **é¢è¯•è¦ç‚¹ #1**
>
> **é—®é¢˜**ï¼šã€ŒHULFT Managerã¨HULFT Engineã®é•ã„ã¯ä½•ã§ã™ã‹ï¼Ÿã€
>
> ï¼ˆä¸­æ–‡å‚è€ƒï¼šHULFT Manager å’Œ HULFT Engine æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿï¼‰
>
> **æœŸæœ›å›ç­”**ï¼š
> - **Engine**ï¼šå®é™…ä¼ è¾“å®ˆæŠ¤è¿›ç¨‹ï¼Œå¯ç‹¬ç«‹è¿è¡Œ
> - **Manager**ï¼šWeb GUI é›†ä¸­é…ç½®/ç›‘æ§ï¼ˆå¯é€‰ï¼‰
> - Manager å¯ä»¥æ¨é€å®šä¹‰åˆ°å¤šä¸ªèŠ‚ç‚¹
> - å°è§„æ¨¡éƒ¨ç½²é€šå¸¸è·³è¿‡ Manager

---

## Step 2 â€” æ ¸å¿ƒæ–‡ä»¶ä½ç½®

### ç›®å½•ç»“æ„

```
/opt/hulft8/                    # å®‰è£…æ ¹ç›®å½•
â”œâ”€â”€ bin/                        # å¯æ‰§è¡Œæ–‡ä»¶
â”‚   â”œâ”€â”€ hulstart                # å¯åŠ¨ daemon
â”‚   â”œâ”€â”€ hulstop                 # åœæ­¢ daemon
â”‚   â”œâ”€â”€ hulstat                 # æŸ¥çœ‹çŠ¶æ€
â”‚   â””â”€â”€ hulcmd                  # å‘½ä»¤è¡Œå·¥å…·
â”‚
â”œâ”€â”€ hlmtable.tbl               # â­ èŠ‚ç‚¹å®šä¹‰è¡¨ï¼ˆå¯¹ç«¯ä¸»æœºï¼‰
â”œâ”€â”€ hlmdef.tbl                 # â­ ä¼ è¾“å®šä¹‰è¡¨
â”‚
â”œâ”€â”€ spool/                      # é˜Ÿåˆ—ç›®å½•ï¼ˆStore-and-Forwardï¼‰
â”‚   â””â”€â”€ <transfer_id>/          # æ¯ä¸ªä¼ è¾“çš„ä¸´æ—¶æ•°æ®
â”‚
â”œâ”€â”€ log/                        # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ hulft.log              # ä¸»æ—¥å¿—
â”‚   â””â”€â”€ hulevt.log             # äº‹ä»¶æ—¥å¿—
â”‚
â”œâ”€â”€ hulenv                      # ç¯å¢ƒå˜é‡é…ç½®
â””â”€â”€ hulfkey                     # è®¸å¯è¯æ–‡ä»¶
```

### å…³é”®é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” | é‡è¦æ€§ |
|------|------|--------|
| **hlmtable.tbl** | èŠ‚ç‚¹å®šä¹‰ï¼ˆå¯¹ç«¯ IP/ç«¯å£ï¼‰ | â­â­â­ |
| **hlmdef.tbl** | ä¼ è¾“å®šä¹‰ï¼ˆé€ä¿¡/å—ä¿¡è®¾ç½®ï¼‰ | â­â­â­ |
| **hulenv** | ç¯å¢ƒå˜é‡ï¼ˆè·¯å¾„ã€è¯­è¨€ç­‰ï¼‰ | â­â­ |
| **hulfkey** | è®¸å¯è¯å¯†é’¥ | â­â­ |

### æ—¥å¿—ä½ç½®

```bash
# ä¸»æ—¥å¿— - ä¼ è¾“è®°å½•ã€é”™è¯¯ä¿¡æ¯
/opt/hulft8/log/hulft.log

# äº‹ä»¶æ—¥å¿— - ç³»ç»Ÿäº‹ä»¶
/opt/hulft8/log/hulevt.log

# å¸¸ç”¨æŸ¥çœ‹å‘½ä»¤
tail -f /opt/hulft8/log/hulft.log
grep "RC=" /opt/hulft8/log/hulft.log | tail -20
```

> ğŸ’¡ **é¢è¯•è¦ç‚¹ #2**
>
> **é—®é¢˜**ï¼šã€ŒLinuxã§HULFTã®å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã©ã“ã«ã‚ã‚Šã¾ã™ã‹ï¼Ÿã¾ãŸã€ãƒ­ã‚°ã¯ã©ã“ã«ä¿å­˜ã•ã‚Œã¾ã™ã‹ï¼Ÿã€
>
> ï¼ˆä¸­æ–‡å‚è€ƒï¼šåœ¨ Linux ä¸Šï¼ŒHULFT çš„å®šä¹‰æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿæ—¥å¿—ä¿å­˜åœ¨å“ªé‡Œï¼Ÿï¼‰
>
> **æœŸæœ›å›ç­”**ï¼š
> - å®šä¹‰æ–‡ä»¶ï¼š`/opt/hulft8/hlmtable.tbl`ï¼ˆèŠ‚ç‚¹ï¼‰ã€`hlmdef.tbl`ï¼ˆä¼ è¾“ï¼‰
> - æ—¥å¿—ï¼š`/opt/hulft8/log/hulft.log`ã€`hulevt.log`
> - Spoolï¼ˆé˜Ÿåˆ—ï¼‰ï¼š`/opt/hulft8/spool`

---

## Step 3 â€” Lab ç¯å¢ƒå‡†å¤‡

### æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Lab ç¯å¢ƒæ¶æ„                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                           VPC (10.0.0.0/16)                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      Public Subnet (10.0.1.0/24)                     â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚   â”‚   â”‚   hulft-node-a  â”‚              â”‚   hulft-node-b  â”‚             â”‚   â”‚
â”‚   â”‚   â”‚   10.0.1.10     â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚   10.0.1.20     â”‚             â”‚   â”‚
â”‚   â”‚   â”‚                 â”‚   8594/8500  â”‚                 â”‚             â”‚   â”‚
â”‚   â”‚   â”‚   t3.small      â”‚              â”‚   t3.small      â”‚             â”‚   â”‚
â”‚   â”‚   â”‚   Amazon Linux  â”‚              â”‚   Amazon Linux  â”‚             â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚   â”‚            â†‘                                â†‘                       â”‚   â”‚
â”‚   â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SSM ç®¡ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚                                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚   Security Group: TCP 8594, 8500 between nodes                              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–¹æ¡ˆé€‰æ‹©

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨è |
|------|------|------|------|
| **EC2 + HULFT è¯•ç”¨ç‰ˆ** | çœŸå®ç¯å¢ƒ | éœ€ç”³è¯·è¯•ç”¨ | â­ æœ€ä½³ |
| **Docker æ¨¡æ‹Ÿ** | å¿«é€Ÿã€å…è´¹ | åŠŸèƒ½å—é™ | æ¦‚å¿µå­¦ä¹  |
| **æœ¬åœ° VM** | ç¦»çº¿å¯ç”¨ | é…ç½®å¤æ‚ | å¤‡é€‰ |

### éƒ¨ç½² Lab ç¯å¢ƒï¼ˆCloudFormationï¼‰

ä½¿ç”¨æä¾›çš„æ¨¡æ¿å¿«é€Ÿéƒ¨ç½²åŒèŠ‚ç‚¹ç¯å¢ƒï¼š

```bash
# 1. éƒ¨ç½² CloudFormation å †æ ˆ
aws cloudformation create-stack \
  --stack-name hulft-lab \
  --template-body file://templates/hulft-lab-2node.yaml \
  --capabilities CAPABILITY_NAMED_IAM

# 2. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆçº¦ 3-5 åˆ†é’Ÿï¼‰
aws cloudformation wait stack-create-complete --stack-name hulft-lab

# 3. è·å–å®ä¾‹ ID
aws cloudformation describe-stacks --stack-name hulft-lab \
  --query 'Stacks[0].Outputs' --output table

# 4. è¿æ¥åˆ°èŠ‚ç‚¹ï¼ˆé€šè¿‡ SSMï¼Œæ— éœ€ SSH Keyï¼‰
aws ssm start-session --target <NodeAInstanceId>
aws ssm start-session --target <NodeBInstanceId>
```

> **æ¨¡æ¿ä½ç½®**ï¼š[templates/hulft-lab-2node.yaml](templates/hulft-lab-2node.yaml)
> æ¨¡æ¿ä¼šè‡ªåŠ¨åˆ›å»ºï¼šVPCã€å­ç½‘ã€å®‰å…¨ç»„ã€IAM Roleã€2 ä¸ª EC2 å®ä¾‹

### è·å– HULFT è¯•ç”¨ç‰ˆ

> **é‡è¦**ï¼šè¯•ç”¨è®¸å¯è¯éœ€è¦ **æå‰ç”³è¯·**ï¼Œé¢„è®¡å®¡æ‰¹æ—¶é—´ 1-3 ä¸ªå·¥ä½œæ—¥

**ç”³è¯·æµç¨‹ï¼š**

1. è®¿é—® myHULFT é—¨æˆ·ï¼šhttps://my.hulft.com/
2. æ³¨å†Œè´¦æˆ·å¹¶ç™»å½•
3. é€‰æ‹©ã€ŒEvaluationã€â†’ã€ŒHULFT8 Linuxã€
4. å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š
   - å…¬å¸åï¼ˆå­¦ä¹ ç”¨å¯å¡« "Personal Learning"ï¼‰
   - ä¸»æœºåï¼ˆEC2 çš„ hostnameï¼‰
   - MAC åœ°å€ï¼ˆæ‰§è¡Œ `ip link show eth0` è·å–ï¼‰
5. æäº¤åç­‰å¾…é‚®ä»¶è·å–è®¸å¯è¯æ–‡ä»¶

**è¯•ç”¨ç‰ˆé™åˆ¶ï¼š**

| é¡¹ç›® | é™åˆ¶ |
|------|------|
| **æœ‰æ•ˆæœŸ** | 60 å¤©ï¼ˆé 30 å¤©ï¼‰ |
| **ç»‘å®š** | ä¸»æœºå + MAC åœ°å€ |
| **ååé‡** | å—é™ï¼ˆå­¦ä¹ è¶³å¤Ÿï¼‰ |
| **æ”¯æŒ** | æ— ç”Ÿäº§æ”¯æŒ |

> **å¤‡é€‰æ–¹æ¡ˆ**ï¼šå¦‚æœæ— æ³•è·å¾—è¯•ç”¨ç‰ˆï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£å­¦ä¹ æ¦‚å¿µï¼Œ
> è·³è¿‡å®é™…å®‰è£…æ­¥éª¤ï¼Œç»§ç»­åç»­è¯¾ç¨‹çš„ç†è®ºéƒ¨åˆ†ã€‚

---

## Step 4 â€” å®‰è£…å‰æ£€æŸ¥æ¸…å•

### Pre-Install Checklist

åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š

```bash
# 1. æ£€æŸ¥æ“ä½œç³»ç»Ÿ
cat /etc/os-release

# 2. æ£€æŸ¥å¯ç”¨ç£ç›˜ç©ºé—´ï¼ˆè‡³å°‘ 2GBï¼‰
df -h /opt

# 3. æ£€æŸ¥å†…å­˜ï¼ˆè‡³å°‘ 1GB å¯ç”¨ï¼‰
free -h

# 4. æ£€æŸ¥ ulimitï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰
ulimit -n
# æ¨èå€¼ï¼š65535

# 5. æ£€æŸ¥ locale
locale
# æ¨èï¼šen_US.UTF-8 æˆ– ja_JP.UTF-8

# 6. æ£€æŸ¥ NTP åŒæ­¥
timedatectl status
```

### è®¾ç½® ulimit

```bash
# ç¼–è¾‘ /etc/security/limits.conf
sudo tee -a /etc/security/limits.conf << 'EOF'
# HULFT file descriptor limits
hulftsvc soft nofile 65535
hulftsvc hard nofile 65535
EOF

# éªŒè¯ï¼ˆéœ€é‡æ–°ç™»å½•ï¼‰
su - hulftsvc -s /bin/bash -c "ulimit -n"
```

### è®¾ç½® Locale

```bash
# æ£€æŸ¥å¯ç”¨ locale
locale -a | grep -E "en_US|ja_JP"

# è®¾ç½®ç³»ç»Ÿ localeï¼ˆå¦‚éœ€è¦ï¼‰
sudo localectl set-locale LANG=en_US.UTF-8

# éªŒè¯
locale
```

### åˆ›å»ºæœåŠ¡è´¦æˆ·ï¼ˆå‚è€ƒ Lesson 01ï¼‰

```bash
# åˆ›å»ºç»„å’Œç”¨æˆ·ï¼ˆhome ç›®å½•ä¸å®‰è£…ç›®å½•ä¸€è‡´ï¼‰
sudo groupadd -f hulft
sudo useradd -r -s /sbin/nologin -d /opt/hulft8 -g hulft -c "HULFT Service" hulftsvc

# åˆ›å»ºå®‰è£…ç›®å½•
sudo mkdir -p /opt/hulft8
sudo chown hulftsvc:hulft /opt/hulft8
```

---

## Step 5 â€” å®‰è£… HULFT Engine

### å®‰è£…æ­¥éª¤ï¼ˆä¸¤ä¸ªèŠ‚ç‚¹éƒ½æ‰§è¡Œï¼‰

**ä¸Šä¼ å®‰è£…åŒ…åˆ° EC2 çš„æ–¹æ³•ï¼š**

```bash
# æ–¹æ³• 1ï¼šé€šè¿‡ S3ï¼ˆæ¨èï¼ŒSSM ç¯å¢ƒï¼‰
# å…ˆä¸Šä¼ åˆ° S3 æ¡¶
aws s3 cp hulft8_linux_x64.tar.gz s3://your-bucket/
# åœ¨ EC2 ä¸Šä¸‹è½½
aws s3 cp s3://your-bucket/hulft8_linux_x64.tar.gz /tmp/

# æ–¹æ³• 2ï¼šSCPï¼ˆéœ€è¦ SSH Keyï¼‰
scp hulft8_linux_x64.tar.gz ec2-user@<instance-ip>:/tmp/

# æ–¹æ³• 3ï¼šSSM Port Forwarding + SCP
aws ssm start-session --target <instance-id> --document-name AWS-StartPortForwardingSession --parameters portNumber=22,localPortNumber=2222
scp -P 2222 hulft8_linux_x64.tar.gz ec2-user@localhost:/tmp/
```

**å®‰è£…ï¼š**

```bash
# 1. è§£å‹å®‰è£…åŒ…
cd /tmp
tar xzf hulft8_linux_x64.tar.gz

# 2. ä»¥ root è¿è¡Œå®‰è£…ç¨‹åº
sudo ./install.sh

# 3. æŒ‰æç¤ºæ“ä½œï¼š
#    - å®‰è£…ç›®å½•ï¼š/opt/hulft8
#    - æœåŠ¡è´¦æˆ·ï¼šhulftsvc
#    - Control ç«¯å£ï¼š8594
#    - Data ç«¯å£ï¼š8500

# 4. åº”ç”¨è®¸å¯è¯
sudo cp /tmp/hulfkey /opt/hulft8/
sudo chown hulftsvc:hulft /opt/hulft8/hulfkey
```

### é…ç½®ç¯å¢ƒå˜é‡

```bash
# ç¼–è¾‘ /opt/hulft8/hulenv
sudo tee /opt/hulft8/hulenv << 'EOF'
# HULFT Environment Configuration
export HULFT_HOME=/opt/hulft8
export PATH=$HULFT_HOME/bin:$PATH
export LANG=en_US.UTF-8
EOF

# è®¾ç½®æƒé™
sudo chown hulftsvc:hulft /opt/hulft8/hulenv
```

### å¯åŠ¨ HULFT Daemon

```bash
# å¯åŠ¨
sudo -u hulftsvc /opt/hulft8/bin/hulstart

# æ£€æŸ¥çŠ¶æ€
/opt/hulft8/bin/hulstat

# æœŸæœ›è¾“å‡ºï¼š
# HULFT Status: LISTEN
# Control Port: 8594
# Data Port: 8500
```

---

## Step 6 â€” é…ç½®èŠ‚ç‚¹å®šä¹‰

### åœ¨ Node A ä¸Šé…ç½®

```bash
# ç¼–è¾‘èŠ‚ç‚¹å®šä¹‰è¡¨
sudo -u hulftsvc tee /opt/hulft8/hlmtable.tbl << 'EOF'
# HULFT Node Definition Table
# Format: NODE_ID  IP_ADDRESS  CONTROL_PORT

# æœ¬æœº
NODE_A    10.0.1.10    8594

# å¯¹ç«¯
NODE_B    10.0.1.20    8594
EOF
```

### åœ¨ Node B ä¸Šé…ç½®

```bash
# ç¼–è¾‘èŠ‚ç‚¹å®šä¹‰è¡¨
sudo -u hulftsvc tee /opt/hulft8/hlmtable.tbl << 'EOF'
# HULFT Node Definition Table
# Format: NODE_ID  IP_ADDRESS  CONTROL_PORT

# æœ¬æœº
NODE_B    10.0.1.20    8594

# å¯¹ç«¯
NODE_A    10.0.1.10    8594
EOF
```

### éªŒè¯é…ç½®

```bash
# é‡å¯ HULFT åŠ è½½æ–°é…ç½®
sudo -u hulftsvc /opt/hulft8/bin/hulstop
sudo -u hulftsvc /opt/hulft8/bin/hulstart

# éªŒè¯èŠ‚ç‚¹å®šä¹‰å·²åŠ è½½
/opt/hulft8/bin/hulstat -node
```

---

## Step 7 â€” é¦–æ¬¡ä¼ è¾“æµ‹è¯•

### åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼ˆNode Aï¼‰

```bash
# åˆ›å»ºæµ‹è¯•æ–‡ä»¶
echo "Hello from Node A - $(date)" > /tmp/test_file.txt

# ç¡®è®¤å†…å®¹
cat /tmp/test_file.txt
```

### å‘é€æ–‡ä»¶ï¼ˆNode A â†’ Node Bï¼‰

```bash
# ä½¿ç”¨ sendfile è¿›è¡Œ ad-hoc ä¼ è¾“ï¼ˆæµ‹è¯•ç”¨ï¼‰
/opt/hulft8/bin/hulcmd -sendfile \
  -node NODE_B \
  -file /tmp/test_file.txt \
  -dest /tmp/received_file.txt

# æ£€æŸ¥è¿”å›ç 
echo "Return Code: $?"
```

### éªŒè¯æ¥æ”¶ï¼ˆNode Bï¼‰

```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åˆ°è¾¾
ls -la /tmp/received_file.txt

# æŸ¥çœ‹å†…å®¹
cat /tmp/received_file.txt

# æœŸæœ›è¾“å‡ºï¼š
# Hello from Node A - <timestamp>
```

### æ£€æŸ¥æ—¥å¿—

```bash
# Node Aï¼ˆå‘é€æ–¹ï¼‰
grep "NODE_B" /opt/hulft8/log/hulft.log | tail -5

# Node Bï¼ˆæ¥æ”¶æ–¹ï¼‰
grep "NODE_A" /opt/hulft8/log/hulft.log | tail -5

# æŸ¥æ‰¾ RC=0ï¼ˆæˆåŠŸï¼‰
grep "RC=0" /opt/hulft8/log/hulft.log | tail -5
```

---

## Step 8 â€” å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šè¿æ¥å¤±è´¥

```bash
# ç—‡çŠ¶
hulcmd: Connection refused

# æ’æŸ¥æ­¥éª¤
# 1. æ£€æŸ¥å¯¹ç«¯ HULFT æ˜¯å¦è¿è¡Œ
ssh node-b "/opt/hulft8/bin/hulstat"

# 2. æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
nc -zv 10.0.1.20 8594

# 3. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
sudo iptables -L -n | grep 8594
```

### é—®é¢˜ 2ï¼šæƒé™é”™è¯¯

```bash
# ç—‡çŠ¶
Permission denied: /opt/hulft8/spool

# è§£å†³
sudo chown -R hulftsvc:hulft /opt/hulft8/spool
sudo chmod 755 /opt/hulft8/spool
```

### é—®é¢˜ 3ï¼šè®¸å¯è¯é”™è¯¯

```bash
# ç—‡çŠ¶
License expired or invalid

# æ£€æŸ¥
cat /opt/hulft8/hulfkey
# ç¡®è®¤è®¸å¯è¯æœªè¿‡æœŸã€ä¸»æœºååŒ¹é…
```

### é—®é¢˜ 4ï¼šæ–‡ä»¶æè¿°ç¬¦ä¸è¶³

```bash
# ç—‡çŠ¶
Too many open files

# æ£€æŸ¥å½“å‰é™åˆ¶
cat /proc/$(pgrep hulft)/limits | grep "open files"

# è§£å†³ï¼šå¢åŠ  ulimitï¼ˆè§ Step 4ï¼‰
```

---

## å®è·µç»ƒä¹ 

### ç»ƒä¹ ï¼šåŒå‘ä¼ è¾“æµ‹è¯•

**ç›®æ ‡**ï¼šéªŒè¯åŒå‘é€šä¿¡æ­£å¸¸

```
1. ä» Node A å‘é€æ–‡ä»¶åˆ° Node B âœ“ï¼ˆå·²å®Œæˆï¼‰
2. ä» Node B å‘é€æ–‡ä»¶åˆ° Node A
3. æ£€æŸ¥ä¸¤è¾¹æ—¥å¿—éƒ½æ˜¾ç¤º RC=0
```

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å‚è€ƒå‘½ä»¤</summary>

```bash
# åœ¨ Node B ä¸Šæ‰§è¡Œ
echo "Hello from Node B - $(date)" > /tmp/test_from_b.txt

/opt/hulft8/bin/hulcmd -sendfile \
  -node NODE_A \
  -file /tmp/test_from_b.txt \
  -dest /tmp/received_from_b.txt

# åœ¨ Node A ä¸ŠéªŒè¯
cat /tmp/received_from_b.txt
```

</details>

---

## å¸¸è§é”™è¯¯

| é”™è¯¯ | åæœ | é¢„é˜² |
|------|------|------|
| å¿˜è®° ulimit | é«˜è´Ÿè½½ä¸‹ "too many open files" | å®‰è£…å‰é…ç½® 65535 |
| Locale ä¸º C | SJIS æ–‡ä»¶åä¹±ç  | è®¾ç½® en_US.UTF-8 |
| ä¸å¤‡ä»½å®šä¹‰ | å‡çº§åæ— æ³•å›æ»š | æ¯æ¬¡å˜æ›´å‰å¤‡ä»½ |
| Spool ç£ç›˜å° | é‡è¯•æ—¶ç£ç›˜æ»¡ | ç›‘æ§ç£ç›˜ä½¿ç”¨ |

> ğŸ’¡ **é¢è¯•è¦ç‚¹ #3**
>
> **é—®é¢˜**ï¼šã€Œ2ãƒãƒ¼ãƒ‰ã®HULFT8ãƒ©ãƒœç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹æœ€å°é™ã®æ‰‹é †ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚ã€
>
> ï¼ˆä¸­æ–‡å‚è€ƒï¼šè¯·æ¦‚è¿°æ­å»º 2 èŠ‚ç‚¹ HULFT8 Lab ç¯å¢ƒçš„æœ€å°æ­¥éª¤ã€‚ï¼‰
>
> **æœŸæœ›å›ç­”**ï¼š
> 1. åˆ›å»º hulft ç”¨æˆ·/ç»„ï¼ˆéç™»å½•ï¼‰
> 2. è®¾ç½® ulimitã€localeã€NTP åŒæ­¥
> 3. å¼€æ”¾é˜²ç«å¢™ç«¯å£ 8594/8500
> 4. ä¸¤èŠ‚ç‚¹å®‰è£… Engine
> 5. åº”ç”¨è®¸å¯è¯ï¼Œé…ç½®äº’ç›¸çš„èŠ‚ç‚¹å®šä¹‰
> 6. ç”¨ `hulcmd -sendfile` æµ‹è¯•ï¼Œæ£€æŸ¥æ—¥å¿— RC=0

---

## æ¸…ç†èµ„æº

**Lab å®Œæˆåï¼Œè®°å¾—æ¸…ç† EC2 å®ä¾‹é¿å…è´¹ç”¨ï¼š**

```bash
# å¦‚æœä½¿ç”¨ CloudFormation
aws cloudformation delete-stack --stack-name hulft-lab

# å¦‚æœæ‰‹åŠ¨åˆ›å»º
aws ec2 terminate-instances --instance-ids <instance-id-a> <instance-id-b>
```

---

## å°ç»“

| ä¸»é¢˜ | è¦ç‚¹ |
|------|------|
| ç»„ä»¶ | Engineï¼ˆå¿…é¡»ï¼‰vs Managerï¼ˆå¯é€‰ï¼‰ |
| æ–‡ä»¶ä½ç½® | hlmtable.tblã€hlmdef.tblã€spoolã€log |
| å®‰è£…å‰ | ulimitã€localeã€NTPã€æœåŠ¡è´¦æˆ· |
| éªŒè¯ | hulstatã€hulcmd -sendfileã€æ£€æŸ¥ RC=0 |

---

## ä¸‹ä¸€æ­¥

å®Œæˆæœ¬è¯¾åï¼Œè¯·ç»§ç»­ï¼š

- **[03 Â· å­—ç¬¦ç¼–ç å¤„ç†ï¼ˆSJISâ†”UTF-8/EBCDICï¼‰](../03-encoding/)** â€” å¤„ç†æ—¥æœ¬å¸¸è§çš„ç¼–ç è½¬æ¢åœºæ™¯

---

## ç³»åˆ—å¯¼èˆª / Series Nav

| è¯¾ç¨‹ | ä¸»é¢˜ |
|------|------|
| 00 Â· æ¦‚å¿µä¸æ¶æ„ | Store-and-Forward, æœ¯è¯­ |
| 01 Â· ç½‘ç»œä¸å®‰å…¨ | ç«¯å£ã€é˜²ç«å¢™ã€æœåŠ¡è´¦æˆ· |
| **02 Â· å®‰è£…é…ç½®** | â† å½“å‰è¯¾ç¨‹ |
| 03 Â· å­—ç¬¦ç¼–ç  | SJISâ†”UTF-8, EBCDIC |
| 04 Â· é›†ä¿¡/é…ä¿¡å®æˆ˜ | ä¼ è¾“ç»„ã€é‡è¯•æœºåˆ¶ |
| 05 Â· ä½œä¸šè”åŠ¨ | JP1 é›†æˆã€æ—¥å¿—åˆ†æ |
| 06 Â· äº‘è¿ç§» | HULFT Square, AWS VPC |
