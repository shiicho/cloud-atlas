# 03 Â· åˆ†æ”¯ï¼šGit çš„æ€æ‰‹é”

> **ç›®æ ‡**ï¼šæŒæ¡ Git åˆ†æ”¯åˆ›å»ºã€åˆ‡æ¢ã€åˆå¹¶çš„å®Œæ•´å·¥ä½œæµ  
> **å‰ç½®**ï¼šå·²å®Œæˆ [02 Â· è¿œç¨‹ä»“åº“](../02-remote/)  
> **æ—¶é—´**ï¼š40 åˆ†é’Ÿ  
> **è´¹ç”¨**ï¼šæ— ï¼ˆæœ¬åœ°æ“ä½œï¼‰

---

## å°†å­¦åˆ°çš„å†…å®¹

1. ç†è§£ä¸ºä»€ä¹ˆåˆ†æ”¯åœ¨ Git ä¸­å¦‚æ­¤è½»é‡ï¼ˆ40 å­—èŠ‚ï¼ï¼‰
2. åˆ›å»ºã€åˆ‡æ¢ã€åˆ é™¤åˆ†æ”¯
3. åˆå¹¶åˆ†æ”¯ï¼ˆFast-forward vs ä¸‰æ–¹åˆå¹¶ï¼‰
4. ç†è§£ HEAD æŒ‡é’ˆçš„å«ä¹‰
5. äº†è§£å¸¸è§åˆ†æ”¯ç­–ç•¥ï¼ˆGit Flowã€GitHub Flowã€Trunk-basedï¼‰

---

## ä¸ºä»€ä¹ˆåˆ†æ”¯æ˜¯"æ€æ‰‹é”"ï¼Ÿ

åœ¨å­¦ä¹ å‘½ä»¤ä¹‹å‰ï¼Œå…ˆç†è§£ä¸ºä»€ä¹ˆåˆ†æ”¯å¦‚æ­¤é‡è¦ï¼š

| åœºæ™¯ | æ²¡æœ‰åˆ†æ”¯ | æœ‰åˆ†æ”¯ |
|------|----------|--------|
| å¼€å‘æ–°åŠŸèƒ½ | ç›´æ¥æ”¹ä¸»ä»£ç ï¼Œå‡ºé”™å½±å“æ‰€æœ‰äºº | åœ¨ç‹¬ç«‹åˆ†æ”¯å¼€å‘ï¼Œå®‰å…¨éš”ç¦» |
| ç´§æ€¥ä¿®å¤ | æ··å…¥æ­£åœ¨å¼€å‘çš„åŠæˆå“ | ä»ç¨³å®šç‰ˆæœ¬æ‹‰åˆ†æ”¯ï¼Œå¿«é€Ÿä¿®å¤ |
| å¤šäººåä½œ | äº’ç›¸è¦†ç›–ï¼Œå†²çªä¸æ–­ | å„è‡ªåˆ†æ”¯ï¼Œåˆå¹¶æ—¶å¤„ç† |
| å®éªŒæƒ³æ³• | æ”¹åäº†å¾ˆéš¾æ¢å¤ | å¤±è´¥äº†ç›´æ¥åˆ é™¤åˆ†æ”¯ |

> **å…³é”®ç†å¿µ**ï¼š**åˆ†æ”¯æ˜¯ä¸€æ¬¡æ€§çš„ã€‚å¤§èƒ†åˆ›å»ºï¼ŒåŠæ—¶åˆ é™¤ã€‚**

---

## Step 1 â€” ç¯å¢ƒå‡†å¤‡ï¼ˆ2 åˆ†é’Ÿï¼‰

æœ¬è¯¾åœ¨æœ¬åœ°è¿›è¡Œï¼Œä½¿ç”¨ä½ ä¹‹å‰çš„ä»“åº“æˆ–æ–°å»ºä¸€ä¸ªï¼š

> **ğŸ“ è·¯å¾„è¯´æ˜**ï¼šæœ¬è¯¾æä¾›ä¸¤ç§é€‰æ‹©ã€‚å¦‚æœä½ æƒ³ä¿æŒä¹‹å‰è¯¾ç¨‹çš„è¿›åº¦ï¼Œä½¿ç”¨æ–¹å¼ 1ã€‚å¦‚æœæƒ³è¦å¹²å‡€çš„ç»ƒä¹ ç¯å¢ƒï¼Œä½¿ç”¨æ–¹å¼ 2ã€‚ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥å®Œæˆæœ¬è¯¾æ‰€æœ‰ç»ƒä¹ ã€‚

```bash
# æ–¹å¼ 1ï¼šä½¿ç”¨ä¹‹å‰è¯¾ç¨‹çš„ä»“åº“ï¼ˆæ¨èï¼‰
cd ~/system-check

# æ–¹å¼ 2ï¼šæ–°å»ºç‹¬ç«‹ç»ƒä¹ ä»“åº“
mkdir -p ~/git-branch-lab && cd ~/git-branch-lab
git init
echo "# Branch Lab" > README.md
git add README.md
git commit -m "Initial commit"
```

ç¡®è®¤å½“å‰åˆ†æ”¯ï¼š

```bash
git branch
```

```
* main
```

æ˜Ÿå· `*` è¡¨ç¤ºå½“å‰æ‰€åœ¨åˆ†æ”¯ã€‚

---

## Step 2 â€” ç†è§£åˆ†æ”¯çš„æœ¬è´¨ï¼ˆ5 åˆ†é’Ÿï¼‰

### 2.1 åˆ†æ”¯ = æŒ‡é’ˆ

Git åˆ†æ”¯çš„ç§˜å¯†ï¼š**åˆ†æ”¯åªæ˜¯ä¸€ä¸ªæŒ‡å‘æŸä¸ª commit çš„æŒ‡é’ˆ**ã€‚

```bash
# æŸ¥çœ‹ main åˆ†æ”¯æŒ‡å‘çš„ commit
cat .git/refs/heads/main
```

```
a1b2c3d4e5f6...ï¼ˆ40 å­—ç¬¦çš„ SHA-1 å“ˆå¸Œï¼‰
```

**è¿™å°±æ˜¯å…¨éƒ¨ï¼** ä¸€ä¸ªåˆ†æ”¯åªæœ‰ 40 å­—èŠ‚ï¼Œæ‰€ä»¥ï¼š
- åˆ›å»ºåˆ†æ”¯ï¼šå†™ 40 å­—èŠ‚ â†’ **ç¬é—´å®Œæˆ**
- åˆ‡æ¢åˆ†æ”¯ï¼šè¯» 40 å­—èŠ‚ï¼Œæ›´æ–°æ–‡ä»¶ â†’ **å‡ ä¹ç¬é—´**

### 2.2 HEAD = ä½ åœ¨å“ªé‡Œ

```bash
cat .git/HEAD
```

```
ref: refs/heads/main
```

HEAD æ˜¯ä¸€ä¸ªç‰¹æ®ŠæŒ‡é’ˆï¼ŒæŒ‡å‘**å½“å‰æ‰€åœ¨çš„åˆ†æ”¯**ã€‚

![Branch Pointer](images/branch-pointer.png)

<details>
<summary>View ASCII source</summary>

```
                    HEAD
                      â”‚
                      â–¼
                    main
                      â”‚
                      â–¼
    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”
    â”‚ C1  â”‚â”€â”€â”€â–¶â”‚ C2  â”‚â”€â”€â”€â–¶â”‚ C3  â”‚
    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜
      â–²
      â”‚
   æäº¤é“¾ï¼ˆæ¯ä¸ª commit æŒ‡å‘å®ƒçš„çˆ¶æäº¤ï¼‰
```

</details>

**è®°ä½**ï¼š
- **Branch** = æŒ‡å‘ commit çš„æŒ‡é’ˆï¼ˆå¯ç§»åŠ¨ï¼‰
- **HEAD** = æŒ‡å‘å½“å‰åˆ†æ”¯çš„æŒ‡é’ˆï¼ˆä½ åœ¨å“ªï¼‰
- **Commit** = é¡¹ç›®å¿«ç…§ + çˆ¶æŒ‡é’ˆ

---

## Step 3 â€” åˆ†æ”¯åŸºæœ¬æ“ä½œï¼ˆ8 åˆ†é’Ÿï¼‰

### 3.1 åˆ›å»ºåˆ†æ”¯

```bash
# åˆ›å»ºæ–°åˆ†æ”¯ï¼ˆä¸åˆ‡æ¢ï¼‰
git branch feature-memory

# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯
git branch
```

```
  feature-memory
* main
```

åˆ†æ”¯åˆ›å»ºäº†ï¼Œä½†ä½ è¿˜åœ¨ `main` ä¸Šï¼ˆæ˜Ÿå·ä½ç½®ï¼‰ã€‚

### 3.2 åˆ‡æ¢åˆ†æ”¯

æœ‰ä¸¤ç§æ–¹å¼ï¼ˆæ•ˆæœç›¸åŒï¼‰ï¼š

```bash
# ä¼ ç»Ÿæ–¹å¼
git checkout feature-memory

# æ–°æ–¹å¼ï¼ˆGit 2.23+ï¼Œæ¨èï¼‰
git switch feature-memory
```

```
Switched to branch 'feature-memory'
```

éªŒè¯ï¼š

```bash
git branch
```

```
* feature-memory
  main
```

### 3.3 åˆ›å»ºå¹¶åˆ‡æ¢ï¼ˆä¸€æ­¥å®Œæˆï¼‰

```bash
# ä¼ ç»Ÿæ–¹å¼
git checkout -b feature-disk

# æ–°æ–¹å¼ï¼ˆæ¨èï¼‰
git switch -c feature-disk
```

> **ğŸ’¡ æ¨èä½¿ç”¨ `git switch`**ï¼šè¯­ä¹‰æ›´æ¸…æ™°ã€‚`checkout` åŠŸèƒ½å¤ªå¤šï¼Œå®¹æ˜“æ··æ·†ã€‚

### 3.4 åˆ é™¤åˆ†æ”¯

```bash
# åˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯ï¼ˆä¸èƒ½åˆ é™¤å½“å‰åˆ†æ”¯ï¼‰
git switch main

# åˆ é™¤å·²åˆå¹¶çš„åˆ†æ”¯ï¼ˆå®‰å…¨ï¼‰
git branch -d feature-disk

# å¼ºåˆ¶åˆ é™¤ï¼ˆæœªåˆå¹¶ä¹Ÿåˆ é™¤ï¼‰
git branch -D feature-disk
```

**å¸¸ç”¨å‚æ•°**ï¼š

| å‘½ä»¤ | ä½œç”¨ |
|------|------|
| `git branch` | åˆ—å‡ºæœ¬åœ°åˆ†æ”¯ |
| `git branch -a` | åˆ—å‡ºæ‰€æœ‰åˆ†æ”¯ï¼ˆå«è¿œç¨‹ï¼‰ |
| `git branch -v` | æ˜¾ç¤ºæ¯ä¸ªåˆ†æ”¯çš„æœ€æ–°æäº¤ |
| `git branch --merged` | å·²åˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯ |
| `git branch --no-merged` | æœªåˆå¹¶çš„åˆ†æ”¯ |

---

## Step 4 â€” åœ¨åˆ†æ”¯ä¸Šå·¥ä½œï¼ˆ10 åˆ†é’Ÿï¼‰

### 4.1 å‡†å¤‡å·¥ä½œ

ç¡®ä¿ä½ æœ‰ä¸€ä¸ªå¯ä»¥ä¿®æ”¹çš„æ–‡ä»¶ï¼š

```bash
git switch main

# å¦‚æœæ²¡æœ‰ check.shï¼Œåˆ›å»ºä¸€ä¸ª
cat > check.sh << 'EOF'
#!/bin/bash
# System Check Script

echo "=== System Information ==="
echo "Hostname: $(hostname)"
echo "OS: $(uname -s)"
echo "Date: $(date)"
EOF

chmod +x check.sh
git add check.sh
git commit -m "feat: add basic system check script"
```

### 4.2 åˆ›å»º feature åˆ†æ”¯å¹¶å¼€å‘

```bash
# åˆ›å»ºå¹¶åˆ‡æ¢åˆ° feature åˆ†æ”¯
git switch -c feature/add-memory-check

# æ·»åŠ åŠŸèƒ½
cat >> check.sh << 'EOF'

echo ""
echo "=== Memory Information ==="
free -h 2>/dev/null || vm_stat 2>/dev/null || echo "Memory info not available"
EOF

# æäº¤æ›´æ”¹
git add check.sh
git commit -m "feat: add memory check to system script"
```

### 4.3 æŸ¥çœ‹åˆ†æ”¯åˆ†å‰

```bash
git log --oneline --all --graph
```

```
* 8d7e6f5 (HEAD -> feature/add-memory-check) feat: add memory check to system script
* a1b2c3d (main) feat: add basic system check script
* 9f8e7d6 Initial commit
```

![Branch Diverge](images/branch-diverge.png)

<details>
<summary>View ASCII source</summary>

```
      main                feature/add-memory-check
        â”‚                          â”‚
        â–¼                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”
    â”‚ C1  â”‚â”€â”€â”€â–¶â”‚ C2  â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ C3  â”‚
    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”˜
    Initial    basic script   add memory
```

</details>

---

## Step 5 â€” åˆå¹¶åˆ†æ”¯ï¼ˆ10 åˆ†é’Ÿï¼‰

### 5.1 Fast-forward åˆå¹¶

å½“ç›®æ ‡åˆ†æ”¯ï¼ˆmainï¼‰æ²¡æœ‰æ–°æäº¤æ—¶ï¼ŒGit åªéœ€ç§»åŠ¨æŒ‡é’ˆï¼š

```bash
# åˆ‡æ¢åˆ° main
git switch main

# åˆå¹¶ feature åˆ†æ”¯
git merge feature/add-memory-check
```

```
Updating a1b2c3d..8d7e6f5
Fast-forward
 check.sh | 4 ++++
 1 file changed, 4 insertions(+)
```

**Fast-forward** æ„å‘³ç€ï¼šmain æŒ‡é’ˆç›´æ¥"å¿«è¿›"åˆ° feature åˆ†æ”¯çš„ä½ç½®ã€‚

```bash
git log --oneline --all --graph
```

```
* 8d7e6f5 (HEAD -> main, feature/add-memory-check) feat: add memory check
* a1b2c3d feat: add basic system check script
* 9f8e7d6 Initial commit
```

![Fast-forward Merge](images/fast-forward-merge.png)

<details>
<summary>View ASCII source</summary>

```
Before Fast-forward:

      main                feature
        â”‚                    â”‚
        â–¼                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”
    â”‚ C1  â”‚â”€â”€â”€â–¶â”‚ C2  â”‚â”€â”€â”€â–¶â”‚ C3  â”‚
    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜


After Fast-forward:

                         main, feature
                              â”‚
                              â–¼
    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”
    â”‚ C1  â”‚â”€â”€â”€â–¶â”‚ C2  â”‚â”€â”€â”€â–¶â”‚ C3  â”‚
    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜
```

</details>

### 5.2 ä¸‰æ–¹åˆå¹¶ï¼ˆ3-way Mergeï¼‰

å½“ä¸¤è¾¹éƒ½æœ‰æ–°æäº¤æ—¶ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª**åˆå¹¶æäº¤**ï¼ˆmerge commitï¼‰ï¼š

```bash
# åœ¨ main ä¸Šåšä¸€äº›ä¿®æ”¹
echo "# System Check Tool" > README.md
git add README.md
git commit -m "docs: add README"

# åˆ›å»ºå¦ä¸€ä¸ª feature åˆ†æ”¯
git switch -c feature/add-disk-check

# æ·»åŠ ç£ç›˜æ£€æŸ¥åŠŸèƒ½
cat >> check.sh << 'EOF'

echo ""
echo "=== Disk Information ==="
df -h 2>/dev/null || echo "Disk info not available"
EOF

git add check.sh
git commit -m "feat: add disk check to system script"

# åˆ‡æ¢å› main
git switch main

# åˆå¹¶ï¼ˆæ­¤æ—¶ main æœ‰æ–°çš„ README æäº¤ï¼‰
git merge feature/add-disk-check
```

Git ä¼šæ‰“å¼€ç¼–è¾‘å™¨è®©ä½ ç¼–å†™åˆå¹¶æäº¤ä¿¡æ¯ã€‚ä¿å­˜é€€å‡ºå³å¯ã€‚

```
Merge made by the 'ort' strategy.
 check.sh | 4 ++++
 1 file changed, 4 insertions(+)
```

```bash
git log --oneline --all --graph
```

```
*   e4f5g6h (HEAD -> main) Merge branch 'feature/add-disk-check'
|\
| * c3d4e5f (feature/add-disk-check) feat: add disk check
* | b2c3d4e docs: add README
|/
* 8d7e6f5 (feature/add-memory-check) feat: add memory check
* a1b2c3d feat: add basic system check script
* 9f8e7d6 Initial commit
```

![Three-way Merge](images/three-way-merge.png)

<details>
<summary>View ASCII source</summary>

```
Before 3-way Merge:

                main              feature
                  â”‚                  â”‚
                  â–¼                  â–¼
              â”Œâ”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”
         â”Œâ”€â”€â”€â–¶â”‚ C4  â”‚            â”‚ C5  â”‚
         â”‚    â””â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”‚
    â”‚ C1  â”‚â”€â”€â”€â–¶â”‚ C2  â”‚â”€â”€â”€â–¶â”‚ C3  â”‚â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜


After 3-way Merge:

                               main
                                 â”‚
                                 â–¼
              â”Œâ”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”
         â”Œâ”€â”€â”€â–¶â”‚ C4  â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ M   â”‚  â† Merge Commit
         â”‚    â””â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”˜
         â”‚                       â–²
    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”â”‚   â”Œâ”€â”€â”€â”€â”€â”
    â”‚ C1  â”‚â”€â”€â”€â–¶â”‚ C2  â”‚â”€â”€â”€â–¶â”‚ C3  â”‚â””â”€â”€â”€â”‚ C5  â”‚
    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜
                                       â–²
                                       â”‚
                                   feature
```

</details>

**ä¸ºä»€ä¹ˆå«"ä¸‰æ–¹"ï¼Ÿ** Git æ¯”è¾ƒä¸‰ä¸ªç‰ˆæœ¬ï¼š
1. **å…±åŒç¥–å…ˆ**ï¼ˆC3ï¼‰
2. **å½“å‰åˆ†æ”¯**ï¼ˆmain/C4ï¼‰
3. **åˆå¹¶åˆ†æ”¯**ï¼ˆfeature/C5ï¼‰

### 5.3 åˆå¹¶åæ¸…ç†

åˆå¹¶å®Œæˆåï¼Œåˆ é™¤ feature åˆ†æ”¯ï¼š

```bash
git branch -d feature/add-memory-check
git branch -d feature/add-disk-check
```

```
Deleted branch feature/add-memory-check (was 8d7e6f5).
Deleted branch feature/add-disk-check (was c3d4e5f).
```

**ä¸ºä»€ä¹ˆè¦åˆ é™¤ï¼Ÿ**
- åˆ†æ”¯å·²å®Œæˆä½¿å‘½
- å‡å°‘åˆ†æ”¯åˆ—è¡¨å™ªéŸ³
- åˆ†æ”¯å¾ˆä¾¿å®œï¼Œç”¨å®Œå°±åˆ 

---

## Step 6 â€” åˆ†æ”¯ç­–ç•¥ç®€ä»‹ï¼ˆ3 åˆ†é’Ÿï¼‰

ä¸åŒå›¢é˜Ÿä½¿ç”¨ä¸åŒçš„åˆ†æ”¯ç­–ç•¥ã€‚è¿™é‡Œç®€è¦ä»‹ç»ä¸‰ç§ä¸»æµç­–ç•¥ï¼š

### Git Flow

```
main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
        â”‚                              â–²
        â””â”€â”€â”€â–¶ develop â”€â”€â”€â–¶ feature/* â”€â”€â”˜
                â”‚
                â””â”€â”€â”€â–¶ release/* â”€â”€â”€â–¶ hotfix/*
```

- **åˆ†æ”¯**ï¼šmain, develop, feature/*, release/*, hotfix/*
- **é€‚ç”¨**ï¼šæœ‰æ˜ç¡®å‘å¸ƒå‘¨æœŸçš„é¡¹ç›®ï¼ˆæ¯æœˆå‘ç‰ˆï¼‰
- **æ—¥æœ¬ä¼ä¸š**ï¼šè¾ƒå¸¸è§ï¼Œç¬¦åˆæ‰¿è®¤æµç¨‹æ–‡åŒ–

### GitHub Flow

```
main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
   â”‚         â”‚         â”‚
   â””â”€â”€â–¶ PR â”€â”€â”˜   â””â”€â”€â–¶ PR â”€â”€â”˜
    feature/a     feature/b
```

- **åˆ†æ”¯**ï¼šmain + çŸ­æœŸ feature åˆ†æ”¯
- **é€‚ç”¨**ï¼šæŒç»­éƒ¨ç½²ï¼Œå¿«é€Ÿè¿­ä»£
- **ç‰¹ç‚¹**ï¼šç®€å•ç›´æ¥ï¼ŒPR é©±åŠ¨

### Trunk-based Development

```
main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
   â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
   â””â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”˜
   (very short-lived branches)
```

- **åˆ†æ”¯**ï¼šä¸»è¦åœ¨ mainï¼ŒæçŸ­æœŸåˆ†æ”¯ï¼ˆ< 1 å¤©ï¼‰
- **é€‚ç”¨**ï¼šé«˜é¢‘å‘å¸ƒï¼Œå¼º CI/CD
- **è¦æ±‚**ï¼šå¼ºå¤§çš„è‡ªåŠ¨åŒ–æµ‹è¯•

### å¦‚ä½•é€‰æ‹©ï¼Ÿ

| å› ç´  | Git Flow | GitHub Flow | Trunk-based |
|------|----------|-------------|-------------|
| å‘å¸ƒé¢‘ç‡ | ä½ï¼ˆå‘¨/æœˆï¼‰ | ä¸­ï¼ˆå¤©/å‘¨ï¼‰ | é«˜ï¼ˆå¤©/å¤šæ¬¡ï¼‰ |
| å›¢é˜Ÿè§„æ¨¡ | å¤§ | ä¸­å° | ä»»æ„ |
| æµ‹è¯•è¦†ç›– | ä¸€èˆ¬ | è¾ƒé«˜ | å¿…é¡»é«˜ |
| å¤æ‚åº¦ | é«˜ | ä½ | ä¸­ |

> **å»ºè®®**ï¼šåˆå­¦è€…å…ˆæŒæ¡ GitHub Flowï¼Œç®€å•æœ‰æ•ˆã€‚

---

## åŠ¨æ‰‹ç»ƒä¹ ï¼šFeature åˆ†æ”¯å·¥ä½œæµï¼ˆMini-projectï¼‰

å®Œæˆä»¥ä¸‹ä»»åŠ¡æ¥å·©å›ºæ‰€å­¦ï¼š

### ä»»åŠ¡æ¸…å•

```bash
# 1. ç¡®è®¤åœ¨ main åˆ†æ”¯
git switch main

# 2. åˆ›å»º feature/add-network-check åˆ†æ”¯
git switch -c feature/add-network-check

# 3. æ·»åŠ ç½‘ç»œæ£€æŸ¥åŠŸèƒ½
cat >> check.sh << 'EOF'

echo ""
echo "=== Network Information ==="
ip addr 2>/dev/null || ifconfig 2>/dev/null || echo "Network info not available"
EOF

# 4. æäº¤æ›´æ”¹
git add check.sh
git commit -m "feat: add network check to system script"

# 5. åˆ‡æ¢å› mainï¼Œåˆå¹¶åˆ†æ”¯
git switch main
git merge feature/add-network-check

# 6. åˆ é™¤å·²åˆå¹¶çš„ feature åˆ†æ”¯
git branch -d feature/add-network-check

# 7. æŸ¥çœ‹åˆå¹¶å†å²
git log --oneline --graph
```

### éªŒæ”¶æ ‡å‡†

- [ ] æˆåŠŸåˆ›å»ºå¹¶åˆ‡æ¢åˆ° feature åˆ†æ”¯
- [ ] åœ¨ feature åˆ†æ”¯ä¸Šå®Œæˆæäº¤
- [ ] æˆåŠŸåˆå¹¶å› main
- [ ] å·²åˆ é™¤ feature åˆ†æ”¯
- [ ] `git log --oneline --graph` æ˜¾ç¤ºæ­£ç¡®çš„å†å²

---

## æœ¬è¯¾å°ç»“

| å‘½ä»¤ | ä½œç”¨ | å¤‡æ³¨ |
|------|------|------|
| `git branch` | åˆ—å‡ºåˆ†æ”¯ | `-a` æ˜¾ç¤ºæ‰€æœ‰ |
| `git branch <name>` | åˆ›å»ºåˆ†æ”¯ | ä¸åˆ‡æ¢ |
| `git switch <name>` | åˆ‡æ¢åˆ†æ”¯ | æ¨èä½¿ç”¨ |
| `git switch -c <name>` | åˆ›å»ºå¹¶åˆ‡æ¢ | ä¸€æ­¥å®Œæˆ |
| `git merge <branch>` | åˆå¹¶åˆ†æ”¯ | åœ¨ç›®æ ‡åˆ†æ”¯æ‰§è¡Œ |
| `git branch -d <name>` | åˆ é™¤å·²åˆå¹¶åˆ†æ”¯ | å®‰å…¨åˆ é™¤ |
| `git branch -D <name>` | å¼ºåˆ¶åˆ é™¤åˆ†æ”¯ | æœªåˆå¹¶ä¹Ÿåˆ é™¤ |

**æ ¸å¿ƒç†å¿µ**ï¼š

**Git åˆ†æ”¯çš„æœ¬è´¨**

| æ¦‚å¿µ | å«ä¹‰ |
|------|------|
| **Branch** | 40 å­—èŠ‚æŒ‡é’ˆ â†’ åˆ›å»º/åˆ é™¤å‡ ä¹é›¶æˆæœ¬ |
| **HEAD** | "ä½ åœ¨è¿™é‡Œ" æŒ‡é’ˆ â†’ æ€»æ˜¯æŒ‡å‘å½“å‰åˆ†æ”¯ |
| **Fast-forward** | ç›´æ¥ç§»åŠ¨æŒ‡é’ˆ â†’ çº¿æ€§å†å² |
| **3-way Merge** | åˆ›å»ºåˆå¹¶æäº¤ â†’ ä¿ç•™åˆ†æ”¯å†å² |

> **å…³é”®ç†å¿µ**ï¼šåˆ†æ”¯æ˜¯ä¸€æ¬¡æ€§çš„ã€‚å¤§èƒ†åˆ›å»ºï¼ŒåŠæ—¶åˆ é™¤ã€‚

---

## ä¸‹ä¸€æ­¥

åˆ†æ”¯åˆå¹¶æ—¶ï¼Œå¦‚æœä¸¤è¾¹ä¿®æ”¹äº†åŒä¸€è¡Œä»£ç æ€ä¹ˆåŠï¼Ÿ

--> [04 Â· å†²çªè§£å†³ä¸å†å²æ¢ç´¢](../04-conflicts/)

---

## é¢è¯•å‡†å¤‡

**Q: Git ã®ãƒ–ãƒ©ãƒ³ãƒã¯ä½•ã§ã™ã‹ï¼Ÿãªãœè»½é‡ï¼Ÿ**

A: ãƒ–ãƒ©ãƒ³ãƒã¯ã‚³ãƒŸãƒƒãƒˆã¸ã®ãƒã‚¤ãƒ³ã‚¿ï¼ˆ40ãƒã‚¤ãƒˆã®SHA-1ï¼‰ã€‚ä½œæˆãƒ»å‰Šé™¤ãŒç¬æ™‚ã«å®Œäº†ã™ã‚‹ã€‚SVN ã¨é•ã„ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼ã§ã¯ãªã„ã€‚

**Q: Fast-forward ã¨ 3-way merge ã®é•ã„ã¯ï¼Ÿ**

A: Fast-forward ã¯ãƒã‚¤ãƒ³ã‚¿ç§»å‹•ã®ã¿ï¼ˆãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆãªã—ï¼‰ã€‚3-way merge ã¯ä¸¡æ–¹ã®å¤‰æ›´ã‚’çµ±åˆã—ã¦ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆã€‚

**Q: ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã®çµŒé¨“ã¯ï¼Ÿ**

A: [ã‚ãªãŸã®çµŒé¨“ã«åŸºã¥ã„ã¦å›ç­”]
- Git Flow: æ˜ç¢ºãªãƒªãƒªãƒ¼ã‚¹ã‚µã‚¤ã‚¯ãƒ«ãŒã‚ã‚‹å ´åˆ
- GitHub Flow: ç¶™ç¶šçš„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚·ãƒ³ãƒ—ãƒ«
- Trunk-based: é«˜é »åº¦ãƒªãƒªãƒ¼ã‚¹ã€å¼·ã„ CI/CD

**Q: ãªãœ feature ãƒ–ãƒ©ãƒ³ãƒã‚’ä½¿ã†ï¼Ÿ**

A: é–‹ç™ºã‚’éš”é›¢ã—ã€main ã‚’å®‰å®šã•ã›ã‚‹ã€‚å¤±æ•—ã—ã¦ã‚‚ç°¡å˜ã«ã‚„ã‚Šç›´ã›ã‚‹ã€‚ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®å˜ä½ã«ãªã‚‹ã€‚

---

## èŒåœºå°è´´å£«

### æ—¥æœ¬ IT ç°åœºçš„åˆ†æ”¯å®è·µ

åœ¨æ—¥æœ¬çš„ IT ç°åœºï¼ˆç‰¹ã« SIer ã‚„å¤§æ‰‹ä¼ä¸šï¼‰ï¼Œåˆ†æ”¯ç­–ç•¥å¾€å¾€ä¸**æ‰¿èªãƒ•ãƒ­ãƒ¼**ç´§å¯†ç»“åˆï¼š

```
é–‹ç™ºè€… â”€â”€â–¶ feature branch â”€â”€â–¶ PR â”€â”€â–¶ ãƒ¬ãƒ“ãƒ¥ãƒ¼ â”€â”€â–¶ æ‰¿èª â”€â”€â–¶ merge
```

è¿™ä¸æ—¥æœ¬ä¼ä¸šé‡è§†**ç¨Ÿè­°**ï¼ˆã‚Šã‚“ãï¼‰çš„æ–‡åŒ–é«˜åº¦å¥‘åˆï¼š
- **PR = å¤‰æ›´ç”³è«‹**ï¼šè®°å½•å˜æ›´å†…å®¹å’Œç†ç”±
- **Review = ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰¿èª**ï¼šæŠ€æœ¯æ£€æŸ¥
- **Merge = æœ¬ç•ªåæ˜ **ï¼šæ­£å¼ç”Ÿæ•ˆ

> **å°è´´å£«**ï¼šåœ¨æ—¥æœ¬å›¢é˜Ÿï¼Œå»ºè®®ä½¿ç”¨**è‹±è¯­åˆ†æ”¯å**ï¼ˆ`feature/add-auth`ï¼‰ï¼Œä½† PR æè¿°å¯ä»¥ç”¨æ—¥è¯­å†™ï¼Œæ–¹ä¾¿éæŠ€æœ¯äººå‘˜ç†è§£ã€‚

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**é—®é¢˜ï¼š`git switch` å‘½ä»¤ä¸å­˜åœ¨**

```bash
git --version
# Git 2.23 ä»¥ä¸‹ç‰ˆæœ¬æ²¡æœ‰ switch å‘½ä»¤
# è§£å†³ï¼šä½¿ç”¨ git checkoutï¼Œæˆ–å‡çº§ Git
```

**é—®é¢˜ï¼šåˆ é™¤åˆ†æ”¯æ—¶æç¤º"æœªåˆå¹¶"**

```bash
error: The branch 'feature-x' is not fully merged.
```

è¿™æ˜¯ Git çš„ä¿æŠ¤æœºåˆ¶ã€‚ç¡®è®¤åˆ†æ”¯ç¡®å®ä¸éœ€è¦åï¼š

```bash
git branch -D feature-x  # å¼ºåˆ¶åˆ é™¤
```

**é—®é¢˜ï¼šä¸å°å¿ƒåœ¨é”™è¯¯åˆ†æ”¯ä¸Šæäº¤äº†**

```bash
# æ–¹æ³•1ï¼šå¦‚æœè¿˜æ²¡ push
git switch correct-branch
git cherry-pick <commit-hash>  # æŠŠæäº¤å¤åˆ¶è¿‡æ¥
git switch wrong-branch
git reset --hard HEAD~1        # åˆ é™¤é”™è¯¯æäº¤

# æ–¹æ³•2ï¼šåˆ›å»ºæ–°åˆ†æ”¯ä¿å­˜
git branch save-my-work
git switch main
```

---

## å»¶ä¼¸é˜…è¯»

- [Git Branching - Basic Branching and Merging](https://git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging) - å®˜æ–¹æ–‡æ¡£
- [Understanding Git Flow](https://nvie.com/posts/a-successful-git-branching-model/) - Git Flow åŸå§‹æ–‡ç« 
- [GitHub Flow](https://docs.github.com/en/get-started/quickstart/github-flow) - GitHub å®˜æ–¹æŒ‡å—

---

## ç³»åˆ—å¯¼èˆª

â† [02 Â· è¿œç¨‹ä»“åº“](../02-remote/) | [Home](../) | [04 Â· å†²çªè§£å†³ â†’](../04-conflicts/)
